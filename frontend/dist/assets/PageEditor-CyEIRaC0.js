import{q as Ie,d as ie,r as m,l as xe,s as je,c as v,o as u,a as e,b as U,F as le,j as ze,e as z,t as k,m as pe,n as ge,g as H,p as Ee,h as se,x as ke,y as Me,k as D,w as ne,v as oe,z as Be,A as Ve,f as be,i as L,B as Te,C as Se,u as Pe,D as Re,G as He,H as Ne,M as Le,E as Oe}from"./index-CjHtS17A.js";import{p as _e,b as $e,c as We}from"./index-PrkzALow.js";import{_ as Ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";function De(g,P){if(!P)return g;let f=g||"";const{behavior_rules:l,page_goal:y}=P;return l&&!f.includes("## è¡Œä¸ºè§„åˆ™")&&(f+=`

## è¡Œä¸ºè§„åˆ™
${l}`),y&&!f.includes("## é¡µé¢ç›®æ ‡")&&(f+=`

## é¡µé¢ç›®æ ‡
${y}`),f.trim()}function Ue(g,P){if(!P)return g;let f=g||"";const{behavior_rules:l,page_goal:y}=P;return l&&!f.includes("## Behavior Rules")&&(f+=`

## Behavior Rules
${l}`),y&&!f.includes("## Page Goal")&&(f+=`

## Page Goal
${y}`),f.trim()}const Fe=Ie("uiConfig",()=>{const g=m({page_id:"",name:{"zh-CN":"",en:"",ja:"",ms:"","zh-TW":""},description:{"zh-CN":"",en:"",ja:"",ms:"","zh-TW":""},button_list:[],optional_actions:[]}),P=m(null),f=m(!1),l=m(null),y=m(null),$=ie(()=>f.value);function I(o){Object.assign(g.value,o),f.value=!0}function w(o){return f.value?{conflict:!0}:(h(o),{conflict:!1})}function E(o){h(o),f.value=!1}function h(o){if(o.page_id&&(g.value.page_id=o.page_id),o.page_name&&(g.value.name={"zh-CN":o.page_name["zh-CN"]||"",en:o.page_name.en||"",ja:o.page_name.ja||"",ms:o.page_name.ms||"","zh-TW":o.page_name["zh-TW"]||""}),o.page_description){let B=o.page_description["zh-CN"]||"",V=o.page_description.en||"";o.ai_context&&(B=De(B,o.ai_context),V=Ue(V,o.ai_context)),g.value.description={"zh-CN":B,en:V,ja:o.page_description.ja||"",ms:o.page_description.ms||"","zh-TW":o.page_description["zh-TW"]||""}}o.button_list&&(g.value.button_list=o.button_list),o.optional_actions&&(g.value.optional_actions=o.optional_actions)}function q(){}function R(){g.value={page_id:"",name:{"zh-CN":"",en:"",ja:"",ms:"","zh-TW":""},description:{"zh-CN":"",en:"",ja:"",ms:"","zh-TW":""},button_list:[],optional_actions:[]},P.value=null,f.value=!1,l.value=null}function F(o){var V,C,i,N,O,T,J,A,G,Q;const B={...o};B.name={"zh-CN":((V=o.name)==null?void 0:V["zh-CN"])||"",en:((C=o.name)==null?void 0:C.en)||"",ja:((i=o.name)==null?void 0:i.ja)||"",ms:((N=o.name)==null?void 0:N.ms)||"","zh-TW":((O=o.name)==null?void 0:O["zh-TW"])||""},B.description={"zh-CN":((T=o.description)==null?void 0:T["zh-CN"])||"",en:((J=o.description)==null?void 0:J.en)||"",ja:((A=o.description)==null?void 0:A.ja)||"",ms:((G=o.description)==null?void 0:G.ms)||"","zh-TW":((Q=o.description)==null?void 0:Q["zh-TW"])||""},o.ai_context&&(B.description["zh-CN"]=De(B.description["zh-CN"],o.ai_context),B.description.en=Ue(B.description.en,o.ai_context)),delete B.ai_context,P.value=JSON.parse(JSON.stringify(B)),g.value=JSON.parse(JSON.stringify(B)),f.value=!1}function b(o){l.value=o}function Z(o,B="success",V=3e3){y.value={message:o,type:B},setTimeout(()=>{y.value=null},V)}return{draftConfig:g,originalConfig:P,isDirty:f,currentSession:l,toast:y,hasChanges:$,applyUserEdit:I,tryApplyAiUpdate:w,forceApplyAiUpdate:E,keepUserEdit:q,resetConfig:R,setOriginalConfig:F,setCurrentSession:b,showToast:Z}}),Je=["src"],qe={class:"overlay"},Ge={class:"btn-action"},Ke=["disabled"],Ze={key:1,class:"upload-progress"},Qe={class:"progress-ring"},Xe={viewBox:"0 0 100 100"},Ye=["stroke-dasharray"],et={class:"percent"},tt={key:2,class:"upload-placeholder-wrapper"},at={class:"upload-placeholder"},st=["disabled"],nt=["src"],ot={__name:"ImageUploader",props:{modelValue:String,disabled:Boolean},emits:["update:modelValue","upload-success","upload-error"],setup(g,{emit:P}){const f=g,l=P,y=m(!1),$=m(!1),I=m(0),w=m(!1),E=m({width:0,height:0}),h=ie(()=>E.value.width||520),q=()=>{f.disabled||(y.value=!0)},R=()=>{y.value=!1},F=C=>{if(y.value=!1,f.disabled||$.value)return;const i=C.dataTransfer.files;i.length>0&&Z(i[0])},b=async C=>{const i=C.target,N=i.files;try{N&&N.length>0&&await Z(N[0])}finally{i.value=""}},Z=async C=>{var O,T,J;if(!C)return;if(!["image/png","image/jpeg","image/jpg"].includes(C.type)){l("upload-error",{code:"INVALID_FILE_TYPE",message:"ä»…æ”¯æŒ PNGã€JPG æ ¼å¼çš„å›¾ç‰‡"});return}const N=10*1024*1024;if(C.size>N){l("upload-error",{code:"FILE_TOO_LARGE",message:"å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡ 10MB"});return}$.value=!0,I.value=0;try{const A=await _e.uploadImage(C,G=>{I.value=G});l("update:modelValue",A.file_url),l("upload-success",A)}catch(A){console.error("Upload error:",A);let G="ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•",Q="UPLOAD_FAILED";A.code==="UPLOAD_FAILED"||A.name==="NotReadableError"?(G=A.message,Q="FILE_READ_ERROR"):(O=A.message)!=null&&O.includes("Network Error")||A.code==="ERR_NETWORK"?(G="ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ",Q="NETWORK_ERROR"):(J=(T=A.response)==null?void 0:T.data)!=null&&J.message?(G=A.response.data.message,Q=A.response.data.error||"SERVER_ERROR"):A.message&&(G=A.message),l("upload-error",{code:Q,message:G})}finally{$.value=!1}},o=()=>{l("update:modelValue",null)},B=()=>{if(f.disabled||$.value||!f.modelValue)return;const C=new Image;C.onload=()=>{const i=C.naturalWidth||C.width,N=C.naturalHeight||C.height,O=Math.floor(window.innerWidth*.9),T=Math.floor(window.innerHeight*.9),J=Math.min(1,O/i,T/N);E.value={width:Math.max(1,Math.floor(i*J)),height:Math.max(1,Math.floor(N*J))},w.value=!0},C.onerror=()=>{E.value={width:520,height:390},w.value=!0},C.src=f.modelValue},V=async C=>{var O;const i=document.activeElement;if(i&&(i.tagName==="INPUT"||i.tagName==="TEXTAREA"||i.isContentEditable)||f.disabled||$.value)return;const N=(O=C.clipboardData)==null?void 0:O.items;if(!(!N||N.length===0))for(let T=0;T<N.length;T++){const J=N[T];if(J.type.startsWith("image/")){C.preventDefault();const A=J.getAsFile();if(A){await Z(A);return}}}};return xe(()=>{document.addEventListener("paste",V)}),je(()=>{document.removeEventListener("paste",V)}),(C,i)=>{const N=se("a-modal");return u(),v(le,null,[e("div",{class:ge(["image-uploader",{"is-dragover":y.value,"has-image":g.modelValue,"is-disabled":g.disabled||$.value}]),onDragover:ze(q,["prevent"]),onDragleave:R,onDrop:ze(F,["prevent"])},[g.modelValue?(u(),v(le,{key:0},[e("img",{src:g.modelValue,alt:"é¡µé¢æˆªå›¾",class:"preview-image",onClick:B},null,8,Je),e("div",qe,[e("button",{class:"btn-action",type:"button",onClick:ze(B,["stop"])},[...i[1]||(i[1]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6-10-6-10-6z"}),e("circle",{cx:"12",cy:"12",r:"3"})],-1),z(" æŸ¥çœ‹å¤§å›¾ ",-1)])]),e("label",Ge,[e("input",{type:"file",accept:"image/png,image/jpeg,.png,.jpg,.jpeg",disabled:g.disabled||$.value,onChange:b,class:"hidden-input"},null,40,Ke),i[2]||(i[2]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 005.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 013.51 15"})],-1)),i[3]||(i[3]=z(" æ›´æ¢ ",-1))]),e("button",{class:"btn-action danger",type:"button",onClick:ze(o,["stop"])},[...i[4]||(i[4]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})],-1),z(" ç§»é™¤ ",-1)])])])],64)):$.value?(u(),v("div",Ze,[e("div",Qe,[(u(),v("svg",Xe,[i[5]||(i[5]=e("circle",{class:"bg",cx:"50",cy:"50",r:"45"},null,-1)),e("circle",{class:"progress",cx:"50",cy:"50",r:"45","stroke-dasharray":`${I.value*283} 283`},null,8,Ye)])),e("span",et,k(Math.round(I.value*100))+"%",1)]),i[6]||(i[6]=e("p",null,"ä¸Šä¼ ä¸­...",-1))])):(u(),v("div",tt,[e("label",at,[e("input",{type:"file",accept:"image/png,image/jpeg,.png,.jpg,.jpeg",disabled:g.disabled||$.value,onChange:b,class:"hidden-input"},null,40,st),i[7]||(i[7]=pe('<div class="upload-icon" data-v-524d4854><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-524d4854><path d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" data-v-524d4854></path></svg></div><p class="upload-text" data-v-524d4854>æ‹–æ‹½å›¾ç‰‡åˆ°æ­¤å¤„</p><p class="upload-hint" data-v-524d4854>æˆ–ç‚¹å‡»ä¸Šä¼ </p><p class="upload-formats" data-v-524d4854>æ”¯æŒ PNG, JPG (æœ€å¤§ 10MB)</p>',4))]),i[8]||(i[8]=e("div",{class:"paste-hint"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]),e("span",null,[z("ä¹Ÿå¯æŒ‰ "),e("kbd",null,"Ctrl"),z("+"),e("kbd",null,"V"),z(" ç²˜è´´å›¾ç‰‡")])],-1))]))],34),U(N,{open:w.value,"onUpdate:open":i[0]||(i[0]=O=>w.value=O),title:null,footer:null,maskClosable:!0,width:h.value,centered:"",bodyStyle:{padding:"0"}},{default:H(()=>[e("img",{src:g.modelValue,alt:"é¡µé¢æˆªå›¾",class:"preview-modal-image",style:Ee({width:E.value.width?E.value.width+"px":"auto",height:E.value.height?E.value.height+"px":"auto"})},null,12,nt)]),_:1},8,["open","width"])],64)}}},lt=Ae(ot,[["__scopeId","data-v-524d4854"]]),it={class:"config-editor"},rt={class:"section"},dt={class:"form-grid"},ut={class:"form-field full-width"},ct={class:"form-field full-width"},vt={class:"language-select-wrapper"},pt={class:"language-dropdown"},gt={key:0,class:"form-field full-width"},mt={class:"form-field full-width"},ft=["placeholder"],ht={key:0,class:"field-hint error"},bt={key:1,class:"field-hint error"},_t={class:"form-field full-width"},yt={class:"label-hint"},wt=["placeholder"],Ct={class:"field-help"},kt={key:0,class:"help-content"},zt={class:"section"},xt={class:"section-header"},$t={class:"form-field"},At={class:"option-item"},Nt={class:"option-label"},Mt={class:"option-id"},Bt={key:0,class:"field-hint error"},Lt={class:"form-field"},Dt={class:"option-item"},Ut={class:"option-label"},It={class:"add-button-form"},jt={class:"modal-form-field"},Et={class:"input-with-action"},Vt={class:"modal-form-field"},Tt={class:"modal-form-field"},St={class:"modal-form-field"},Pt=["placeholder"],Rt={class:"modal-form-field"},Ht=["placeholder"],Ot={class:"modal-form-field"},Wt=["placeholder"],Ft={class:"modal-form-field"},Jt={class:"modal-actions"},qt=["disabled"],Gt={__name:"ConfigEditor",props:{config:{type:Object,required:!0},sessionId:String,errors:{type:Object,default:()=>({})}},emits:["config-changed"],setup(g,{expose:P,emit:f}){const l=g,y=f,$=m(!1),I=m(!1),w=m("zh-CN"),E=m(!1),h=Me({button_id:"",category:"operation",name:{"zh-CN":"",en:""},description:{"zh-CN":"",en:""},response_info:{"zh-CN":"",en:""},voice_keywords_text:""}),q=[{value:"operation",label:"æ“ä½œæŒ‰é’®"},{value:"function",label:"åŠŸèƒ½æŒ‰é’®"},{value:"navigation",label:"å¯¼èˆªæŒ‰é’®"},{value:"input_trigger",label:"è¾“å…¥è§¦å‘æŒ‰é’®"},{value:"selection",label:"é€‰æ‹©æŒ‰é’®"}],R=ie(()=>h.button_id.trim()!==""&&h.name["zh-CN"].trim()!==""),F=()=>{if(h.name["zh-CN"]){const t=h.name.en;t?h.button_id=t.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,""):h.button_id=`btn_${Date.now().toString(36)}`}else h.button_id=`btn_${Date.now().toString(36)}`},b=()=>{h.button_id="",h.category="operation",h.name={"zh-CN":"",en:""},h.description={"zh-CN":"",en:""},h.response_info={"zh-CN":"",en:""},h.voice_keywords_text="",w.value="zh-CN"},Z=async()=>{var d,t;if(R.value){E.value=!0;try{const p=h.voice_keywords_text.split(`
`).map(j=>j.trim()).filter(j=>j!=="");await $e.create({button_id:h.button_id,name:h.name,description:h.description,response_info:h.response_info,voice_keywords:p,category:h.category}),L.success("æŒ‰é’®åˆ›å»ºæˆåŠŸ"),I.value=!1,b(),await V()}catch(p){const j=((t=(d=p.response)==null?void 0:d.data)==null?void 0:t.detail)||p.message||"åˆ›å»ºå¤±è´¥";L.error(j)}finally{E.value=!1}}},o=m([]),B=m(!1),V=async()=>{B.value=!0;try{const d=await $e.list();o.value=d.options||[]}catch(d){console.error("åŠ è½½æŒ‰é’®åˆ—è¡¨å¤±è´¥:",d),o.value=[]}finally{B.value=!1}},C=m(["zh-CN","en"]),i=m("zh-CN"),N=[{value:"zh-CN",label:"ç®€ä½“ä¸­æ–‡"},{value:"en",label:"English"},{value:"ja",label:"æ—¥æœ¬èª"},{value:"ms",label:"Bahasa Melayu"},{value:"zh-TW",label:"ç¹é«”ä¸­æ–‡"}],O=ie(()=>C.value.length===N.length),T=d=>{C.value=d,d.length>0&&!d.includes(i.value)&&(i.value=d[0])},J=()=>{O.value?(C.value=["zh-CN"],i.value="zh-CN"):C.value=N.map(d=>d.value)},A=ie(()=>{const d={"zh-CN":{nameLabel:"é¡µé¢åç§°ï¼ˆç®€ä½“ä¸­æ–‡ï¼‰",namePlaceholder:"ä¾‹å¦‚: é¦–é¡µã€ç”¨æˆ·ä¸­å¿ƒ",descLabel:"é¡µé¢æè¿°ï¼ˆç®€ä½“ä¸­æ–‡ï¼‰",descHint:"åŒ…å«åŠŸèƒ½è¯´æ˜ã€è¡Œä¸ºè§„åˆ™å’Œé¡µé¢ç›®æ ‡",descPlaceholder:"æè¿°æ­¤é¡µé¢çš„åŠŸèƒ½å’Œç”¨æˆ·å¯æ‰§è¡Œçš„æ“ä½œ..."},en:{nameLabel:"Page Name (English)",namePlaceholder:"e.g. Home Page, User Profile",descLabel:"Page Description (English)",descHint:"Include features, behavior rules and goals",descPlaceholder:"Describe the page features and available user actions..."},ja:{nameLabel:"ãƒšãƒ¼ã‚¸åï¼ˆæ—¥æœ¬èªï¼‰",namePlaceholder:"ä¾‹: ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚»ãƒ³ã‚¿ãƒ¼",descLabel:"ãƒšãƒ¼ã‚¸ã®èª¬æ˜ï¼ˆæ—¥æœ¬èªï¼‰",descHint:"æ©Ÿèƒ½èª¬æ˜ã€è¡Œå‹•è¦å‰‡ã€ç›®æ¨™ã‚’å«ã‚€",descPlaceholder:"ã“ã®ãƒšãƒ¼ã‚¸ã®æ©Ÿèƒ½ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå®Ÿè¡Œã§ãã‚‹æ“ä½œã‚’èª¬æ˜ã—ã¦ãã ã•ã„..."},ms:{nameLabel:"Nama Halaman (Bahasa Melayu)",namePlaceholder:"cth: Halaman Utama, Pusat Pengguna",descLabel:"Penerangan Halaman (Bahasa Melayu)",descHint:"Termasuk ciri, peraturan dan matlamat",descPlaceholder:"Terangkan ciri halaman dan tindakan pengguna yang tersedia..."},"zh-TW":{nameLabel:"é é¢åç¨±ï¼ˆç¹é«”ä¸­æ–‡ï¼‰",namePlaceholder:"ä¾‹å¦‚: é¦–é ã€ç”¨æˆ¶ä¸­å¿ƒ",descLabel:"é é¢æè¿°ï¼ˆç¹é«”ä¸­æ–‡ï¼‰",descHint:"åŒ…å«åŠŸèƒ½èªªæ˜ã€è¡Œç‚ºè¦å‰‡å’Œé é¢ç›®æ¨™",descPlaceholder:"æè¿°æ­¤é é¢çš„åŠŸèƒ½å’Œç”¨æˆ¶å¯åŸ·è¡Œçš„æ“ä½œ..."}};return d[i.value]||d["zh-CN"]}),G=ie(()=>i.value==="en"?`Page feature overview...

Actions available to users:
- Action 1
- Action 2

## Behavior Rules
Constraints the AI should follow on this page...

## Page Goal
The main goal for users on this page...`:`é¡µé¢åŠŸèƒ½æ¦‚è¿°...

ç”¨æˆ·å¯æ‰§è¡Œçš„æ“ä½œï¼š
- æ“ä½œ1
- æ“ä½œ2

## è¡Œä¸ºè§„åˆ™
AI åœ¨æ­¤é¡µé¢åº”éµå¾ªçš„çº¦æŸ...

## é¡µé¢ç›®æ ‡
ç”¨æˆ·åœ¨æ­¤é¡µé¢çš„ä¸»è¦ç›®æ ‡...`),Q=[{value:"knowledge",label:"çŸ¥è¯†é—®ç­” (knowledge)"},{value:"chat",label:"é—²èŠæ¨¡å¼ (chat)"},{value:"comprehension",label:"é˜…è¯»ç†è§£ (comprehension)"},{value:"Dir-read-agreement",label:"æœ—è¯»åè®® (Dir-read-agreement)"},{value:"UpdateFormLossReason",label:"æ›´æ–°æŒ‚å¤±åŸå›  (UpdateFormLossReason)"},{value:"UpdateFormCancelAccount",label:"æ›´æ–°è½¬è´¦è¡¨å• (UpdateFormCancelAccount)"}],me=Q.reduce((d,t)=>(d[t.value]=t.label.split(" (")[0],d),{}),ye=d=>{const t=o.value.find(p=>p.value===d);return t?t.label.split(" (")[0]:d},we=d=>me[d]||d,x=Me({page_id:"",name:{"zh-CN":"",en:"",ja:"",ms:"","zh-TW":""},description:{"zh-CN":"",en:"",ja:"",ms:"","zh-TW":""},button_list:[],optional_actions:[]});xe(async()=>{fe(),await V()}),ke(()=>l.config,()=>{fe()},{deep:!0});const fe=()=>{var d,t,p,j,te,re,ue,ce,he,c;if(l.config){x.page_id=l.config.page_id||"",x.name={"zh-CN":((d=l.config.name)==null?void 0:d["zh-CN"])||"",en:((t=l.config.name)==null?void 0:t.en)||"",ja:((p=l.config.name)==null?void 0:p.ja)||"",ms:((j=l.config.name)==null?void 0:j.ms)||"","zh-TW":((te=l.config.name)==null?void 0:te["zh-TW"])||""};let X=((re=l.config.description)==null?void 0:re["zh-CN"])||"",ae=((ue=l.config.description)==null?void 0:ue.en)||"";if(l.config.ai_context){const{behavior_rules:ee,page_goal:ve}=l.config.ai_context;ee&&!X.includes("## è¡Œä¸ºè§„åˆ™")&&(X+=`

## è¡Œä¸ºè§„åˆ™
${ee}`),ve&&!X.includes("## é¡µé¢ç›®æ ‡")&&(X+=`

## é¡µé¢ç›®æ ‡
${ve}`),ee&&!ae.includes("## Behavior Rules")&&(ae+=`

## Behavior Rules
${ee}`),ve&&!ae.includes("## Page Goal")&&(ae+=`

## Page Goal
${ve}`)}x.description={"zh-CN":X.trim(),en:ae.trim(),ja:((ce=l.config.description)==null?void 0:ce.ja)||"",ms:((he=l.config.description)==null?void 0:he.ms)||"","zh-TW":((c=l.config.description)==null?void 0:c["zh-TW"])||""},x.button_list=(l.config.button_list||[]).filter(ee=>ee&&ee.trim()),x.optional_actions=(l.config.optional_actions||[]).filter(ee=>ee&&ee.trim())}},Ce=d=>{const t=N.find(p=>p.value===d);return t?t.label:d},r=()=>{y("config-changed",{page_id:x.page_id,name:{...x.name},description:{...x.description},button_list:[...x.button_list],optional_actions:[...x.optional_actions]})},n=d=>{x.button_list=d,r()},W=d=>{x.optional_actions=d,r()},K=()=>{L.info("ç¿»è¯‘åŠŸèƒ½å¼€å‘ä¸­...")};return P({loadButtonOptions:V}),(d,t)=>{const p=se("a-checkbox"),j=se("a-divider"),te=se("a-select"),re=se("a-radio-button"),ue=se("a-radio-group"),ce=se("a-tag"),he=se("a-modal");return u(),v("div",it,[e("section",rt,[t[26]||(t[26]=e("div",{class:"section-header"},[e("div",{class:"section-icon"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])]),e("h3",null,"åŸºæœ¬ä¿¡æ¯")],-1)),e("div",dt,[e("div",ut,[t[18]||(t[18]=e("label",null,[z(" é¡µé¢ ID (è‹±æ–‡æ ‡è¯†) "),e("span",{class:"required"},"*")],-1)),ne(e("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>x.page_id=c),type:"text",class:ge(["form-input",{error:g.errors.page_id}]),placeholder:"ä¾‹å¦‚: 1.0home_page, 4.1face_authorization_page",onInput:r},null,34),[[oe,x.page_id]]),e("span",{class:ge(["field-hint",{error:g.errors.page_id}])},k(g.errors.page_id||"æ ¼å¼: {é¡µé¢ç¼–å·}{è‹±æ–‡åç§°}ï¼Œå¦‚ 4.1face_authorization_pageï¼Œå•è¯é—´ç”¨ä¸‹åˆ’çº¿åˆ†éš”"),3)]),e("div",ct,[t[20]||(t[20]=e("label",null,[z(" è¯­è¨€ / Language "),e("span",{class:"required"},"*")],-1)),e("div",vt,[U(te,{value:C.value,"onUpdate:value":t[1]||(t[1]=c=>C.value=c),mode:"multiple",class:"language-select",options:N,placeholder:"é€‰æ‹©æ”¯æŒçš„è¯­è¨€...",onChange:T},{dropdownRender:H(({menuNode:c})=>[e("div",pt,[e("div",{class:"select-all-option",onClick:J},[U(p,{checked:O.value},null,8,["checked"]),t[19]||(t[19]=e("span",null,"å…¨é€‰",-1))]),U(j,{style:{margin:"4px 0"}}),(u(),Be(Ve(c)))])]),_:1},8,["value"])])]),C.value.length>1?(u(),v("div",gt,[t[21]||(t[21]=e("label",null,"å½“å‰ç¼–è¾‘è¯­è¨€",-1)),U(ue,{value:i.value,"onUpdate:value":t[2]||(t[2]=c=>i.value=c),"button-style":"solid",class:"language-tabs"},{default:H(()=>[(u(!0),v(le,null,be(C.value,c=>(u(),Be(re,{key:c,value:c},{default:H(()=>[z(k(Ce(c)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])):D("",!0),e("div",mt,[e("label",null,[z(k(A.value.nameLabel)+" ",1),t[22]||(t[22]=e("span",{class:"required"},"*",-1))]),ne(e("input",{"onUpdate:modelValue":t[3]||(t[3]=c=>x.name[i.value]=c),type:"text",class:ge(["form-input",{error:i.value==="zh-CN"?g.errors.name_zh:g.errors.name_en}]),placeholder:A.value.namePlaceholder,onInput:r},null,42,ft),[[oe,x.name[i.value]]]),i.value==="zh-CN"&&g.errors.name_zh?(u(),v("span",ht,k(g.errors.name_zh),1)):D("",!0),i.value==="en"&&g.errors.name_en?(u(),v("span",bt,k(g.errors.name_en),1)):D("",!0)]),e("div",_t,[e("label",null,[z(k(A.value.descLabel)+" ",1),e("span",yt,k(A.value.descHint),1)]),ne(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=c=>x.description[i.value]=c),class:"form-textarea description-textarea",rows:"8",placeholder:A.value.descPlaceholder,onInput:r},null,40,wt),[[oe,x.description[i.value]]]),e("div",Ct,[e("button",{type:"button",class:"help-toggle",onClick:t[5]||(t[5]=c=>$.value=!$.value)},[t[23]||(t[23]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 16v-4M12 8h.01"})],-1)),z(" "+k($.value?"æ”¶èµ·æ ¼å¼è¯´æ˜":"æŸ¥çœ‹æ ¼å¼è¯´æ˜"),1)]),$.value?(u(),v("div",kt,[t[24]||(t[24]=e("p",null,[e("strong",null,"æ¨èæ ¼å¼ï¼š")],-1)),e("pre",null,k(G.value),1)])):D("",!0)])]),e("div",{class:"form-field full-width"},[e("button",{type:"button",class:"translate-btn",onClick:K},[...t[25]||(t[25]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"})],-1),z(" ä¸€é”®ç¿»è¯‘ ",-1)])])])])]),e("section",zt,[e("div",xt,[t[28]||(t[28]=pe('<div class="section-icon accent" data-v-0cbee26d><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-0cbee26d><rect x="3" y="3" width="7" height="7" data-v-0cbee26d></rect><rect x="14" y="3" width="7" height="7" data-v-0cbee26d></rect><rect x="14" y="14" width="7" height="7" data-v-0cbee26d></rect><rect x="3" y="14" width="7" height="7" data-v-0cbee26d></rect></svg></div><h3 data-v-0cbee26d>é¡µé¢èƒ½åŠ›</h3>',2)),e("button",{class:"add-button-btn",onClick:t[6]||(t[6]=c=>I.value=!0)},[...t[27]||(t[27]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),z(" æ–°å¢æŒ‰é’® ",-1)])])]),e("div",$t,[t[29]||(t[29]=e("label",null,"å¯ç‚¹å‡»æŒ‰é’®",-1)),U(te,{value:x.button_list,"onUpdate:value":t[7]||(t[7]=c=>x.button_list=c),mode:"multiple",class:"button-select",placeholder:"é€‰æ‹©æŒ‰é’®...",options:o.value,"option-filter-prop":"label","show-search":"","allow-clear":"",onChange:n},{option:H(({value:c,label:X})=>[e("span",At,[e("span",Nt,k(X),1),e("span",Mt,k(c),1)])]),tagRender:H(({value:c,closable:X,onClose:ae})=>[U(ce,{closable:X,class:"button-tag",onClose:ae},{default:H(()=>[z(k(ye(c)),1)]),_:2},1032,["closable","onClose"])]),_:1},8,["value","options"]),g.errors.button_list?(u(),v("span",Bt,k(g.errors.button_list),1)):D("",!0)]),e("div",Lt,[t[30]||(t[30]=e("label",null,"å¯é€‰æ„å›¾",-1)),U(te,{value:x.optional_actions,"onUpdate:value":t[8]||(t[8]=c=>x.optional_actions=c),mode:"multiple",class:"intent-select",placeholder:"æœç´¢æ„å›¾åç§°...",options:Q,"option-filter-prop":"label","show-search":"","allow-clear":"",onChange:W},{option:H(({value:c,label:X})=>[e("span",Dt,[e("span",Ut,k(X),1)])]),tagRender:H(({value:c,closable:X,onClose:ae})=>[U(ce,{closable:X,class:"intent-tag",onClose:ae},{default:H(()=>[z(k(we(c)),1)]),_:2},1032,["closable","onClose"])]),_:1},8,["value"])])]),U(he,{open:I.value,"onUpdate:open":t[17]||(t[17]=c=>I.value=c),title:"æ–°å¢æŒ‰é’®",width:600,footer:null,class:"add-button-modal",onCancel:b},{default:H(()=>[e("div",It,[e("div",jt,[t[31]||(t[31]=e("label",null,[z(" æŒ‰é’® IDï¼ˆè‹±æ–‡æ ‡è¯†ï¼‰ "),e("span",{class:"required"},"*")],-1)),e("div",Et,[ne(e("input",{"onUpdate:modelValue":t[9]||(t[9]=c=>h.button_id=c),type:"text",class:"form-input",placeholder:"ä¾‹å¦‚: submit_form, cancel_order"},null,512),[[oe,h.button_id]]),e("button",{type:"button",class:"generate-btn",onClick:F}," ç”Ÿæˆ ")]),t[32]||(t[32]=e("span",{class:"field-hint"},"åªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œä½¿ç”¨ snake_case æ ¼å¼",-1))]),e("div",Vt,[t[33]||(t[33]=e("label",null,"æŒ‰é’®åˆ†ç±»",-1)),U(te,{value:h.category,"onUpdate:value":t[10]||(t[10]=c=>h.category=c),class:"form-select",options:q},null,8,["value"])]),e("div",Tt,[t[36]||(t[36]=e("label",null,"ç¼–è¾‘è¯­è¨€",-1)),U(ue,{value:w.value,"onUpdate:value":t[11]||(t[11]=c=>w.value=c),"button-style":"solid",class:"language-tabs"},{default:H(()=>[U(re,{value:"zh-CN"},{default:H(()=>[...t[34]||(t[34]=[z("ç®€ä½“ä¸­æ–‡",-1)])]),_:1}),U(re,{value:"en"},{default:H(()=>[...t[35]||(t[35]=[z("English",-1)])]),_:1})]),_:1},8,["value"])]),e("div",St,[e("label",null,[z(k(w.value==="zh-CN"?"æŒ‰é’®åç§°ï¼ˆç®€ä½“ä¸­æ–‡ï¼‰":"Button Name (English)")+" ",1),t[37]||(t[37]=e("span",{class:"required"},"*",-1))]),ne(e("input",{"onUpdate:modelValue":t[12]||(t[12]=c=>h.name[w.value]=c),type:"text",class:"form-input",placeholder:w.value==="zh-CN"?"ä¾‹å¦‚: æäº¤è¡¨å•":"e.g. Submit Form"},null,8,Pt),[[oe,h.name[w.value]]])]),e("div",Rt,[e("label",null,k(w.value==="zh-CN"?"æŒ‰é’®æè¿°":"Description"),1),ne(e("textarea",{"onUpdate:modelValue":t[13]||(t[13]=c=>h.description[w.value]=c),class:"form-textarea",rows:"2",placeholder:w.value==="zh-CN"?"æè¿°æŒ‰é’®çš„åŠŸèƒ½...":"Describe the button function..."},null,8,Ht),[[oe,h.description[w.value]]])]),e("div",Ot,[e("label",null,k(w.value==="zh-CN"?"å“åº”ä¿¡æ¯":"Response Info"),1),ne(e("textarea",{"onUpdate:modelValue":t[14]||(t[14]=c=>h.response_info[w.value]=c),class:"form-textarea",rows:"2",placeholder:w.value==="zh-CN"?"ç‚¹å‡»æŒ‰é’®åçš„æç¤ºä¿¡æ¯...":"Message shown after clicking..."},null,8,Wt),[[oe,h.response_info[w.value]]])]),e("div",Ft,[t[38]||(t[38]=e("label",null,"è¯­éŸ³å…³é”®è¯",-1)),ne(e("textarea",{"onUpdate:modelValue":t[15]||(t[15]=c=>h.voice_keywords_text=c),class:"form-textarea",rows:"2",placeholder:`æ¯è¡Œä¸€ä¸ªå…³é”®è¯ï¼Œä¾‹å¦‚:
æäº¤
ç¡®å®š
submit`},null,512),[[oe,h.voice_keywords_text]]),t[39]||(t[39]=e("span",{class:"field-hint"},"ç”¨äºè¯­éŸ³è¯†åˆ«ï¼Œæ¯è¡Œä¸€ä¸ªå…³é”®è¯",-1))]),e("div",Jt,[e("button",{type:"button",class:"btn-secondary",onClick:t[16]||(t[16]=c=>I.value=!1)}," å–æ¶ˆ "),e("button",{type:"button",class:"btn-primary",disabled:!R.value||E.value,onClick:Z},k(E.value?"ä¿å­˜ä¸­...":"ä¿å­˜æŒ‰é’®"),9,qt)])])]),_:1},8,["open"])])}}},Kt=Ae(Gt,[["__scopeId","data-v-0cbee26d"]]),Zt={class:"clarify-panel"},Qt={class:"panel-header"},Xt={key:0,class:"message assistant"},Yt={class:"bubble-wrapper"},ea={key:0,class:"avatar small"},ta={class:"bubble"},aa=["src","onClick"],sa=["innerHTML"],na={key:1,class:"streaming-cursor"},oa={class:"timestamp"},la={key:1,class:"message assistant"},ia={class:"bubble-wrapper"},ra={class:"bubble"},da={class:"streaming-output"},ua={key:1,class:"parsing-message"},ca={key:2,class:"message assistant"},va={class:"bubble-wrapper"},pa={class:"bubble summary-bubble"},ga={class:"summary-content"},ma={key:3,class:"message assistant"},fa={class:"message assistant"},ha={class:"bubble-wrapper"},ba={class:"bubble config-preview"},_a={class:"config-summary"},ya={key:0,class:"config-item"},wa={class:"page-id-value"},Ca={key:1,class:"config-item"},ka={key:2,class:"config-item"},za={class:"tag-list"},xa={key:3,class:"config-item"},$a={class:"tag-list"},Aa={key:0,class:"message assistant"},Na={class:"bubble-wrapper"},Ma={class:"bubble unrecognized-buttons-card"},Ba={class:"unrecognized-list"},La={class:"item-info"},Da={class:"item-name"},Ua={class:"item-id"},Ia={key:0,class:"item-context"},ja=["disabled","onClick"],Ea={key:5,class:"message assistant"},Va={class:"bubble-wrapper"},Ta={class:"bubble"},Sa={key:0,class:"quick-options"},Pa=["onClick"],Ra={key:0,class:"pending-image"},Ha=["src"],Oa={class:"input-area"},Wa={class:"input-wrapper"},Fa=["disabled"],Ja=["disabled"],qa=["disabled"],Ga={__name:"ClarifyPanel",props:{sessionId:String,parseResult:Object,status:String,currentConfig:Object,imageUrl:String,streamingContent:String,summaryContent:String},emits:["config-updated","config-confirmed","completed","button-added"],setup(g,{emit:P}){const f=g,l=P,y=m([]),$=m(null),I=m(""),w=m(!1),E=m(null),h=m(null),q=m(null),R=m(null),F=m(!1),b=m(null),Z=m(!1),o=m([]),B=m(!1),V=ie(()=>({pending:"ç­‰å¾…ä¸­",parsing:"åˆ†æä¸­...",summarized:"å¾…ç¡®è®¤",clarifying:"å¯¹è¯ä¸­",completed:"å·²å®Œæˆ",failed:"å¤±è´¥"})[f.status]||"");ke(()=>f.parseResult,r=>{var n;r&&f.status==="completed"&&!Z.value&&(b.value=r,F.value=!0,x()),((n=r==null?void 0:r.clarification_questions)==null?void 0:n.length)>0?$.value=r.clarification_questions[0]:$.value=null},{immediate:!0}),ke(()=>f.status,(r,n)=>{var W;r==="parsing"&&n!=="parsing"&&(y.value.push({role:"assistant",content:"æ­£åœ¨åˆ†æé¡µé¢æˆªå›¾ï¼Œè¯·ç¨å€™...",timestamp:new Date}),Z.value=!1,F.value=!1,x()),r==="summarized"&&n==="parsing"&&x(),r==="clarifying"&&f.parseResult&&(y.value.push({role:"assistant",content:"æˆ‘å·²å®Œæˆåˆæ­¥åˆ†æï¼Œè¿˜æœ‰ä¸€äº›é—®é¢˜éœ€è¦ç¡®è®¤ï¼š",timestamp:new Date}),((W=f.parseResult.clarification_questions)==null?void 0:W.length)>0&&($.value=f.parseResult.clarification_questions[0]),x())}),ke(()=>f.streamingContent,()=>{f.streamingContent&&x()});const C=()=>{b.value&&(l("config-confirmed",b.value),Z.value=!0,F.value=!1,y.value.push({role:"user",content:"ç¡®è®¤åº”ç”¨æ­¤é…ç½®",timestamp:new Date}),x())},i=()=>{F.value=!1,y.value.push({role:"user",content:"éœ€è¦é‡æ–°è¯†åˆ«",timestamp:new Date}),y.value.push({role:"assistant",content:"å¥½çš„ï¼Œè¯·é‡æ–°ä¸Šä¼ å›¾ç‰‡æˆ–æè¿°æ‚¨çš„éœ€æ±‚ï¼Œæˆ‘ä¼šé‡æ–°åˆ†æã€‚",timestamp:new Date}),x()},N=r=>{r.key==="Enter"&&!r.shiftKey&&(r.preventDefault(),G())},O=r=>{h.value=r;const n=new FileReader;return n.onload=W=>{q.value=W.target.result},n.readAsDataURL(r),!1},T=r=>{var W;const n=(W=r.target.files)==null?void 0:W[0];if(n){if(!["image/png","image/jpeg","image/jpg"].includes(n.type))return;O(n)}r.target.value=""},J=()=>{h.value=null,q.value=null},A=r=>{R.value=r},G=async()=>{var W,K;if(!I.value.trim()&&!h.value||w.value)return;const r=I.value.trim(),n=q.value;I.value="",J(),y.value.push({role:"user",content:r||"(ä¸Šä¼ äº†å›¾ç‰‡)",image:n,timestamp:new Date}),x(),w.value=!0;try{if(f.sessionId&&(f.status==="summarized"||f.status==="clarifying"||f.status==="completed")){let d="";const t=y.value.length;y.value.push({role:"assistant",content:"",timestamp:new Date,isStreaming:!0});const p=We.chatStream(f.sessionId,r,f.currentConfig,j=>{j.type==="content"&&(d+=j.content,y.value[t].content=d,x())},j=>{y.value[t].isStreaming=!1,y.value[t].content=d||"å¥½çš„ï¼Œæˆ‘å·²æ ¹æ®æ‚¨çš„å»ºè®®æ›´æ–°äº†é…ç½®ã€‚",j&&(b.value=j,F.value=!0,Z.value=!1),w.value=!1,x()},j=>{y.value[t].isStreaming=!1,y.value[t].content=`âŒ ${j||"è¯·æ±‚å¤±è´¥ï¼Œè¯·é‡è¯•"}`,w.value=!1,x()});window._currentChatStream=p}else y.value.push({role:"assistant",content:'è¯·å…ˆä¸Šä¼ é¡µé¢æˆªå›¾å¹¶ç‚¹å‡»"AI è¾…åŠ©å¡«å†™"ï¼Œæˆ‘ä¼šå¸®æ‚¨è¯†åˆ«é¡µé¢å…ƒç´ ã€‚',timestamp:new Date}),w.value=!1}catch(d){y.value.push({role:"assistant",content:`âŒ ${((K=(W=d.response)==null?void 0:W.data)==null?void 0:K.message)||"è¯·æ±‚å¤±è´¥ï¼Œè¯·é‡è¯•"}`,timestamp:new Date}),w.value=!1}finally{x()}},Q=r=>{I.value=r,G()},me=async r=>{var n,W,K;if(!(B.value||o.value.includes(r.suggested_id))){B.value=!0;try{await $e.create({button_id:r.suggested_id,name:{"zh-CN":r.suggested_name_zh,en:r.suggested_name_en||""},description:{"zh-CN":r.context||"",en:""},response_info:{},voice_keywords:[],category:"operation"}),o.value.push(r.suggested_id),b.value&&!((n=b.value.button_list)!=null&&n.includes(r.suggested_id))&&(b.value.button_list||(b.value.button_list=[]),b.value.button_list.push(r.suggested_id)),L.success(`æŒ‰é’® "${r.suggested_name_zh}" æ·»åŠ æˆåŠŸ`),l("button-added",r)}catch(d){const t=((K=(W=d.response)==null?void 0:W.data)==null?void 0:K.detail)||d.message||"æ·»åŠ å¤±è´¥";L.error(t)}finally{B.value=!1}}},ye=async()=>{var W,K,d;if(!((K=(W=b.value)==null?void 0:W.unrecognized_buttons)!=null&&K.length))return;const r=b.value.unrecognized_buttons.filter(t=>!o.value.includes(t.suggested_id));if(r.length===0){L.info("æ‰€æœ‰æŒ‰é’®å·²æ·»åŠ ");return}B.value=!0;let n=0;for(const t of r)try{await $e.create({button_id:t.suggested_id,name:{"zh-CN":t.suggested_name_zh,en:t.suggested_name_en||""},description:{"zh-CN":t.context||"",en:""},response_info:{},voice_keywords:[],category:"operation"}),o.value.push(t.suggested_id),b.value&&!((d=b.value.button_list)!=null&&d.includes(t.suggested_id))&&(b.value.button_list||(b.value.button_list=[]),b.value.button_list.push(t.suggested_id)),n++,l("button-added",t)}catch(p){console.error(`æ·»åŠ æŒ‰é’® ${t.suggested_id} å¤±è´¥:`,p)}B.value=!1,n>0&&L.success(`æˆåŠŸæ·»åŠ  ${n} ä¸ªæŒ‰é’®`)},we=()=>{b.value&&(b.value.unrecognized_buttons=[]),y.value.push({role:"assistant",content:'å¥½çš„ï¼Œå·²å¿½ç•¥è¿™äº›æ–°æŒ‰é’®ã€‚å¦‚æœä¹‹åéœ€è¦æ·»åŠ ï¼Œå¯ä»¥åœ¨"é¡µé¢èƒ½åŠ›"åŒºåŸŸç‚¹å‡»"æ–°å¢æŒ‰é’®"æ‰‹åŠ¨æ·»åŠ ã€‚',timestamp:new Date}),x()},x=()=>{Te(()=>{E.value&&(E.value.scrollTop=E.value.scrollHeight)})},fe=r=>r?r.replace(/\n/g,"<br>"):"",Ce=r=>new Date(r).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"});return(r,n)=>{var K,d,t;const W=se("a-image");return u(),v("div",Zt,[e("div",Qt,[n[2]||(n[2]=pe('<div class="assistant-info" data-v-392b1e8c><div class="avatar" data-v-392b1e8c><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-392b1e8c><path d="M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z" data-v-392b1e8c></path></svg></div><span class="name" data-v-392b1e8c>UI config å¡«å†™åŠ©æ‰‹</span></div>',1)),g.status?(u(),v("span",{key:0,class:ge(["status-badge",g.status])},[n[1]||(n[1]=e("span",{class:"status-dot"},null,-1)),z(" "+k(V.value),1)],2)):D("",!0)]),e("div",{class:"chat-container",ref_key:"chatContainer",ref:E},[y.value.length===0&&!g.status?(u(),v("div",Xt,[...n[3]||(n[3]=[pe('<div class="bubble" data-v-392b1e8c><div class="welcome-content" data-v-392b1e8c><div class="welcome-icon" data-v-392b1e8c>ğŸ‘‹</div><div class="welcome-text" data-v-392b1e8c><p data-v-392b1e8c>ä½ å¥½ï¼ä¸Šä¼ é¡µé¢æˆªå›¾å¹¶ç‚¹å‡»&quot;AI è¾…åŠ©å¡«å†™&quot;ï¼Œæˆ‘å°†å¸®åŠ©æ‚¨è‡ªåŠ¨è¯†åˆ«é¡µé¢å…ƒç´ ã€‚</p><p class="sub" data-v-392b1e8c>æ‚¨ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ä¸‹æ–¹è¾“å…¥æ¡†æè¿°æ‚¨æƒ³è¦é…ç½®çš„é¡µé¢åŠŸèƒ½ã€‚</p></div></div></div>',1)])])):D("",!0),(u(!0),v(le,null,be(y.value,(p,j)=>(u(),v("div",{key:j,class:ge(["message",p.role])},[e("div",Yt,[p.role==="assistant"?(u(),v("div",ea,[...n[4]||(n[4]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z"})],-1)])])):D("",!0),e("div",ta,[p.image?(u(),v("img",{key:0,src:p.image,class:"chat-image",onClick:te=>A(p.image)},null,8,aa)):D("",!0),e("span",{innerHTML:fe(p.content)},null,8,sa),p.isStreaming?(u(),v("span",na,"â–Š")):D("",!0)])]),e("span",oa,k(Ce(p.timestamp)),1)],2))),128)),g.status==="parsing"?(u(),v("div",la,[e("div",ia,[n[7]||(n[7]=e("div",{class:"avatar small"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z"})])],-1)),e("div",ra,[g.streamingContent?(u(),v(le,{key:0},[e("pre",da,k(g.streamingContent),1),n[5]||(n[5]=e("span",{class:"streaming-cursor"},"â–Š",-1))],64)):(u(),v("div",ua,[...n[6]||(n[6]=[e("span",{class:"parsing-icon"},"ğŸ”",-1),z(" æ­£åœ¨åˆ†æé¡µé¢æˆªå›¾ï¼Œè¯†åˆ«å¯äº¤äº’å…ƒç´ ... ",-1)])]))])])])):D("",!0),g.status==="summarized"&&g.summaryContent?(u(),v("div",ca,[e("div",va,[n[8]||(n[8]=e("div",{class:"avatar small"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z"})])],-1)),e("div",pa,[e("pre",ga,k(g.summaryContent),1)])])])):D("",!0),w.value?(u(),v("div",ma,[...n[9]||(n[9]=[pe('<div class="bubble-wrapper" data-v-392b1e8c><div class="avatar small" data-v-392b1e8c><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-392b1e8c><path d="M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z" data-v-392b1e8c></path></svg></div><div class="bubble loading" data-v-392b1e8c><span class="dot" data-v-392b1e8c></span><span class="dot" data-v-392b1e8c></span><span class="dot" data-v-392b1e8c></span></div></div>',1)])])):D("",!0),F.value&&b.value?(u(),v(le,{key:4},[e("div",fa,[e("div",ha,[n[16]||(n[16]=e("div",{class:"avatar small"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z"})])],-1)),e("div",ba,[n[15]||(n[15]=e("div",{class:"preview-header"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M20 6L9 17l-5-5"})]),z(" è§£æå®Œæˆï¼ä»¥ä¸‹æ˜¯è¯†åˆ«åˆ°çš„é…ç½®ä¿¡æ¯ï¼š ")],-1)),e("div",_a,[b.value.page_id?(u(),v("div",ya,[n[10]||(n[10]=e("label",null,"é¡µé¢ IDï¼š",-1)),e("span",wa,k(b.value.page_id),1)])):D("",!0),b.value.page_name?(u(),v("div",Ca,[n[11]||(n[11]=e("label",null,"é¡µé¢åç§°ï¼š",-1)),e("span",null,k(b.value.page_name["zh-CN"]||""),1)])):D("",!0),(K=b.value.button_list)!=null&&K.length?(u(),v("div",ka,[e("label",null,"è¯†åˆ«åˆ°çš„æŒ‰é’® ("+k(b.value.button_list.length)+"ä¸ª)ï¼š",1),e("div",za,[(u(!0),v(le,null,be(b.value.button_list,p=>(u(),v("span",{key:p,class:"config-tag"},k(p),1))),128))])])):D("",!0),(d=b.value.optional_actions)!=null&&d.length?(u(),v("div",xa,[n[12]||(n[12]=e("label",null,"å¯é€‰æ“ä½œï¼š",-1)),e("div",$a,[(u(!0),v(le,null,be(b.value.optional_actions,p=>(u(),v("span",{key:p,class:"config-tag accent"},k(p),1))),128))])])):D("",!0)]),e("div",{class:"preview-actions"},[e("button",{class:"action-btn secondary",onClick:i},[...n[13]||(n[13]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 005.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 013.51 15"})],-1),z(" é‡æ–°è¯†åˆ« ",-1)])]),e("button",{class:"action-btn primary",onClick:C},[...n[14]||(n[14]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M20 6L9 17l-5-5"})],-1),z(" ç¡®è®¤åº”ç”¨ ",-1)])])])])])]),((t=b.value.unrecognized_buttons)==null?void 0:t.length)>0?(u(),v("div",Aa,[e("div",Na,[n[18]||(n[18]=e("div",{class:"avatar small"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z"})])],-1)),e("div",Ma,[n[17]||(n[17]=pe('<div class="card-header warning" data-v-392b1e8c><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-392b1e8c><circle cx="12" cy="12" r="10" data-v-392b1e8c></circle><line x1="12" y1="8" x2="12" y2="12" data-v-392b1e8c></line><line x1="12" y1="16" x2="12.01" y2="16" data-v-392b1e8c></line></svg> å‘ç°æ–°æŒ‰é’® </div><p class="card-desc" data-v-392b1e8c>æˆ‘åœ¨å›¾ç‰‡ä¸­è¯†åˆ«åˆ°äº†ä»¥ä¸‹æŒ‰é’®ï¼Œä½†å®ƒä»¬å°šæœªæ·»åŠ åˆ°ç³»ç»Ÿä¸­ï¼š</p>',2)),e("div",Ba,[(u(!0),v(le,null,be(b.value.unrecognized_buttons,p=>(u(),v("div",{key:p.suggested_id,class:"unrecognized-item"},[e("div",La,[e("span",Da,k(p.suggested_name_zh),1),e("span",Ua,k(p.suggested_id),1),p.context?(u(),v("span",Ia,k(p.context),1)):D("",!0)]),e("button",{class:"add-btn",disabled:o.value.includes(p.suggested_id),onClick:j=>me(p)},k(o.value.includes(p.suggested_id)?"å·²æ·»åŠ ":"æ·»åŠ "),9,ja)]))),128))]),e("div",{class:"card-actions"},[e("button",{class:"action-btn secondary",onClick:we}," å¿½ç•¥è¿™äº›æŒ‰é’® "),e("button",{class:"action-btn primary",onClick:ye}," å…¨éƒ¨æ·»åŠ  ")])])])])):D("",!0)],64)):D("",!0),$.value&&g.status==="clarifying"?(u(),v("div",Ea,[e("div",Va,[n[19]||(n[19]=e("div",{class:"avatar small"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z"})])],-1)),e("div",Ta,k($.value.question_text||$.value),1)]),$.value.options?(u(),v("div",Sa,[(u(!0),v(le,null,be($.value.options,p=>(u(),v("button",{key:p,class:"option-btn",onClick:j=>Q(p)},k(p),9,Pa))),128))])):D("",!0)])):D("",!0)],512),U(W,{width:200,style:{display:"none"},preview:{visible:!!R.value,onVisibleChange:p=>{p||(R.value=null)},src:R.value}},null,8,["preview"]),h.value?(u(),v("div",Ra,[e("img",{src:q.value},null,8,Ha),e("button",{class:"remove-btn",onClick:J},[...n[20]||(n[20]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])])):D("",!0),e("div",Oa,[e("div",Wa,[e("label",{class:ge(["upload-btn",{disabled:w.value}])},[e("input",{type:"file",accept:"image/png,image/jpeg,.png,.jpg,.jpeg",onChange:T,disabled:w.value},null,40,Fa),n[21]||(n[21]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"}),e("polyline",{points:"17 8 12 3 7 8"}),e("line",{x1:"12",y1:"3",x2:"12",y2:"15"})],-1))],2),ne(e("textarea",{ref:"inputRef","onUpdate:modelValue":n[0]||(n[0]=p=>I.value=p),placeholder:"è¾“å…¥ä¿®æ”¹å»ºè®®æˆ–é—®é¢˜...",disabled:w.value,onKeydown:N,rows:"1"},null,40,Ja),[[oe,I.value]]),e("button",{class:"send-btn",disabled:!I.value.trim()&&!h.value||w.value,onClick:G},[...n[22]||(n[22]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"})],-1)])],8,qa)]),n[23]||(n[23]=e("div",{class:"input-hint"}," Enter å‘é€ Â· Shift+Enter æ¢è¡Œ ",-1))])])}}},Ka=Ae(Ga,[["__scopeId","data-v-392b1e8c"]]),Za={class:"page-editor"},Qa={class:"editor-header"},Xa={class:"header-left"},Ya={class:"header-title"},es={class:"title-icon"},ts={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},as={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ss={class:"header-actions"},ns={key:0,class:"unsaved-badge"},os=["disabled"],ls={key:0,class:"btn-spinner dark"},is=["disabled"],rs={key:0,class:"btn-spinner"},ds={class:"editor-body"},us={class:"editor-grid"},cs={class:"panel panel-left"},vs={class:"panel-card"},ps={class:"card-body"},gs=["disabled"],ms={key:0,class:"btn-spinner"},fs={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},hs={class:"panel-card"},bs={class:"card-body"},_s={class:"json-preview-container"},ys={class:"panel panel-center"},ws={class:"panel-card config-card"},Cs={class:"card-body"},ks={class:"panel panel-right"},zs={class:"panel-card ai-card"},xs={class:"card-body"},$s={key:0,class:"json-editor-error"},As={__name:"PageEditor",setup(g){const P=Se(),f=Pe(),l=Fe(),y=ie(()=>P.name==="PageCreate"),$=m(""),I=m(null),w=m(""),E=m(null),h=m(null),q=m(""),R=m(!1),F=m(!1),b=m(!1),Z=m(!1),o=m(null),B=m({}),V=m(""),C=m(""),i=m(!1),N=m(!1),O=m(""),T=m("");let J=null;const A=ie(()=>{const s=l.draftConfig,a=(s.button_list||[]).filter(_=>_&&_.trim()),M=(s.optional_actions||[]).filter(_=>_&&_.trim()),S={pages:{[s.page_id||"unnamed"]:{name:s.name,description:s.description,buttonList:a,optionalActions:M}}};return JSON.stringify(S,null,2)}),G=()=>{O.value=A.value,T.value="",N.value=!0},Q=s=>s&&typeof s=="object"?{"zh-CN":s["zh-CN"]||"",en:s.en||"",ja:s.ja||"",ms:s.ms||"","zh-TW":s["zh-TW"]||""}:typeof s=="string"?{"zh-CN":s,en:"",ja:"",ms:"","zh-TW":""}:{"zh-CN":"",en:"",ja:"",ms:"","zh-TW":""},me=s=>Array.isArray(s)?s.map(a=>a==null?"":String(a)).filter(a=>a.trim()):[],ye=()=>{T.value="";let s=null;try{s=JSON.parse(O.value)}catch{T.value="JSON æ ¼å¼é”™è¯¯ï¼Œè¯·æ£€æŸ¥åé‡è¯•";return}if(!s||typeof s!="object"||!s.pages||typeof s.pages!="object"){T.value="JSON ç»“æ„é”™è¯¯ï¼Œéœ€è¦åŒ…å« pages å¯¹è±¡";return}const a=Object.entries(s.pages);if(a.length===0){T.value="pages ä¸èƒ½ä¸ºç©º";return}const[M,S]=a[0];if(!M||typeof M!="string"){T.value="é¡µé¢ ID æ— æ•ˆ";return}const _=S||{};l.applyUserEdit({page_id:M,name:Q(_.name),description:Q(_.description),button_list:me(_.buttonList||_.button_list),optional_actions:me(_.optionalActions||_.optional_actions)}),N.value=!1,L.success("JSON å·²åº”ç”¨åˆ°è¡¨å•")};xe(async()=>{if(l.resetConfig(),P.query.project&&(I.value=parseInt(P.query.project,10)),!y.value&&P.params.id)try{const s=await _e.get(P.params.id);l.setOriginalConfig({page_id:s.page_id,name:s.name,description:s.description,button_list:s.button_list||[],optional_actions:s.optional_actions||[]}),$.value=s.screenshot_url||"",I.value=s.project_id||null}catch(s){console.error("Failed to load page:",s),L.error("åŠ è½½é¡µé¢å¤±è´¥"),f.push("/")}});const we=s=>{$.value=s.file_url,L.success("å›¾ç‰‡ä¸Šä¼ æˆåŠŸ")},x=s=>{L.error(s.message||"ä¸Šä¼ å¤±è´¥")},fe=async()=>{var s,a;if(!$.value){L.warning("è¯·å…ˆä¸Šä¼ é¡µé¢æˆªå›¾");return}R.value=!0,Z.value=!0,q.value="parsing",V.value="",C.value="";try{const M=_e.parseStream($.value,S=>{S.type==="content"&&(V.value+=S.content)},(S,_)=>{R.value=!1,q.value="completed",E.value=S,V.value="",C.value="",_&&(w.value=_),L.success("AI è§£æå®Œæˆ")},S=>{R.value=!1,q.value="failed",V.value="",C.value="",L.error(S||"è§£æå¤±è´¥")},(S,_)=>{R.value=!1,q.value="summarized",C.value=S,V.value="",_&&(w.value=_)});window._currentParseStream=M}catch(M){R.value=!1,q.value="failed",L.error(((a=(s=M.response)==null?void 0:s.data)==null?void 0:a.message)||"è§£æå¤±è´¥")}},Ce=s=>{const{conflict:a}=l.tryApplyAiUpdate(s);a?(o.value=s,Le.confirm({title:"é…ç½®å†²çª",icon:U(Oe),content:"AI å·²æ›´æ–°é…ç½®ï¼Œä½†æ‚¨æœ‰æœªä¿å­˜çš„ä¿®æ”¹ã€‚æ˜¯å¦åº”ç”¨ AI æ›´æ–°ï¼Ÿ",okText:"åº”ç”¨ AI æ›´æ–°",cancelText:"ä¿ç•™æˆ‘çš„ä¿®æ”¹",onOk(){l.forceApplyAiUpdate(o.value),L.success("å·²åº”ç”¨ AI æ›´æ–°")},onCancel(){l.keepUserEdit()}})):L.success("AI è§£æå®Œæˆï¼Œé…ç½®å·²å¡«å……")},r=s=>{E.value=s},n=s=>{Ce(s),L.success("é…ç½®å·²åº”ç”¨åˆ°è¡¨å•")},W=()=>{R.value=!1},K=()=>{var s;(s=h.value)!=null&&s.loadButtonOptions&&h.value.loadButtonOptions()},d=s=>{l.applyUserEdit(s)},t=()=>{Le.confirm({title:"ç¡®è®¤é‡ç½®",content:"ç¡®å®šè¦é‡ç½®æ‰€æœ‰é…ç½®å—ï¼Ÿæ­¤æ“ä½œå°†æ¸…ç©ºå½“å‰æ‰€æœ‰æœªä¿å­˜çš„å†…å®¹ã€‚",onOk(){$.value="",Z.value=!1,w.value="",E.value=null,q.value="",R.value=!1,l.resetConfig(),L.success("é…ç½®å·²é‡ç½®")}})},p=()=>{var M,S,_,Y,de;const s={},a=l.draftConfig;return(M=a.page_id)!=null&&M.trim()?/^[a-zA-Z0-9_\.]+$/.test(a.page_id)||(s.page_id="åªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿å’Œç‚¹"):s.page_id="é¡µé¢ ID ä¸ºå¿…å¡«é¡¹",(_=(S=a.name)==null?void 0:S["zh-CN"])!=null&&_.trim()||(s.name_zh="ä¸­æ–‡åç§°ä¸ºå¿…å¡«é¡¹"),(de=(Y=a.name)==null?void 0:Y.en)!=null&&de.trim()||(s.name_en="è‹±æ–‡åç§°ä¸ºå¿…å¡«é¡¹"),s},j=async({redirect:s=!0}={})=>{var M,S;const a=p();if(Object.keys(a).length>0)return B.value=a,L.error("è¯·æ£€æŸ¥è¡¨å•é”™è¯¯"),!1;F.value=!0;try{const _=l.draftConfig,Y={page_id:_.page_id,name:_.name,description:_.description,button_list:_.button_list.filter(de=>de.trim()),optional_actions:_.optional_actions.filter(de=>de.trim()),screenshot_url:$.value,project_id:I.value};return y.value?await _e.create(Y):await _e.update(P.params.id,Y),L.success("ä¿å­˜æˆåŠŸ"),l.isDirty=!1,y.value&&s&&f.push(`/page/${_.page_id}`),!0}catch(_){return L.error(((S=(M=_.response)==null?void 0:M.data)==null?void 0:S.message)||"ä¿å­˜å¤±è´¥"),!1}finally{F.value=!1}},te=async({redirect:s=!0}={})=>{var M,S,_;const a=(M=l.draftConfig.page_id)==null?void 0:M.trim();if(!a)return L.error("è¯·å…ˆå¡«å†™é¡µé¢ ID"),!1;if(!/^[a-zA-Z0-9_\.]+$/.test(a))return L.error("é¡µé¢ ID åªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿å’Œç‚¹"),!1;b.value=!0;try{const Y=l.draftConfig,de={page_id:a,name:Y.name,description:Y.description,button_list:Y.button_list,optional_actions:Y.optional_actions,screenshot_url:$.value,project_id:I.value};return await _e.saveDraft(de),L.success("è‰ç¨¿å·²ä¿å­˜"),l.isDirty=!1,y.value&&s&&f.replace(`/page/${a}`),!0}catch(Y){return L.error(((_=(S=Y.response)==null?void 0:S.data)==null?void 0:_.message)||"ä¿å­˜è‰ç¨¿å¤±è´¥"),!1}finally{b.value=!1}},re=async()=>{await j()},ue=async()=>{await te()},ce=async()=>{try{await navigator.clipboard.writeText(A.value),L.success("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch{L.error("å¤åˆ¶å¤±è´¥")}},he=()=>{const s=new Blob([A.value],{type:"application/json"}),a=URL.createObjectURL(s),M=document.createElement("a");M.href=a,M.download=`${l.draftConfig.page_id||"config"}_${Date.now()}.json`,M.click(),URL.revokeObjectURL(a)},c=()=>{const s=J;J=null,i.value=!1,s&&s()},X=()=>{l.isDirty=!1,c()},ae=async()=>{await te({redirect:!1})&&c()},ee=async()=>{await j({redirect:!1})&&c()};Re((s,a,M)=>{if(l.isDirty){J=M,i.value=!0;return}M()});const ve=s=>{l.isDirty&&(s.preventDefault(),s.returnValue="")};return xe(()=>{window.addEventListener("beforeunload",ve)}),He(()=>{window.removeEventListener("beforeunload",ve)}),ke(()=>P.path,()=>{}),(s,a)=>{const M=se("a-button"),S=se("a-modal");return u(),v("div",Za,[e("header",Qa,[e("div",Xa,[e("button",{class:"back-btn",onClick:a[0]||(a[0]=_=>s.$router.push("/"))},[...a[6]||(a[6]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),z(" è¿”å›åˆ—è¡¨ ",-1)])]),a[9]||(a[9]=e("div",{class:"header-divider"},null,-1)),e("div",Ya,[e("span",es,[y.value?(u(),v("svg",ts,[...a[7]||(a[7]=[e("path",{d:"M12 4v16m-8-8h16"},null,-1)])])):(u(),v("svg",as,[...a[8]||(a[8]=[e("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"},null,-1),e("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])]))]),z(" "+k(y.value?"æ·»åŠ é¡µé¢é…ç½®":"ç¼–è¾‘é¡µé¢é…ç½®"),1)])]),e("div",ss,[Ne(l).isDirty?(u(),v("span",ns,[...a[10]||(a[10]=[e("span",{class:"dot"},null,-1),z(" æœªä¿å­˜ ",-1)])])):D("",!0),e("button",{class:"action-btn secondary",onClick:t}," é‡ç½® "),e("button",{class:"action-btn secondary",onClick:ue,disabled:F.value||b.value},[b.value?(u(),v("span",ls)):D("",!0),a[11]||(a[11]=z(" ä¿å­˜è‰ç¨¿ ",-1))],8,os),e("button",{class:"action-btn primary",onClick:re,disabled:F.value||b.value},[F.value?(u(),v("span",rs)):D("",!0),a[12]||(a[12]=z(" ä¿å­˜é…ç½® ",-1))],8,is)])]),e("div",ds,[e("div",us,[e("aside",cs,[e("div",vs,[a[14]||(a[14]=pe('<div class="card-header" data-v-86fe62b3><h3 data-v-86fe62b3><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-86fe62b3><rect x="3" y="3" width="18" height="18" rx="2" data-v-86fe62b3></rect><circle cx="8.5" cy="8.5" r="1.5" data-v-86fe62b3></circle><path d="M21 15l-5-5L5 21" data-v-86fe62b3></path></svg> é¡µé¢æˆªå›¾ </h3></div>',1)),e("div",ps,[U(lt,{modelValue:$.value,"onUpdate:modelValue":a[1]||(a[1]=_=>$.value=_),disabled:R.value,onUploadSuccess:we,onUploadError:x},null,8,["modelValue","disabled"]),e("button",{class:"ai-parse-btn",onClick:fe,disabled:!$.value||R.value},[R.value?(u(),v("span",ms)):(u(),v("svg",fs,[...a[13]||(a[13]=[e("path",{d:"M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z"},null,-1)])])),z(" "+k(R.value?"æ­£åœ¨åˆ†æ...":"AI è¾…åŠ©å¡«å†™"),1)],8,gs)])]),e("div",hs,[e("div",{class:"card-header"},[a[18]||(a[18]=e("h3",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M16 18l6-6-6-6M8 6l-6 6 6 6"})]),z(" JSON é¢„è§ˆ ")],-1)),e("div",{class:"card-actions"},[e("button",{class:"icon-btn",onClick:G,title:"å±•å¼€ç¼–è¾‘"},[...a[15]||(a[15]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M8 3H3v5M16 3h5v5M8 21H3v-5M16 21h5v-5"})],-1)])]),e("button",{class:"icon-btn",onClick:ce,title:"å¤åˆ¶"},[...a[16]||(a[16]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2"}),e("path",{d:"M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"})],-1)])]),e("button",{class:"icon-btn",onClick:he,title:"ä¸‹è½½"},[...a[17]||(a[17]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"})],-1)])])])]),e("div",bs,[e("div",_s,[e("pre",null,[e("code",null,k(A.value),1)])])])])]),e("main",ys,[e("div",ws,[a[19]||(a[19]=e("div",{class:"card-header"},[e("h3",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),z(" é…ç½®è¯¦æƒ… ")])],-1)),e("div",Cs,[U(Kt,{ref_key:"configEditorRef",ref:h,config:Ne(l).draftConfig,"session-id":w.value,errors:B.value,onConfigChanged:d},null,8,["config","session-id","errors"])])])]),e("aside",ks,[e("div",zs,[a[20]||(a[20]=e("div",{class:"card-header"},[e("h3",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})]),z(" UI config å¡«å†™åŠ©æ‰‹ ")])],-1)),e("div",xs,[U(Ka,{"session-id":w.value,"parse-result":E.value,status:q.value,"current-config":Ne(l).draftConfig,"image-url":$.value,"streaming-content":V.value,"summary-content":C.value,onConfigUpdated:r,onConfigConfirmed:n,onCompleted:W,onButtonAdded:K},null,8,["session-id","parse-result","status","current-config","image-url","streaming-content","summary-content"])])])])])]),U(S,{open:N.value,"onUpdate:open":a[4]||(a[4]=_=>N.value=_),title:"JSON é…ç½®",width:760,maskClosable:!1,wrapClassName:"json-editor-modal"},{footer:H(()=>[U(M,{onClick:a[3]||(a[3]=_=>N.value=!1)},{default:H(()=>[...a[21]||(a[21]=[z("å–æ¶ˆ",-1)])]),_:1}),U(M,{type:"primary",onClick:ye},{default:H(()=>[...a[22]||(a[22]=[z("åº”ç”¨",-1)])]),_:1})]),default:H(()=>[ne(e("textarea",{"onUpdate:modelValue":a[2]||(a[2]=_=>O.value=_),class:"json-editor-textarea",rows:"18",spellcheck:"false"},null,512),[[oe,O.value]]),T.value?(u(),v("p",$s,k(T.value),1)):D("",!0)]),_:1},8,["open"]),U(S,{open:i.value,"onUpdate:open":a[5]||(a[5]=_=>i.value=_),title:"æœªä¿å­˜çš„æ›´æ”¹",maskClosable:!1,closable:!1},{footer:H(()=>[U(M,{disabled:F.value||b.value,onClick:X},{default:H(()=>[...a[23]||(a[23]=[z("ç›´æ¥é€€å‡º",-1)])]),_:1},8,["disabled"]),U(M,{loading:b.value,onClick:ae},{default:H(()=>[...a[24]||(a[24]=[z("ä¿æŒè‰ç¨¿",-1)])]),_:1},8,["loading"]),U(M,{type:"primary",loading:F.value,onClick:ee},{default:H(()=>[...a[25]||(a[25]=[z("ä¿å­˜é…ç½®",-1)])]),_:1},8,["loading"])]),default:H(()=>[a[26]||(a[26]=e("p",null,"å½“å‰å†…å®¹æœªä¿å­˜ï¼Œæ‚¨è¦ç›´æ¥é€€å‡ºã€ä¿æŒè‰ç¨¿è¿˜æ˜¯ä¿å­˜é…ç½®ï¼Ÿ",-1))]),_:1},8,["open"])])}}},Ls=Ae(As,[["__scopeId","data-v-86fe62b3"]]);export{Ls as default};
