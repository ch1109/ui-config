import{r as m,x as It,c as dt,o as Dt,a as i,b as l,d as e,e as V,f as lt,k as h,t as v,w as U,T as ut,F as x,h as R,g as nt,j as n,l as k,m as C,i as _,v as w,G as ct,p as vt,M as At,E as Lt}from"./index-MMx8Hhss.js";import{_ as zt,m as E,b as $,d as Ft}from"./_plugin-vue_export-helper-BQ15yOP5.js";const Ht={class:"mcp-manager"},Rt={class:"page-header"},Jt={class:"header-content"},Kt={class:"header-actions"},qt={key:0,class:"context-panel"},Yt={class:"context-header"},Gt={class:"context-stats"},Nt={class:"stat"},Wt={class:"stat"},Qt={class:"context-body"},Xt={class:"context-section"},Zt={class:"prompt-preview"},te={class:"page-content"},ee={class:"section"},se={class:"server-grid"},oe={class:"card-header"},le={class:"server-info"},ne={class:"server-details"},ae={class:"server-transport"},re={class:"toggle-switch"},ie=["checked","onChange"],de={class:"card-body"},ue={class:"server-desc"},ce={class:"server-tools"},ve={class:"tools-list"},pe={key:0,class:"tool-tag more"},he={class:"card-footer"},me={class:"footer-left"},ye={class:"footer-actions"},fe=["onClick","disabled"],ge={key:0,class:"spinner"},ke={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},_e=["onClick"],xe=["onClick","disabled"],we={key:0,class:"spinner small"},be={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ce=["onClick"],Se={class:"section"},Me={class:"section-header"},Be={key:0,class:"empty-state"},Te={key:1,class:"server-grid"},Ve={class:"card-header"},$e={class:"server-info"},Pe={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},je={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Oe={class:"server-details"},Ue={key:0,class:"server-transport"},Ee={key:1,class:"server-url"},Ie={class:"card-actions"},De=["onClick"],Ae=["onClick"],Le={class:"card-body"},ze={key:0,class:"server-desc"},Fe={key:1,class:"server-command"},He={key:2,class:"server-tools"},Re={class:"tools-list"},Je={key:0,class:"tool-tag more"},Ke={class:"card-footer"},qe={class:"footer-left"},Ye={key:0,class:"last-check"},Ge={class:"footer-actions"},Ne=["onClick","disabled"],We={key:0,class:"spinner"},Qe={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Xe=["onClick"],Ze=["onClick","disabled"],ts={key:0,class:"spinner small"},es={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ss=["onClick"],os={key:0,class:"test-drawer"},ls={class:"drawer-header"},ns={class:"drawer-content"},as={class:"tools-section"},rs={key:0,class:"loading-state"},is={key:1,class:"empty-state small"},ds={key:2,class:"tools-list-panel"},us=["onClick"],cs={class:"tool-name"},vs={class:"tool-desc"},ps={key:0,class:"call-section"},hs={class:"form-fields"},ms={key:0,class:"required"},ys=["onUpdate:modelValue","placeholder"],fs=["onUpdate:modelValue","placeholder"],gs=["onUpdate:modelValue","placeholder"],ks=["disabled"],_s={key:0,class:"spinner small"},xs={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ws={key:1,class:"result-section"},bs={key:0,class:"duration"},Cs={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ss={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ms={class:"result-json"},Bs={class:"form-section"},Ts={class:"form-group"},Vs={class:"transport-selector"},$s={class:"form-group"},Ps={class:"form-group"},js={class:"form-group"},Os={class:"form-group"},Us={class:"form-group"},Es={class:"form-group"},Is={class:"form-group"},Ds={class:"form-group"},As={class:"json-editor-section"},Ls={key:0,class:"error-text"},zs={class:"upload-section"},Fs={class:"modal-footer"},Hs=["disabled"],Rs={key:0,class:"btn-spinner"},Js={__name:"MCPManager",setup(Ks){const I=m([]),D=m(!1),J=m("form"),A=m(null),W=m(!1),L=m(""),Q=m(!1),z=m(null),st=m({}),M=m(null),B=m(null),y=m(null),K=m(!1),F=m([]),b=m(null),f=It({}),q=m(!1),g=m(null),u=m({name:"",transport:"http",server_url:"",health_check_path:"/health",command:"npx",args:[],env:{},description:"",tools:[]}),P=m(""),j=m(""),O=m(""),Y=m(""),pt=dt(()=>I.value.filter(s=>s.is_preset)),at=dt(()=>I.value.filter(s=>!s.is_preset));Dt(async()=>{await Promise.all([ht(),G(),T()])});const ht=async()=>{try{I.value=await E.list()}catch(s){console.error("Failed to load MCP servers:",s),i.error("加载服务器列表失败")}},G=async()=>{try{const s=await $.getStdioStatus();st.value=s.servers||{}}catch(s){console.error("Failed to load stdio status:",s)}},T=async()=>{try{z.value=await Ft.getContext()}catch(s){console.error("Failed to load MCP context:",s)}},X=s=>s.is_preset?s.name.toLowerCase().replace(/\s+/g,""):`custom_${s.id}`,S=s=>`custom_${s.id}`,Z=s=>{var r;if(s.transport!=="stdio")return!1;const t=s.name==="Context7"?"context7":s.name==="Everything Server"?"everything":s.name==="和风天气"?"hefeng":null;return t&&((r=st.value[t])==null?void 0:r.running)||!1},tt=s=>{var r;if(s.transport!=="stdio")return!1;const t=S(s);return((r=st.value[t])==null?void 0:r.running)||!1},mt=s=>Z(s)?"running":s.status==="enabled"?"success":s.status==="error"?"error":"warning",yt=s=>Z(s)?"运行中":{enabled:"已启用",disabled:"已禁用",error:"连接失败"}[s.status]||s.status,ft=s=>tt(s)?"running":s.status==="enabled"?"success":s.status==="error"?"error":"warning",gt=s=>tt(s)?"运行中":s.transport==="stdio"?{enabled:"已配置",disabled:"未启动",error:"启动失败"}[s.status]||s.status:{enabled:"已启用",disabled:"已禁用",error:"连接失败"}[s.status]||s.status,kt=s=>new Date(s).toLocaleString("zh-CN"),_t=async s=>{try{const t=s.preset_key;if(!t){i.error("无法识别服务器标识");return}const r=s.status!=="enabled";await E.toggle(t,r),s.status=r?"enabled":"disabled",i.success(r?"已启用":"已禁用"),await T()}catch(t){console.error("Failed to toggle server:",t),i.error("切换状态失败")}},xt=async s=>{var r,p;const t=s.name==="Context7"?"context7":s.name==="Everything Server"?"everything":"hefeng";M.value=t;try{const a=await $.startStdioServer(t);a.success?(i.success(`${s.name} 启动成功！`),await Promise.all([G(),T()])):i.error("启动失败: "+(a.message||"未知错误"))}catch(a){const o=((p=(r=a.response)==null?void 0:r.data)==null?void 0:p.detail)||a.message;i.error("启动失败: "+o)}finally{M.value=null}},wt=async s=>{var r;const t=s.name==="Context7"?"context7":s.name==="Everything Server"?"everything":"hefeng";B.value=t;try{(await $.stopStdioServer(t)).success&&(i.success("服务器已停止"),((r=y.value)==null?void 0:r.name)===s.name&&(y.value=null),await Promise.all([G(),T()]))}catch(p){i.error("停止失败: "+p.message)}finally{B.value=null}},bt=async s=>{var r,p;const t=S(s);M.value=t;try{const a=await $.startStdioServer(t);a.success?(i.success(`${s.name} 启动成功！`),await Promise.all([G(),T()])):i.error("启动失败: "+(a.message||"未知错误"))}catch(a){const o=((p=(r=a.response)==null?void 0:r.data)==null?void 0:p.detail)||a.message;i.error("启动失败: "+o)}finally{M.value=null}},Ct=async s=>{var r;const t=S(s);B.value=t;try{(await $.stopStdioServer(t)).success&&(i.success("服务器已停止"),((r=y.value)==null?void 0:r.id)===s.id&&(y.value=null),await Promise.all([G(),T()]))}catch(p){i.error("停止失败: "+p.message)}finally{B.value=null}},St=async s=>{y.value=s,b.value=null,g.value=null,Object.keys(f).forEach(t=>delete f[t]),K.value=!0;try{const t=S(s),r=await $.getStdioTools(t);F.value=r.tools||[]}catch(t){i.error("加载工具列表失败: "+t.message),F.value=[]}finally{K.value=!1}},rt=async s=>{const t=i.loading("正在测试连接...",0);try{const r=await E.test(s.id||0);t(),r.connectivity?i.success("连接成功"):i.error("连接失败")}catch(r){t(),i.error("测试失败: "+r.message)}},Mt=async s=>{y.value=s,b.value=null,g.value=null,Object.keys(f).forEach(t=>delete f[t]),K.value=!0;try{const t=s.name==="Context7"?"context7":s.name==="Everything Server"?"everything":"hefeng",r=await $.getStdioTools(t);F.value=r.tools||[]}catch(t){i.error("加载工具列表失败: "+t.message),F.value=[]}finally{K.value=!1}},Bt=s=>{var r;b.value=s,g.value=null,Object.keys(f).forEach(p=>delete f[p]);const t=((r=s.inputSchema)==null?void 0:r.properties)||{};Object.entries(t).forEach(([p,a])=>{a.default!==void 0&&(f[p]=a.default)})},Tt=async()=>{if(!(!b.value||!y.value)){q.value=!0,g.value=null;try{let s;y.value.is_preset?s=y.value.name==="Context7"?"context7":y.value.name==="Everything Server"?"everything":"hefeng":s=S(y.value);const t=await $.callStdioTool(s,b.value.name,{...f});g.value=t,t.success?i.success("工具执行成功"):i.error("工具执行失败: "+(t.error||"未知错误"))}catch(s){g.value={success:!1,error:s.message},i.error("调用失败: "+s.message)}finally{q.value=!1}}},Vt=s=>{try{return JSON.stringify(s,null,2)}catch{return String(s)}},$t=async()=>{var s;if(!((s=z.value)!=null&&s.system_prompt_snippet)){i.warning("暂无内容可复制");return}try{await navigator.clipboard.writeText(z.value.system_prompt_snippet),i.success("已复制到剪贴板")}catch{i.error("复制失败")}},Pt=s=>{var r;A.value=s;const t=s.transport||"http";u.value={name:s.name,transport:t,server_url:s.server_url||"",health_check_path:s.health_check_path||"/health",command:s.command||"npx",args:s.args||[],env:s.env||{},description:s.description||"",tools:s.tools||[]},O.value=((r=s.tools)==null?void 0:r.join(", "))||"",P.value=(s.args||[]).join(" "),j.value=Object.entries(s.env||{}).map(([p,a])=>`${p}=${a}`).join(`
`),D.value=!0},jt=s=>{At.confirm({title:"删除服务器",icon:V(Lt),content:`确定要删除「${s.name}」吗？`,okText:"删除",okType:"danger",cancelText:"取消",async onOk(){try{await E.delete(s.id),I.value=I.value.filter(t=>t.id!==s.id),i.success("删除成功"),await T()}catch(t){i.error("删除失败: "+t.message)}}})},Ot=async s=>{const t=s.target.files[0];t&&await it(t)},Ut=async s=>{const t=s.dataTransfer.files[0];t&&await it(t)},it=async s=>{var r;if(!s.name.endsWith(".json")){i.error("仅支持 .json 文件");return}if(s.size>1024*1024){i.error("文件大小不能超过 1MB");return}const t=await s.text();try{const p=JSON.parse(t);u.value={name:p.name||"",server_url:p.server_url||"",health_check_path:p.health_check_path||"/health",description:p.description||"",tools:p.tools||[]},O.value=((r=p.tools)==null?void 0:r.join(", "))||"",Y.value=t,J.value="form",L.value="",i.success("文件解析成功")}catch{i.error("无效的 JSON 格式")}},ot=()=>{D.value=!1,A.value=null,u.value={name:"",transport:"http",server_url:"",health_check_path:"/health",command:"npx",args:[],env:{},description:"",tools:[]},P.value="",j.value="",O.value="",Y.value="",L.value="",J.value="form"},Et=async()=>{var s,t,r,p;if(J.value==="json")try{const a=JSON.parse(Y.value);u.value={name:a.name||"",transport:a.transport||"http",server_url:a.server_url||"",health_check_path:a.health_check_path||"/health",command:a.command||"npx",args:a.args||[],env:a.env||{},description:a.description||"",tools:a.tools||[]},P.value=(a.args||[]).join(" "),j.value=Object.entries(a.env||{}).map(([o,d])=>`${o}=${d}`).join(`
`)}catch{L.value="无效的 JSON 格式";return}if(O.value&&(u.value.tools=O.value.split(",").map(a=>a.trim()).filter(Boolean)),u.value.transport==="stdio"){P.value.trim()?u.value.args=P.value.trim().split(/\s+/):u.value.args=[];const a={};j.value.trim()&&j.value.split(`
`).forEach(o=>{const d=o.trim();if(d&&d.includes("=")){const c=d.indexOf("="),H=d.substring(0,c).trim(),et=d.substring(c+1).trim();H&&(a[H]=et)}}),u.value.env=a}if(!u.value.name){i.warning("请填写服务器名称");return}if(u.value.transport==="http"&&!u.value.server_url){i.warning("HTTP 类型需要填写服务器 URL");return}if(u.value.transport==="stdio"&&!u.value.command){i.warning("STDIO 类型需要填写启动命令");return}W.value=!0;try{const a={...u.value};a.transport==="http"?(delete a.command,delete a.args,delete a.env):(delete a.server_url,delete a.health_check_path),A.value?await E.update(A.value.id,a):(await E.addConfig(a)).transport==="stdio"&&i.success("STDIO 服务器已添加，可在列表中启动"),I.value=await E.list(),ot(),i.success("保存成功"),await T()}catch(a){i.error("保存失败: "+(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.detail)||((p=(r=a.response)==null?void 0:r.data)==null?void 0:p.message)||a.message))}finally{W.value=!1}};return(s,t)=>{const r=nt("a-tab-pane"),p=nt("a-tabs"),a=nt("a-modal");return n(),l("div",Ht,[e("header",Rt,[e("div",Jt,[t[19]||(t[19]=lt('<div class="title-group" data-v-741084c2><h1 data-v-741084c2><span class="icon-wrapper" data-v-741084c2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-741084c2><path d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01" data-v-741084c2></path></svg></span> MCP 服务器管理 </h1><p class="subtitle" data-v-741084c2>管理 Model Context Protocol 服务器，扩展 AI 模型能力</p></div>',1)),e("div",Kt,[e("button",{class:"context-btn",onClick:t[0]||(t[0]=o=>Q.value=!Q.value)},[t[18]||(t[18]=lt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-741084c2><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-741084c2></path><polyline points="14 2 14 8 20 8" data-v-741084c2></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-741084c2></line><line x1="16" y1="17" x2="8" y2="17" data-v-741084c2></line></svg>',1)),h(" "+v(Q.value?"隐藏":"查看")+" MCP 上下文 ",1)])])])]),V(ut,{name:"slide"},{default:U(()=>{var o,d,c;return[Q.value?(n(),l("div",qt,[e("div",Yt,[t[22]||(t[22]=e("h3",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 16v-4M12 8h.01"})]),h(" MCP 上下文信息 ")],-1)),e("div",Gt,[e("span",Nt,[e("strong",null,v(((o=z.value)==null?void 0:o.total_enabled_servers)||0),1),t[20]||(t[20]=h(" 个已启用服务器 ",-1))]),e("span",Wt,[e("strong",null,v(((d=z.value)==null?void 0:d.total_available_tools)||0),1),t[21]||(t[21]=h(" 个可用工具 ",-1))])])]),e("div",Qt,[e("div",Xt,[t[24]||(t[24]=e("h4",null,"系统提示词片段",-1)),t[25]||(t[25]=e("p",{class:"hint"},"此内容会自动注入到 AI 的系统提示词中，让 AI 知道有哪些 MCP 工具可用",-1)),e("div",Zt,[e("pre",null,v(((c=z.value)==null?void 0:c.system_prompt_snippet)||"暂无已启用的 MCP 服务器"),1)]),e("button",{class:"copy-btn",onClick:$t},[...t[23]||(t[23]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})],-1),h(" 复制 ",-1)])])])])])):k("",!0)]}),_:1}),e("div",te,[e("section",ee,[t[35]||(t[35]=e("div",{class:"section-header"},[e("h2",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M12 1v6m0 6v10M4.22 4.22l4.24 4.24m7.08 7.08l4.24 4.24M1 12h6m6 0h10M4.22 19.78l4.24-4.24m7.08-7.08l4.24-4.24"})]),h(" 预置服务器 ")])],-1)),e("div",se,[(n(!0),l(x,null,R(pt.value,o=>(n(),l("article",{key:o.name,class:C(["server-card",{running:Z(o)}])},[e("div",oe,[e("div",le,[t[26]||(t[26]=e("div",{class:"server-icon preset"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2"}),e("path",{d:"M8 21h8M12 17v4"})])],-1)),e("div",ne,[e("h3",null,v(o.name),1),e("span",ae,v(o.transport==="stdio"?"STDIO":"HTTP"),1)])]),e("label",re,[e("input",{type:"checkbox",checked:o.status==="enabled"||o.status==="running",onChange:d=>_t(o)},null,40,ie),t[27]||(t[27]=e("span",{class:"toggle-slider"},null,-1))])]),e("div",de,[e("p",ue,v(o.description),1),e("div",ce,[t[28]||(t[28]=e("span",{class:"tools-label"},"工具:",-1)),e("div",ve,[(n(!0),l(x,null,R(o.tools.slice(0,4),d=>(n(),l("span",{key:d,class:"tool-tag"},v(d),1))),128)),o.tools.length>4?(n(),l("span",pe," +"+v(o.tools.length-4),1)):k("",!0)])])]),e("div",he,[e("div",me,[e("span",{class:C(["status-badge",mt(o)])},[t[29]||(t[29]=e("span",{class:"status-dot"},null,-1)),h(" "+v(yt(o)),1)],2)]),e("div",ye,[o.transport==="stdio"?(n(),l(x,{key:0},[Z(o)?(n(),l(x,{key:1},[e("button",{class:"action-btn test",onClick:d=>Mt(o)},[...t[32]||(t[32]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})],-1),h(" 测试 ",-1)])],8,_e),e("button",{class:"action-btn stop",onClick:d=>wt(o),disabled:B.value===X(o)},[B.value===X(o)?(n(),l("span",we)):(n(),l("svg",be,[...t[33]||(t[33]=[e("rect",{x:"6",y:"6",width:"12",height:"12"},null,-1)])]))],8,xe)],64)):(n(),l("button",{key:0,class:"action-btn start",onClick:d=>xt(o),disabled:M.value===X(o)},[M.value===X(o)?(n(),l("span",ge)):(n(),l("svg",ke,[...t[30]||(t[30]=[e("polygon",{points:"5 3 19 12 5 21 5 3"},null,-1)])])),t[31]||(t[31]=h(" 启动 ",-1))],8,fe))],64)):(n(),l("button",{key:1,class:"action-btn test",onClick:d=>rt(o)},[...t[34]||(t[34]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),h(" 测试 ",-1)])],8,Ce))])])],2))),128))])]),e("section",Se,[e("div",Me,[t[37]||(t[37]=e("h2",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})]),h(" 自定义服务器 ")],-1)),e("button",{class:"add-server-btn",onClick:t[1]||(t[1]=o=>D.value=!0)},[...t[36]||(t[36]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[e("path",{d:"M12 4v16m-8-8h16"})],-1),h(" 添加服务器 ",-1)])])]),at.value.length===0?(n(),l("div",Be,[t[39]||(t[39]=lt('<div class="empty-illustration" data-v-741084c2><svg viewBox="0 0 200 200" fill="none" data-v-741084c2><circle cx="100" cy="100" r="80" fill="#f1f5f9" data-v-741084c2></circle><rect x="65" y="60" width="70" height="50" rx="4" fill="#e2e8f0" data-v-741084c2></rect><circle cx="80" cy="75" r="4" fill="#cbd5e1" data-v-741084c2></circle><circle cx="95" cy="75" r="4" fill="#cbd5e1" data-v-741084c2></circle><rect x="65" y="120" width="70" height="30" rx="4" fill="#e2e8f0" data-v-741084c2></rect><circle cx="80" cy="135" r="4" fill="#cbd5e1" data-v-741084c2></circle><circle cx="95" cy="135" r="4" fill="#cbd5e1" data-v-741084c2></circle><circle cx="100" cy="100" r="15" fill="#6366f1" opacity="0.2" data-v-741084c2></circle><path d="M95 100h10M100 95v10" stroke="#6366f1" stroke-width="2" stroke-linecap="round" data-v-741084c2></path></svg></div><h3 data-v-741084c2>暂无自定义服务器</h3><p data-v-741084c2>添加您自己的 MCP 服务器来扩展 AI 能力</p>',3)),e("button",{class:"add-btn-primary",onClick:t[2]||(t[2]=o=>D.value=!0)},[...t[38]||(t[38]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[e("path",{d:"M12 4v16m-8-8h16"})],-1),h(" 添加服务器 ",-1)])])])):(n(),l("div",Te,[(n(!0),l(x,null,R(at.value,o=>{var d;return n(),l("article",{key:o.id,class:C(["server-card custom",{running:tt(o)}])},[e("div",Ve,[e("div",$e,[e("div",{class:C(["server-icon",o.transport==="stdio"?"stdio":"custom"])},[o.transport==="stdio"?(n(),l("svg",Pe,[...t[40]||(t[40]=[e("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2"},null,-1),e("path",{d:"M8 21h8M12 17v4"},null,-1),e("path",{d:"M7 8l3 3-3 3M12 14h5"},null,-1)])])):(n(),l("svg",je,[...t[41]||(t[41]=[e("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"},null,-1)])]))],2),e("div",Oe,[e("h3",null,v(o.name),1),o.transport==="stdio"?(n(),l("span",Ue,"STDIO")):(n(),l("span",Ee,v(o.server_url),1))])]),e("div",Ie,[e("button",{class:"icon-btn",onClick:c=>Pt(o),title:"编辑"},[...t[42]||(t[42]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,De),e("button",{class:"icon-btn danger",onClick:c=>jt(o),title:"删除"},[...t[43]||(t[43]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})],-1)])],8,Ae)])]),e("div",Le,[o.description?(n(),l("p",ze,v(o.description),1)):k("",!0),o.transport==="stdio"?(n(),l("div",Fe,[t[44]||(t[44]=e("span",{class:"command-label"},"命令:",-1)),e("code",null,v(o.command)+" "+v((o.args||[]).join(" ")),1)])):k("",!0),(d=o.tools)!=null&&d.length?(n(),l("div",He,[t[45]||(t[45]=e("span",{class:"tools-label"},"工具:",-1)),e("div",Re,[(n(!0),l(x,null,R(o.tools.slice(0,4),c=>(n(),l("span",{key:c,class:"tool-tag"},v(c),1))),128)),o.tools.length>4?(n(),l("span",Je," +"+v(o.tools.length-4),1)):k("",!0)])])):k("",!0)]),e("div",Ke,[e("div",qe,[e("span",{class:C(["status-badge",ft(o)])},[t[46]||(t[46]=e("span",{class:"status-dot"},null,-1)),h(" "+v(gt(o)),1)],2),o.last_check?(n(),l("span",Ye,[t[47]||(t[47]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 6v6l4 2"})],-1)),h(" "+v(kt(o.last_check)),1)])):k("",!0)]),e("div",Ge,[o.transport==="stdio"?(n(),l(x,{key:0},[tt(o)?(n(),l(x,{key:1},[e("button",{class:"action-btn test",onClick:c=>St(o)},[...t[50]||(t[50]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})],-1),h(" 测试 ",-1)])],8,Xe),e("button",{class:"action-btn stop",onClick:c=>Ct(o),disabled:B.value===S(o)},[B.value===S(o)?(n(),l("span",ts)):(n(),l("svg",es,[...t[51]||(t[51]=[e("rect",{x:"6",y:"6",width:"12",height:"12"},null,-1)])]))],8,Ze)],64)):(n(),l("button",{key:0,class:"action-btn start",onClick:c=>bt(o),disabled:M.value===S(o)},[M.value===S(o)?(n(),l("span",We)):(n(),l("svg",Qe,[...t[48]||(t[48]=[e("polygon",{points:"5 3 19 12 5 21 5 3"},null,-1)])])),t[49]||(t[49]=h(" 启动 ",-1))],8,Ne))],64)):(n(),l("button",{key:1,class:"action-btn test",onClick:c=>rt(o)},[...t[52]||(t[52]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),h(" 测试 ",-1)])],8,ss))])])],2)}),128))]))])]),V(ut,{name:"drawer"},{default:U(()=>{var o;return[y.value?(n(),l("div",os,[e("div",ls,[e("h3",null,[t[53]||(t[53]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})],-1)),h(" "+v(y.value.name)+" 工具测试 ",1)]),e("button",{class:"close-btn",onClick:t[3]||(t[3]=d=>y.value=null)},[...t[54]||(t[54]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),e("div",ns,[e("div",as,[t[57]||(t[57]=e("h4",null,"可用工具",-1)),K.value?(n(),l("div",rs,[...t[55]||(t[55]=[e("div",{class:"loader"},null,-1),e("span",null,"加载工具列表...",-1)])])):F.value.length===0?(n(),l("div",is,[...t[56]||(t[56]=[e("p",null,"暂无可用工具",-1)])])):(n(),l("div",ds,[(n(!0),l(x,null,R(F.value,d=>{var c;return n(),l("div",{key:d.name,class:C(["tool-item",{selected:((c=b.value)==null?void 0:c.name)===d.name}]),onClick:H=>Bt(d)},[e("div",cs,v(d.name),1),e("div",vs,v(d.description||"无描述"),1)],10,us)}),128))]))]),b.value?(n(),l("div",ps,[e("h4",null,"调用 "+v(b.value.name),1),e("div",hs,[(n(!0),l(x,null,R(((o=b.value.inputSchema)==null?void 0:o.properties)||{},(d,c)=>{var H,et;return n(),l("div",{key:c,class:"form-field"},[e("label",null,[h(v(c)+" ",1),(et=(H=b.value.inputSchema)==null?void 0:H.required)!=null&&et.includes(c)?(n(),l("span",ms,"*")):k("",!0)]),d.type==="string"?_((n(),l("input",{key:0,"onUpdate:modelValue":N=>f[c]=N,type:"text",placeholder:d.description||`输入 ${c}`},null,8,ys)),[[w,f[c]]]):d.type==="integer"||d.type==="number"?_((n(),l("input",{key:1,"onUpdate:modelValue":N=>f[c]=N,type:"number",placeholder:d.description||`输入 ${c}`},null,8,fs)),[[w,f[c],void 0,{number:!0}]]):_((n(),l("textarea",{key:2,"onUpdate:modelValue":N=>f[c]=N,placeholder:d.description||`输入 ${c}`,rows:"2"},null,8,gs)),[[w,f[c]]])])}),128))]),e("button",{class:"call-btn",onClick:Tt,disabled:q.value},[q.value?(n(),l("span",_s)):(n(),l("svg",xs,[...t[58]||(t[58]=[e("polygon",{points:"5 3 19 12 5 21 5 3"},null,-1)])])),h(" "+v(q.value?"执行中...":"执行工具"),1)],8,ks)])):k("",!0),g.value?(n(),l("div",ws,[e("h4",null,[t[59]||(t[59]=h(" 执行结果 ",-1)),g.value.duration_ms?(n(),l("span",bs,v(g.value.duration_ms)+"ms",1)):k("",!0)]),e("div",{class:C(["result-status",g.value.success?"success":"error"])},[g.value.success?(n(),l("svg",Cs,[...t[60]||(t[60]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(n(),l("svg",Ss,[...t[61]||(t[61]=[e("circle",{cx:"12",cy:"12",r:"10"},null,-1),e("line",{x1:"15",y1:"9",x2:"9",y2:"15"},null,-1),e("line",{x1:"9",y1:"9",x2:"15",y2:"15"},null,-1)])])),h(" "+v(g.value.success?"执行成功":"执行失败"),1)],2),e("pre",Ms,v(Vt(g.value.data||g.value.error)),1)])):k("",!0)])])):k("",!0)]}),_:1}),V(a,{open:D.value,"onUpdate:open":t[17]||(t[17]=o=>D.value=o),title:A.value?"编辑服务器":"添加 MCP 服务器",width:"640px",footer:null,onCancel:ot,class:"server-modal"},{default:U(()=>[V(p,{activeKey:J.value,"onUpdate:activeKey":t[16]||(t[16]=o=>J.value=o),class:"modal-tabs"},{default:U(()=>[V(r,{key:"form",tab:"表单配置"},{default:U(()=>[e("div",Bs,[e("div",Ts,[t[64]||(t[64]=e("label",null,[h("传输类型 "),e("span",{class:"required"},"*")],-1)),e("div",Vs,[e("label",{class:C(["transport-option",{active:u.value.transport==="http"}])},[_(e("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=o=>u.value.transport=o),value:"http"},null,512),[[ct,u.value.transport]]),t[62]||(t[62]=e("div",{class:"option-content"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),e("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]),e("span",null,"HTTP/SSE"),e("small",null,"远程服务器")],-1))],2),e("label",{class:C(["transport-option",{active:u.value.transport==="stdio"}])},[_(e("input",{type:"radio","onUpdate:modelValue":t[5]||(t[5]=o=>u.value.transport=o),value:"stdio"},null,512),[[ct,u.value.transport]]),t[63]||(t[63]=e("div",{class:"option-content"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2"}),e("path",{d:"M8 21h8M12 17v4"}),e("path",{d:"M7 8l3 3-3 3M12 14h5"})]),e("span",null,"STDIO"),e("small",null,"本地进程")],-1))],2)])]),e("div",$s,[t[65]||(t[65]=e("label",null,[h("服务器名称 "),e("span",{class:"required"},"*")],-1)),_(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>u.value.name=o),type:"text",class:"form-input",placeholder:"My MCP Server"},null,512),[[w,u.value.name]])]),u.value.transport==="http"?(n(),l(x,{key:0},[e("div",Ps,[t[66]||(t[66]=e("label",null,[h("服务器 URL "),e("span",{class:"required"},"*")],-1)),_(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>u.value.server_url=o),type:"text",class:"form-input",placeholder:"https://mcp.example.com"},null,512),[[w,u.value.server_url]])]),e("div",js,[t[67]||(t[67]=e("label",null,"健康检查路径",-1)),_(e("input",{"onUpdate:modelValue":t[8]||(t[8]=o=>u.value.health_check_path=o),type:"text",class:"form-input",placeholder:"/health"},null,512),[[w,u.value.health_check_path]])])],64)):(n(),l(x,{key:1},[e("div",Os,[t[68]||(t[68]=e("label",null,[h("启动命令 "),e("span",{class:"required"},"*")],-1)),_(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>u.value.command=o),type:"text",class:"form-input",placeholder:"npx"},null,512),[[w,u.value.command]]),t[69]||(t[69]=e("p",{class:"form-hint"},"常用命令：npx, node, python, uvx",-1))]),e("div",Us,[t[70]||(t[70]=e("label",null,"命令参数",-1)),_(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>P.value=o),type:"text",class:"form-input",placeholder:"-y wttr-mcp-server@latest"},null,512),[[w,P.value]]),t[71]||(t[71]=e("p",{class:"form-hint"},"空格分隔，例如：-y wttr-mcp-server@latest",-1))]),e("div",Es,[t[72]||(t[72]=e("label",null,"环境变量",-1)),_(e("textarea",{"onUpdate:modelValue":t[11]||(t[11]=o=>j.value=o),class:"form-textarea",rows:"3",placeholder:`API_KEY=your_key
OTHER_VAR=value`},null,512),[[w,j.value]]),t[73]||(t[73]=e("p",{class:"form-hint"},"每行一个，格式：KEY=VALUE",-1))])],64)),e("div",Is,[t[74]||(t[74]=e("label",null,"工具列表 (逗号分隔)",-1)),_(e("input",{"onUpdate:modelValue":t[12]||(t[12]=o=>O.value=o),type:"text",class:"form-input",placeholder:"search, retrieve, store"},null,512),[[w,O.value]]),t[75]||(t[75]=e("p",{class:"form-hint"},"可选，服务器启动后会自动获取",-1))]),e("div",Ds,[t[76]||(t[76]=e("label",null,"描述",-1)),_(e("textarea",{"onUpdate:modelValue":t[13]||(t[13]=o=>u.value.description=o),class:"form-textarea",rows:"3",placeholder:"服务器描述..."},null,512),[[w,u.value.description]])])])]),_:1}),V(r,{key:"json",tab:"JSON 编辑"},{default:U(()=>[e("div",As,[_(e("textarea",{"onUpdate:modelValue":t[14]||(t[14]=o=>Y.value=o),class:C(["json-editor",{error:L.value}]),rows:"15",placeholder:'{"name": "...", "server_url": "...", "tools": [...]}'},null,2),[[w,Y.value]]),L.value?(n(),l("p",Ls,v(L.value),1)):k("",!0)])]),_:1}),V(r,{key:"upload",tab:"文件上传"},{default:U(()=>[e("div",zs,[e("label",{class:"upload-area",onDragover:t[15]||(t[15]=vt(()=>{},["prevent"])),onDrop:vt(Ut,["prevent"])},[e("input",{type:"file",accept:".json",onChange:Ot,hidden:""},null,32),t[77]||(t[77]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),t[78]||(t[78]=e("p",{class:"upload-title"},"点击或拖拽文件到此区域上传",-1)),t[79]||(t[79]=e("p",{class:"upload-hint"},"支持 .json 格式，最大 1MB",-1))],32)])]),_:1})]),_:1},8,["activeKey"]),e("div",Fs,[e("button",{class:"modal-btn secondary",onClick:ot},"取消"),e("button",{class:"modal-btn primary",onClick:Et,disabled:W.value},[W.value?(n(),l("span",Rs)):k("",!0),h(" "+v(A.value?"保存":"添加"),1)],8,Hs)])]),_:1},8,["open","title"])])}}},Gs=zt(Js,[["__scopeId","data-v-741084c2"]]);export{Gs as default};
