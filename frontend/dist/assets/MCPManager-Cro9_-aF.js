import{l as ue,r as p,i as r,c as l,a as e,b as B,m as _t,e as y,t as v,g as R,T as wt,F as w,f as H,d as $t,h as bt,o as n,k as f,n as S,w as g,y as ce,v as x,I as Tt,j as Vt,M as Pt,E as jt}from"./index-CjHtS17A.js";import{m as K,d as b,e as ve,f as ct}from"./index-PrkzALow.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ye={class:"mcp-manager"},he={class:"page-header"},me={class:"header-content"},ke={class:"header-actions"},fe={key:0,class:"context-panel"},ge={class:"context-header"},_e={class:"context-stats"},we={class:"stat"},be={class:"stat"},xe={class:"context-body"},Ce={class:"context-section"},Se={class:"prompt-preview"},Me={class:"page-content"},Be={class:"section"},$e={class:"server-grid"},Te={class:"card-header"},Ve={class:"server-info"},Pe={class:"server-details"},je={class:"server-transport"},Ue={class:"toggle-switch"},Oe=["checked","onChange"],Re={class:"card-body"},De={class:"server-desc"},Ee={class:"server-tools"},Ie={class:"tools-list"},ze={key:0,class:"tool-tag more"},He={class:"card-footer"},Ke={class:"footer-left"},Ae={class:"footer-actions"},Le=["onClick","disabled"],Fe={key:0,class:"spinner"},Je={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},qe=["onClick"],Ne=["onClick"],We=["onClick","disabled"],Ye={key:0,class:"spinner small"},Ge={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Qe=["onClick"],Xe={class:"section"},Ze={class:"section-header"},ts={key:0,class:"empty-state"},es={key:1,class:"server-grid"},ss={class:"card-header"},os={class:"server-info"},ls={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ns={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},as={class:"server-details"},rs={key:0,class:"server-transport"},is={key:1,class:"server-url"},ds={class:"card-actions"},us=["onClick"],cs=["onClick"],vs={class:"card-body"},ps={key:0,class:"server-desc"},ys={key:1,class:"server-command"},hs={key:2,class:"server-tools"},ms={class:"tools-list"},ks={key:0,class:"tool-tag more"},fs={class:"card-footer"},gs={class:"footer-left"},_s={key:0,class:"last-check"},ws={class:"footer-actions"},bs=["onClick","disabled"],xs={key:0,class:"spinner"},Cs={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ss=["onClick"],Ms=["onClick"],Bs=["onClick","disabled"],$s={key:0,class:"spinner small"},Ts={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Vs=["onClick","disabled"],Ps={key:0,class:"spinner"},js={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Us=["onClick"],Os=["onClick"],Rs=["onClick","disabled"],Ds={key:0,class:"spinner small"},Es={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Is=["onClick"],zs={key:0,class:"test-drawer"},Hs={class:"drawer-header"},Ks={class:"drawer-content"},As={class:"tools-section"},Ls={key:0,class:"loading-state"},Fs={key:1,class:"empty-state small"},Js={key:2,class:"tools-list-panel"},qs=["onClick"],Ns={class:"tool-name"},Ws={class:"tool-desc"},Ys={key:0,class:"call-section"},Gs={class:"form-fields"},Qs={key:0,class:"required"},Xs=["onUpdate:modelValue","placeholder"],Zs=["onUpdate:modelValue","placeholder"],to=["onUpdate:modelValue","placeholder"],eo=["disabled"],so={key:0,class:"spinner small"},oo={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},lo={key:1,class:"result-section"},no={key:0,class:"duration"},ao={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ro={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},io={class:"result-json"},uo={class:"form-section"},co={class:"form-group"},vo={class:"transport-selector"},po={class:"form-group"},yo={class:"form-group"},ho={class:"form-group"},mo={class:"form-group"},ko={class:"form-group"},fo={class:"form-group"},go={class:"form-group"},_o={class:"form-group"},wo={class:"json-editor-section"},bo={key:0,class:"error-text"},xo={class:"upload-section"},Co={class:"modal-footer"},So=["disabled"],Mo={key:0,class:"btn-spinner"},Bo={key:0,class:"roots-drawer"},$o={class:"drawer-header"},To={class:"drawer-content"},Vo={class:"add-root-section"},Po={class:"add-root-form"},jo={class:"form-row"},Uo={class:"form-row"},Oo=["disabled"],Ro={key:0,class:"spinner small"},Do={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Eo={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Io={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},zo={class:"roots-list-section"},Ho={class:"count"},Ko={key:0,class:"loading-state"},Ao={key:1,class:"empty-state small"},Lo={key:2,class:"roots-list"},Fo={class:"root-info"},Jo={class:"root-details"},qo={class:"root-name"},No={class:"root-path"},Wo={key:0,class:"root-type"},Yo=["onClick"],Go={__name:"MCPManager",setup(Qo){const A=p([]),L=p(!1),G=p("form"),F=p(null),st=p(!1),J=p(""),ot=p(!1),q=p(null),vt=p({}),P=p(null),j=p(null),pt=p({}),lt=p(null),nt=p(null),m=p(null),D=p(!1),$=p([]),C=p(null),k=ce({}),Q=p(!1),_=p(null),yt=p(!1),U=p(null),N=p([]),ht=p(!1),at=p(!1),T=p(""),X=p(""),xt=p(!1),O=p(null),h=p({name:"",transport:"http",server_url:"",health_check_path:"/health",command:"npx",args:[],env:{},description:"",tools:[]}),E=p(""),I=p(""),z=p(""),Z=p(""),Ut=$t(()=>A.value.filter(s=>s.is_preset)),Ct=$t(()=>A.value.filter(s=>!s.is_preset));ue(async()=>{await Promise.all([Ot(),tt(),mt(),M()])});const Ot=async()=>{try{A.value=await K.list()}catch(s){console.error("Failed to load MCP servers:",s),r.error("加载服务器列表失败")}},tt=async()=>{try{const s=await b.getStdioStatus();vt.value=s.servers||{}}catch(s){console.error("Failed to load stdio status:",s)}},mt=async()=>{try{const s=await b.getSseStatus();pt.value=s.servers||{}}catch(s){console.error("Failed to load SSE status:",s)}},M=async()=>{try{q.value=await ve.getContext()}catch(s){console.error("Failed to load MCP context:",s)}},rt=s=>s.is_preset?s.name.toLowerCase().replace(/\s+/g,""):`custom_${s.id}`,V=s=>`custom_${s.id}`,W=s=>s!=null&&s.preset_key?s.preset_key:(s==null?void 0:s.name)==="Context7"?"context7":(s==null?void 0:s.name)==="Everything Server"?"everything":(s==null?void 0:s.name)==="和风天气"?"hefeng":(s==null?void 0:s.name)==="Wttr天气"?"wttr":null,it=s=>{var a;if(s.transport!=="stdio")return!1;const t=W(s);return t&&((a=vt.value[t])==null?void 0:a.running)||!1},dt=s=>{var a;if(s.transport!=="stdio")return!1;const t=V(s);return((a=vt.value[t])==null?void 0:a.running)||!1},Rt=s=>it(s)?"running":s.status==="enabled"?"success":s.status==="error"?"error":"warning",Dt=s=>it(s)?"运行中":{enabled:"已启用",disabled:"已禁用",error:"连接失败"}[s.status]||s.status,Et=s=>(s.transport==="sse"||s.transport==="http")&&kt(s)||dt(s)?"running":s.status==="enabled"?"success":s.status==="error"?"error":"warning",It=s=>{if(s.transport==="sse"||s.transport==="http"){if(kt(s))return"已连接";const a=`db_${s.id}`,i=pt.value[a];return(i==null?void 0:i.state)==="connecting"?"连接中":(i==null?void 0:i.state)==="reconnecting"?"重连中":(i==null?void 0:i.state)==="error"?i.error_message||"连接失败":"未连接"}return dt(s)?"运行中":s.transport==="stdio"?{enabled:"已配置",disabled:"未启动",error:"启动失败"}[s.status]||s.status:{enabled:"已启用",disabled:"已禁用",error:"连接失败"}[s.status]||s.status},zt=s=>new Date(s).toLocaleString("zh-CN"),Ht=async s=>{try{const t=s.preset_key;if(!t){r.error("无法识别服务器标识");return}const a=s.status!=="enabled";await K.toggle(t,a),s.status=a?"enabled":"disabled",r.success(a?"已启用":"已禁用"),await M()}catch(t){console.error("Failed to toggle server:",t),r.error("切换状态失败")}},Kt=async s=>{var a,i;const t=W(s);if(!t){r.error("无法识别服务器标识");return}P.value=t;try{const d=await b.startStdioServer(t);d.success?(r.success(`${s.name} 启动成功！`),await Promise.all([tt(),M()])):r.error("启动失败: "+(d.message||"未知错误"))}catch(d){const o=((i=(a=d.response)==null?void 0:a.data)==null?void 0:i.detail)||d.message;r.error("启动失败: "+o)}finally{P.value=null}},At=async s=>{var a;const t=W(s);if(!t){r.error("无法识别服务器标识");return}j.value=t;try{(await b.stopStdioServer(t)).success&&(r.success("服务器已停止"),((a=m.value)==null?void 0:a.name)===s.name&&(m.value=null),await Promise.all([tt(),M()]))}catch(i){r.error("停止失败: "+i.message)}finally{j.value=null}},Lt=async s=>{var a,i;const t=V(s);P.value=t;try{const d=await b.startStdioServer(t);d.success?(r.success(`${s.name} 启动成功！`),await Promise.all([tt(),M()])):r.error("启动失败: "+(d.message||"未知错误"))}catch(d){const o=((i=(a=d.response)==null?void 0:a.data)==null?void 0:i.detail)||d.message;r.error("启动失败: "+o)}finally{P.value=null}},Ft=async s=>{var a;const t=V(s);j.value=t;try{(await b.stopStdioServer(t)).success&&(r.success("服务器已停止"),((a=m.value)==null?void 0:a.id)===s.id&&(m.value=null),await Promise.all([tt(),M()]))}catch(i){r.error("停止失败: "+i.message)}finally{j.value=null}},Jt=async s=>{m.value=s,C.value=null,_.value=null,Object.keys(k).forEach(t=>delete k[t]),D.value=!0;try{const t=V(s),a=await b.getStdioTools(t);$.value=a.tools||[]}catch(t){r.error("加载工具列表失败: "+t.message),$.value=[]}finally{D.value=!1}},St=async s=>{const t=r.loading("正在测试连接...",0);try{const a=await K.test(s.id||0);t(),a.connectivity?r.success("连接成功"):r.error("连接失败")}catch(a){t(),r.error("测试失败: "+a.message)}},kt=s=>{var a;if(s.transport!=="sse"&&s.transport!=="http")return!1;const t=`db_${s.id}`;return((a=pt.value[t])==null?void 0:a.state)==="connected"},qt=async s=>{var a,i;const t=`db_${s.id}`;lt.value=t;try{const d=await b.connectSseServerFromDb(s.id);d.success?(r.success(`${s.name} 连接成功！`),await Promise.all([mt(),M()])):r.error("连接失败: "+(d.message||"未知错误"))}catch(d){const o=((i=(a=d.response)==null?void 0:a.data)==null?void 0:i.detail)||d.message;r.error("连接失败: "+o)}finally{lt.value=null}},Nt=async s=>{var a;const t=`db_${s.id}`;nt.value=t;try{(await b.disconnectSseServer(t)).success&&(r.success("服务器已断开"),((a=m.value)==null?void 0:a.id)===s.id&&(m.value=null),await Promise.all([mt(),M()]))}catch(i){r.error("断开失败: "+i.message)}finally{nt.value=null}},Wt=async s=>{const t=`db_${s.id}`,a=r.loading("正在测试 SSE 连接...",0);try{const i=await b.testSseConnection(t);a(),i.success?r.success(`连接正常，延迟 ${i.latency_ms}ms`):r.error("连接异常: "+i.message)}catch(i){a(),r.error("测试失败: "+i.message)}},Yt=async s=>{m.value=s,C.value=null,_.value=null,Object.keys(k).forEach(t=>delete k[t]),D.value=!0;try{const t=`db_${s.id}`,a=await b.getSseTools(t);$.value=a.tools||[]}catch(t){r.error("加载工具列表失败: "+t.message),$.value=[]}finally{D.value=!1}},Gt=async s=>{m.value=s,C.value=null,_.value=null,Object.keys(k).forEach(t=>delete k[t]),D.value=!0;try{const t=W(s);if(!t){r.error("无法识别服务器标识"),$.value=[];return}const a=await b.getStdioTools(t);$.value=a.tools||[]}catch(t){r.error("加载工具列表失败: "+t.message),$.value=[]}finally{D.value=!1}},Qt=s=>{var a;C.value=s,_.value=null,Object.keys(k).forEach(i=>delete k[i]);const t=((a=s.inputSchema)==null?void 0:a.properties)||{};Object.entries(t).forEach(([i,d])=>{d.default!==void 0&&(k[i]=d.default)})},Xt=async()=>{if(!(!C.value||!m.value)){Q.value=!0,_.value=null;try{let s,t;if(m.value.is_preset){if(s=W(m.value),!s){r.error("无法识别服务器标识");return}t=await b.callStdioTool(s,C.value.name,{...k})}else{const a=m.value.transport;if(s=V(m.value),a==="sse"||a==="http"){const i=`db_${m.value.id}`;t=await b.callSseTool(i,C.value.name,{...k})}else t=await b.callStdioTool(s,C.value.name,{...k})}_.value=t,t.success?r.success("工具执行成功"):r.error("工具执行失败: "+(t.error||"未知错误"))}catch(s){_.value={success:!1,error:s.message},r.error("调用失败: "+s.message)}finally{Q.value=!1}}},Zt=s=>{try{return JSON.stringify(s,null,2)}catch{return String(s)}},te=async()=>{var s;if(!((s=q.value)!=null&&s.system_prompt_snippet)){r.warning("暂无内容可复制");return}try{await navigator.clipboard.writeText(q.value.system_prompt_snippet),r.success("已复制到剪贴板")}catch{r.error("复制失败")}},ee=s=>{var a;F.value=s;const t=s.transport||"http";h.value={name:s.name,transport:t,server_url:s.server_url||"",health_check_path:s.health_check_path||"/health",command:s.command||"npx",args:s.args||[],env:s.env||{},description:s.description||"",tools:s.tools||[]},z.value=((a=s.tools)==null?void 0:a.join(", "))||"",E.value=(s.args||[]).join(" "),I.value=Object.entries(s.env||{}).map(([i,d])=>`${i}=${d}`).join(`
`),L.value=!0},se=s=>{Pt.confirm({title:"删除服务器",icon:B(jt),content:`确定要删除「${s.name}」吗？`,okText:"删除",okType:"danger",cancelText:"取消",async onOk(){try{await K.delete(s.id),A.value=A.value.filter(t=>t.id!==s.id),r.success("删除成功"),await M()}catch(t){r.error("删除失败: "+t.message)}}})},oe=async s=>{const t=s.target.files[0];t&&await Mt(t)},le=async s=>{const t=s.dataTransfer.files[0];t&&await Mt(t)},Mt=async s=>{var a;if(!s.name.endsWith(".json")){r.error("仅支持 .json 文件");return}if(s.size>1024*1024){r.error("文件大小不能超过 1MB");return}const t=await s.text();try{const i=JSON.parse(t);h.value={name:i.name||"",server_url:i.server_url||"",health_check_path:i.health_check_path||"/health",description:i.description||"",tools:i.tools||[]},z.value=((a=i.tools)==null?void 0:a.join(", "))||"",Z.value=t,G.value="form",J.value="",r.success("文件解析成功")}catch{r.error("无效的 JSON 格式")}},ft=()=>{L.value=!1,F.value=null,h.value={name:"",transport:"http",server_url:"",health_check_path:"/health",command:"npx",args:[],env:{},description:"",tools:[]},E.value="",I.value="",z.value="",Z.value="",J.value="",G.value="form"},ne=async()=>{var s,t,a,i;if(G.value==="json")try{const d=JSON.parse(Z.value);h.value={name:d.name||"",transport:d.transport||"http",server_url:d.server_url||"",health_check_path:d.health_check_path||"/health",command:d.command||"npx",args:d.args||[],env:d.env||{},description:d.description||"",tools:d.tools||[]},E.value=(d.args||[]).join(" "),I.value=Object.entries(d.env||{}).map(([o,u])=>`${o}=${u}`).join(`
`)}catch{J.value="无效的 JSON 格式";return}if(z.value&&(h.value.tools=z.value.split(",").map(d=>d.trim()).filter(Boolean)),h.value.transport==="stdio"){E.value.trim()?h.value.args=E.value.trim().split(/\s+/):h.value.args=[];const d={};I.value.trim()&&I.value.split(`
`).forEach(o=>{const u=o.trim();if(u&&u.includes("=")){const c=u.indexOf("="),Y=u.substring(0,c).trim(),ut=u.substring(c+1).trim();Y&&(d[Y]=ut)}}),h.value.env=d}if(!h.value.name){r.warning("请填写服务器名称");return}if(h.value.transport==="http"&&!h.value.server_url){r.warning("HTTP 类型需要填写服务器 URL");return}if(h.value.transport==="stdio"&&!h.value.command){r.warning("STDIO 类型需要填写启动命令");return}st.value=!0;try{const d={...h.value};d.transport==="http"?(delete d.command,delete d.args,delete d.env):(delete d.server_url,delete d.health_check_path),F.value?await K.update(F.value.id,d):(await K.addConfig(d)).transport==="stdio"&&r.success("STDIO 服务器已添加，可在列表中启动"),A.value=await K.list(),ft(),r.success("保存成功"),await M()}catch(d){r.error("保存失败: "+(((t=(s=d.response)==null?void 0:s.data)==null?void 0:t.detail)||((i=(a=d.response)==null?void 0:a.data)==null?void 0:i.message)||d.message))}finally{st.value=!1}},Bt=async s=>{let t;if(s.is_preset?t=W(s):t=`custom_${s.id}`,!t){r.error("无法识别服务器");return}U.value={...s,serverKey:t},yt.value=!0,await gt(t)},gt=async s=>{ht.value=!0;try{const t=await ct.getServerRoots(s);N.value=t.roots||[]}catch(t){console.error("加载根目录失败:",t),N.value=[]}finally{ht.value=!1}},ae=async()=>{var s,t;if(!T.value.trim()){r.warning("请输入路径");return}at.value=!0;try{await ct.addServerRoot(U.value.serverKey,T.value.trim(),X.value.trim()||null),r.success("根目录添加成功"),T.value="",X.value="",await gt(U.value.serverKey)}catch(a){r.error("添加失败: "+(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.detail)||a.message))}finally{at.value=!1}},re=async s=>{Pt.confirm({title:"移除根目录",icon:B(jt),content:`确定要移除「${s.name||s.path}」吗？`,okText:"移除",okType:"danger",cancelText:"取消",async onOk(){try{await ct.removeServerRoot(U.value.serverKey,s.path),r.success("根目录已移除"),await gt(U.value.serverKey)}catch(t){r.error("移除失败: "+t.message)}}})},ie=async()=>{if(!T.value.trim()){O.value=null;return}xt.value=!0;try{const s=await ct.validatePath(U.value.serverKey,T.value.trim());O.value=s}catch{O.value=null}finally{xt.value=!1}},de=()=>{yt.value=!1,U.value=null,N.value=[],T.value="",X.value="",O.value=null};return(s,t)=>{const a=bt("a-tab-pane"),i=bt("a-tabs"),d=bt("a-modal");return n(),l("div",ye,[e("header",he,[e("div",me,[t[21]||(t[21]=_t('<div class="title-group" data-v-91b42e38><h1 data-v-91b42e38><span class="icon-wrapper" data-v-91b42e38><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-91b42e38><path d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01" data-v-91b42e38></path></svg></span> MCP 服务器管理 </h1><p class="subtitle" data-v-91b42e38>管理 Model Context Protocol 服务器，扩展 AI 模型能力</p></div>',1)),e("div",ke,[e("button",{class:"context-btn",onClick:t[0]||(t[0]=o=>ot.value=!ot.value)},[t[20]||(t[20]=_t('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-91b42e38><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-91b42e38></path><polyline points="14 2 14 8 20 8" data-v-91b42e38></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-91b42e38></line><line x1="16" y1="17" x2="8" y2="17" data-v-91b42e38></line></svg>',1)),y(" "+v(ot.value?"隐藏":"查看")+" MCP 上下文 ",1)])])])]),B(wt,{name:"slide"},{default:R(()=>{var o,u,c;return[ot.value?(n(),l("div",fe,[e("div",ge,[t[24]||(t[24]=e("h3",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 16v-4M12 8h.01"})]),y(" MCP 上下文信息 ")],-1)),e("div",_e,[e("span",we,[e("strong",null,v(((o=q.value)==null?void 0:o.total_enabled_servers)||0),1),t[22]||(t[22]=y(" 个已启用服务器 ",-1))]),e("span",be,[e("strong",null,v(((u=q.value)==null?void 0:u.total_available_tools)||0),1),t[23]||(t[23]=y(" 个可用工具 ",-1))])])]),e("div",xe,[e("div",Ce,[t[26]||(t[26]=e("h4",null,"系统提示词片段",-1)),t[27]||(t[27]=e("p",{class:"hint"},"此内容会自动注入到 AI 的系统提示词中，让 AI 知道有哪些 MCP 工具可用",-1)),e("div",Se,[e("pre",null,v(((c=q.value)==null?void 0:c.system_prompt_snippet)||"暂无已启用的 MCP 服务器"),1)]),e("button",{class:"copy-btn",onClick:te},[...t[25]||(t[25]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})],-1),y(" 复制 ",-1)])])])])])):f("",!0)]}),_:1}),e("div",Me,[e("section",Be,[t[38]||(t[38]=e("div",{class:"section-header"},[e("h2",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M12 1v6m0 6v10M4.22 4.22l4.24 4.24m7.08 7.08l4.24 4.24M1 12h6m6 0h10M4.22 19.78l4.24-4.24m7.08-7.08l4.24-4.24"})]),y(" 预置服务器 ")])],-1)),e("div",$e,[(n(!0),l(w,null,H(Ut.value,o=>(n(),l("article",{key:o.name,class:S(["server-card",{running:it(o)}])},[e("div",Te,[e("div",Ve,[t[28]||(t[28]=e("div",{class:"server-icon preset"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2"}),e("path",{d:"M8 21h8M12 17v4"})])],-1)),e("div",Pe,[e("h3",null,v(o.name),1),e("span",je,v(o.transport==="stdio"?"STDIO":"HTTP"),1)])]),e("label",Ue,[e("input",{type:"checkbox",checked:o.status==="enabled"||o.status==="running",onChange:u=>Ht(o)},null,40,Oe),t[29]||(t[29]=e("span",{class:"toggle-slider"},null,-1))])]),e("div",Re,[e("p",De,v(o.description),1),e("div",Ee,[t[30]||(t[30]=e("span",{class:"tools-label"},"工具:",-1)),e("div",Ie,[(n(!0),l(w,null,H(o.tools.slice(0,4),u=>(n(),l("span",{key:u,class:"tool-tag"},v(u),1))),128)),o.tools.length>4?(n(),l("span",ze," +"+v(o.tools.length-4),1)):f("",!0)])])]),e("div",He,[e("div",Ke,[e("span",{class:S(["status-badge",Rt(o)])},[t[31]||(t[31]=e("span",{class:"status-dot"},null,-1)),y(" "+v(Dt(o)),1)],2)]),e("div",Ae,[o.transport==="stdio"?(n(),l(w,{key:0},[it(o)?(n(),l(w,{key:1},[e("button",{class:"action-btn secondary",onClick:u=>Bt(o),title:"工作区目录"},[...t[34]||(t[34]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})],-1)])],8,qe),e("button",{class:"action-btn test",onClick:u=>Gt(o)},[...t[35]||(t[35]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})],-1),y(" 测试 ",-1)])],8,Ne),e("button",{class:"action-btn stop",onClick:u=>At(o),disabled:j.value===rt(o)},[j.value===rt(o)?(n(),l("span",Ye)):(n(),l("svg",Ge,[...t[36]||(t[36]=[e("rect",{x:"6",y:"6",width:"12",height:"12"},null,-1)])]))],8,We)],64)):(n(),l("button",{key:0,class:"action-btn start",onClick:u=>Kt(o),disabled:P.value===rt(o)},[P.value===rt(o)?(n(),l("span",Fe)):(n(),l("svg",Je,[...t[32]||(t[32]=[e("polygon",{points:"5 3 19 12 5 21 5 3"},null,-1)])])),t[33]||(t[33]=y(" 启动 ",-1))],8,Le))],64)):(n(),l("button",{key:1,class:"action-btn test",onClick:u=>St(o)},[...t[37]||(t[37]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),y(" 测试 ",-1)])],8,Qe))])])],2))),128))])]),e("section",Xe,[e("div",Ze,[t[40]||(t[40]=e("h2",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})]),y(" 自定义服务器 ")],-1)),e("button",{class:"add-server-btn",onClick:t[1]||(t[1]=o=>L.value=!0)},[...t[39]||(t[39]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[e("path",{d:"M12 4v16m-8-8h16"})],-1),y(" 添加服务器 ",-1)])])]),Ct.value.length===0?(n(),l("div",ts,[t[42]||(t[42]=_t('<div class="empty-illustration" data-v-91b42e38><svg viewBox="0 0 200 200" fill="none" data-v-91b42e38><circle cx="100" cy="100" r="80" fill="#f1f5f9" data-v-91b42e38></circle><rect x="65" y="60" width="70" height="50" rx="4" fill="#e2e8f0" data-v-91b42e38></rect><circle cx="80" cy="75" r="4" fill="#cbd5e1" data-v-91b42e38></circle><circle cx="95" cy="75" r="4" fill="#cbd5e1" data-v-91b42e38></circle><rect x="65" y="120" width="70" height="30" rx="4" fill="#e2e8f0" data-v-91b42e38></rect><circle cx="80" cy="135" r="4" fill="#cbd5e1" data-v-91b42e38></circle><circle cx="95" cy="135" r="4" fill="#cbd5e1" data-v-91b42e38></circle><circle cx="100" cy="100" r="15" fill="#6366f1" opacity="0.2" data-v-91b42e38></circle><path d="M95 100h10M100 95v10" stroke="#6366f1" stroke-width="2" stroke-linecap="round" data-v-91b42e38></path></svg></div><h3 data-v-91b42e38>暂无自定义服务器</h3><p data-v-91b42e38>添加您自己的 MCP 服务器来扩展 AI 能力</p>',3)),e("button",{class:"add-btn-primary",onClick:t[2]||(t[2]=o=>L.value=!0)},[...t[41]||(t[41]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[e("path",{d:"M12 4v16m-8-8h16"})],-1),y(" 添加服务器 ",-1)])])])):(n(),l("div",es,[(n(!0),l(w,null,H(Ct.value,o=>{var u;return n(),l("article",{key:o.id,class:S(["server-card custom",{running:dt(o)}])},[e("div",ss,[e("div",os,[e("div",{class:S(["server-icon",o.transport==="stdio"?"stdio":"custom"])},[o.transport==="stdio"?(n(),l("svg",ls,[...t[43]||(t[43]=[e("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2"},null,-1),e("path",{d:"M8 21h8M12 17v4"},null,-1),e("path",{d:"M7 8l3 3-3 3M12 14h5"},null,-1)])])):(n(),l("svg",ns,[...t[44]||(t[44]=[e("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"},null,-1)])]))],2),e("div",as,[e("h3",null,v(o.name),1),o.transport==="stdio"?(n(),l("span",rs,"STDIO")):(n(),l("span",is,v(o.server_url),1))])]),e("div",ds,[e("button",{class:"icon-btn",onClick:c=>ee(o),title:"编辑"},[...t[45]||(t[45]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,us),e("button",{class:"icon-btn danger",onClick:c=>se(o),title:"删除"},[...t[46]||(t[46]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})],-1)])],8,cs)])]),e("div",vs,[o.description?(n(),l("p",ps,v(o.description),1)):f("",!0),o.transport==="stdio"?(n(),l("div",ys,[t[47]||(t[47]=e("span",{class:"command-label"},"命令:",-1)),e("code",null,v(o.command)+" "+v((o.args||[]).join(" ")),1)])):f("",!0),(u=o.tools)!=null&&u.length?(n(),l("div",hs,[t[48]||(t[48]=e("span",{class:"tools-label"},"工具:",-1)),e("div",ms,[(n(!0),l(w,null,H(o.tools.slice(0,4),c=>(n(),l("span",{key:c,class:"tool-tag"},v(c),1))),128)),o.tools.length>4?(n(),l("span",ks," +"+v(o.tools.length-4),1)):f("",!0)])])):f("",!0)]),e("div",fs,[e("div",gs,[e("span",{class:S(["status-badge",Et(o)])},[t[49]||(t[49]=e("span",{class:"status-dot"},null,-1)),y(" "+v(It(o)),1)],2),o.last_check?(n(),l("span",_s,[t[50]||(t[50]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 6v6l4 2"})],-1)),y(" "+v(zt(o.last_check)),1)])):f("",!0)]),e("div",ws,[o.transport==="stdio"?(n(),l(w,{key:0},[dt(o)?(n(),l(w,{key:1},[e("button",{class:"action-btn secondary",onClick:c=>Bt(o),title:"工作区目录"},[...t[53]||(t[53]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})],-1)])],8,Ss),e("button",{class:"action-btn test",onClick:c=>Jt(o)},[...t[54]||(t[54]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})],-1),y(" 测试 ",-1)])],8,Ms),e("button",{class:"action-btn stop",onClick:c=>Ft(o),disabled:j.value===V(o)},[j.value===V(o)?(n(),l("span",$s)):(n(),l("svg",Ts,[...t[55]||(t[55]=[e("rect",{x:"6",y:"6",width:"12",height:"12"},null,-1)])]))],8,Bs)],64)):(n(),l("button",{key:0,class:"action-btn start",onClick:c=>Lt(o),disabled:P.value===V(o)},[P.value===V(o)?(n(),l("span",xs)):(n(),l("svg",Cs,[...t[51]||(t[51]=[e("polygon",{points:"5 3 19 12 5 21 5 3"},null,-1)])])),t[52]||(t[52]=y(" 启动 ",-1))],8,bs))],64)):o.transport==="sse"||o.transport==="http"?(n(),l(w,{key:1},[kt(o)?(n(),l(w,{key:1},[e("button",{class:"action-btn test",onClick:c=>Yt(o)},[...t[58]||(t[58]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})],-1),y(" 测试 ",-1)])],8,Us),e("button",{class:"action-btn secondary",onClick:c=>Wt(o)},[...t[59]||(t[59]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 6v6l4 2"})],-1)])],8,Os),e("button",{class:"action-btn stop",onClick:c=>Nt(o),disabled:nt.value===`db_${o.id}`},[nt.value===`db_${o.id}`?(n(),l("span",Ds)):(n(),l("svg",Es,[...t[60]||(t[60]=[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"},null,-1)])]))],8,Rs)],64)):(n(),l("button",{key:0,class:"action-btn start",onClick:c=>qt(o),disabled:lt.value===`db_${o.id}`},[lt.value===`db_${o.id}`?(n(),l("span",Ps)):(n(),l("svg",js,[...t[56]||(t[56]=[e("path",{d:"M5 12h14M12 5l7 7-7 7"},null,-1)])])),t[57]||(t[57]=y(" 连接 ",-1))],8,Vs))],64)):(n(),l("button",{key:2,class:"action-btn test",onClick:c=>St(o)},[...t[61]||(t[61]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),y(" 测试 ",-1)])],8,Is))])])],2)}),128))]))])]),B(wt,{name:"drawer"},{default:R(()=>{var o;return[m.value?(n(),l("div",zs,[e("div",Hs,[e("h3",null,[t[62]||(t[62]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})],-1)),y(" "+v(m.value.name)+" 工具测试 ",1)]),e("button",{class:"close-btn",onClick:t[3]||(t[3]=u=>m.value=null)},[...t[63]||(t[63]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),e("div",Ks,[e("div",As,[t[66]||(t[66]=e("h4",null,"可用工具",-1)),D.value?(n(),l("div",Ls,[...t[64]||(t[64]=[e("div",{class:"loader"},null,-1),e("span",null,"加载工具列表...",-1)])])):$.value.length===0?(n(),l("div",Fs,[...t[65]||(t[65]=[e("p",null,"暂无可用工具",-1)])])):(n(),l("div",Js,[(n(!0),l(w,null,H($.value,u=>{var c;return n(),l("div",{key:u.name,class:S(["tool-item",{selected:((c=C.value)==null?void 0:c.name)===u.name}]),onClick:Y=>Qt(u)},[e("div",Ns,v(u.name),1),e("div",Ws,v(u.description||"无描述"),1)],10,qs)}),128))]))]),C.value?(n(),l("div",Ys,[e("h4",null,"调用 "+v(C.value.name),1),e("div",Gs,[(n(!0),l(w,null,H(((o=C.value.inputSchema)==null?void 0:o.properties)||{},(u,c)=>{var Y,ut;return n(),l("div",{key:c,class:"form-field"},[e("label",null,[y(v(c)+" ",1),(ut=(Y=C.value.inputSchema)==null?void 0:Y.required)!=null&&ut.includes(c)?(n(),l("span",Qs,"*")):f("",!0)]),u.type==="string"?g((n(),l("input",{key:0,"onUpdate:modelValue":et=>k[c]=et,type:"text",placeholder:u.description||`输入 ${c}`},null,8,Xs)),[[x,k[c]]]):u.type==="integer"||u.type==="number"?g((n(),l("input",{key:1,"onUpdate:modelValue":et=>k[c]=et,type:"number",placeholder:u.description||`输入 ${c}`},null,8,Zs)),[[x,k[c],void 0,{number:!0}]]):g((n(),l("textarea",{key:2,"onUpdate:modelValue":et=>k[c]=et,placeholder:u.description||`输入 ${c}`,rows:"2"},null,8,to)),[[x,k[c]]])])}),128))]),e("button",{class:"call-btn",onClick:Xt,disabled:Q.value},[Q.value?(n(),l("span",so)):(n(),l("svg",oo,[...t[67]||(t[67]=[e("polygon",{points:"5 3 19 12 5 21 5 3"},null,-1)])])),y(" "+v(Q.value?"执行中...":"执行工具"),1)],8,eo)])):f("",!0),_.value?(n(),l("div",lo,[e("h4",null,[t[68]||(t[68]=y(" 执行结果 ",-1)),_.value.duration_ms?(n(),l("span",no,v(_.value.duration_ms)+"ms",1)):f("",!0)]),e("div",{class:S(["result-status",_.value.success?"success":"error"])},[_.value.success?(n(),l("svg",ao,[...t[69]||(t[69]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(n(),l("svg",ro,[...t[70]||(t[70]=[e("circle",{cx:"12",cy:"12",r:"10"},null,-1),e("line",{x1:"15",y1:"9",x2:"9",y2:"15"},null,-1),e("line",{x1:"9",y1:"9",x2:"15",y2:"15"},null,-1)])])),y(" "+v(_.value.success?"执行成功":"执行失败"),1)],2),e("pre",io,v(Zt(_.value.data||_.value.error)),1)])):f("",!0)])])):f("",!0)]}),_:1}),B(d,{open:L.value,"onUpdate:open":t[17]||(t[17]=o=>L.value=o),title:F.value?"编辑服务器":"添加 MCP 服务器",width:"640px",footer:null,onCancel:ft,class:"server-modal"},{default:R(()=>[B(i,{activeKey:G.value,"onUpdate:activeKey":t[16]||(t[16]=o=>G.value=o),class:"modal-tabs"},{default:R(()=>[B(a,{key:"form",tab:"表单配置"},{default:R(()=>[e("div",uo,[e("div",co,[t[73]||(t[73]=e("label",null,[y("传输类型 "),e("span",{class:"required"},"*")],-1)),e("div",vo,[e("label",{class:S(["transport-option",{active:h.value.transport==="http"}])},[g(e("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=o=>h.value.transport=o),value:"http"},null,512),[[Tt,h.value.transport]]),t[71]||(t[71]=e("div",{class:"option-content"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),e("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]),e("span",null,"HTTP/SSE"),e("small",null,"远程服务器")],-1))],2),e("label",{class:S(["transport-option",{active:h.value.transport==="stdio"}])},[g(e("input",{type:"radio","onUpdate:modelValue":t[5]||(t[5]=o=>h.value.transport=o),value:"stdio"},null,512),[[Tt,h.value.transport]]),t[72]||(t[72]=e("div",{class:"option-content"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2"}),e("path",{d:"M8 21h8M12 17v4"}),e("path",{d:"M7 8l3 3-3 3M12 14h5"})]),e("span",null,"STDIO"),e("small",null,"本地进程")],-1))],2)])]),e("div",po,[t[74]||(t[74]=e("label",null,[y("服务器名称 "),e("span",{class:"required"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>h.value.name=o),type:"text",class:"form-input",placeholder:"My MCP Server"},null,512),[[x,h.value.name]])]),h.value.transport==="http"?(n(),l(w,{key:0},[e("div",yo,[t[75]||(t[75]=e("label",null,[y("服务器 URL "),e("span",{class:"required"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>h.value.server_url=o),type:"text",class:"form-input",placeholder:"https://mcp.example.com"},null,512),[[x,h.value.server_url]])]),e("div",ho,[t[76]||(t[76]=e("label",null,"健康检查路径",-1)),g(e("input",{"onUpdate:modelValue":t[8]||(t[8]=o=>h.value.health_check_path=o),type:"text",class:"form-input",placeholder:"/health"},null,512),[[x,h.value.health_check_path]])])],64)):(n(),l(w,{key:1},[e("div",mo,[t[77]||(t[77]=e("label",null,[y("启动命令 "),e("span",{class:"required"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>h.value.command=o),type:"text",class:"form-input",placeholder:"npx"},null,512),[[x,h.value.command]]),t[78]||(t[78]=e("p",{class:"form-hint"},"常用命令：npx, node, python, uvx",-1))]),e("div",ko,[t[79]||(t[79]=e("label",null,"命令参数",-1)),g(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>E.value=o),type:"text",class:"form-input",placeholder:"-y wttr-mcp-server@latest"},null,512),[[x,E.value]]),t[80]||(t[80]=e("p",{class:"form-hint"},"空格分隔，例如：-y wttr-mcp-server@latest",-1))]),e("div",fo,[t[81]||(t[81]=e("label",null,"环境变量",-1)),g(e("textarea",{"onUpdate:modelValue":t[11]||(t[11]=o=>I.value=o),class:"form-textarea",rows:"3",placeholder:`API_KEY=your_key
OTHER_VAR=value`},null,512),[[x,I.value]]),t[82]||(t[82]=e("p",{class:"form-hint"},"每行一个，格式：KEY=VALUE",-1))])],64)),e("div",go,[t[83]||(t[83]=e("label",null,"工具列表 (逗号分隔)",-1)),g(e("input",{"onUpdate:modelValue":t[12]||(t[12]=o=>z.value=o),type:"text",class:"form-input",placeholder:"search, retrieve, store"},null,512),[[x,z.value]]),t[84]||(t[84]=e("p",{class:"form-hint"},"可选，服务器启动后会自动获取",-1))]),e("div",_o,[t[85]||(t[85]=e("label",null,"描述",-1)),g(e("textarea",{"onUpdate:modelValue":t[13]||(t[13]=o=>h.value.description=o),class:"form-textarea",rows:"3",placeholder:"服务器描述..."},null,512),[[x,h.value.description]])])])]),_:1}),B(a,{key:"json",tab:"JSON 编辑"},{default:R(()=>[e("div",wo,[g(e("textarea",{"onUpdate:modelValue":t[14]||(t[14]=o=>Z.value=o),class:S(["json-editor",{error:J.value}]),rows:"15",placeholder:'{"name": "...", "server_url": "...", "tools": [...]}'},null,2),[[x,Z.value]]),J.value?(n(),l("p",bo,v(J.value),1)):f("",!0)])]),_:1}),B(a,{key:"upload",tab:"文件上传"},{default:R(()=>[e("div",xo,[e("label",{class:"upload-area",onDragover:t[15]||(t[15]=Vt(()=>{},["prevent"])),onDrop:Vt(le,["prevent"])},[e("input",{type:"file",accept:".json",onChange:oe,hidden:""},null,32),t[86]||(t[86]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),t[87]||(t[87]=e("p",{class:"upload-title"},"点击或拖拽文件到此区域上传",-1)),t[88]||(t[88]=e("p",{class:"upload-hint"},"支持 .json 格式，最大 1MB",-1))],32)])]),_:1})]),_:1},8,["activeKey"]),e("div",Co,[e("button",{class:"modal-btn secondary",onClick:ft},"取消"),e("button",{class:"modal-btn primary",onClick:ne,disabled:st.value},[st.value?(n(),l("span",Mo)):f("",!0),y(" "+v(F.value?"保存":"添加"),1)],8,So)])]),_:1},8,["open","title"]),B(wt,{name:"drawer"},{default:R(()=>{var o;return[yt.value?(n(),l("div",Bo,[e("div",$o,[e("h3",null,[t[89]||(t[89]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})],-1)),y(" "+v((o=U.value)==null?void 0:o.name)+" - 工作区目录 ",1)]),e("button",{class:"close-btn",onClick:de},[...t[90]||(t[90]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),e("div",To,[t[101]||(t[101]=e("div",{class:"roots-info"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 16v-4M12 8h.01"})]),e("p",null,"工作区目录定义了 MCP 服务器可以访问的文件系统范围。配置后，工具调用中的文件路径将被限制在这些目录内。")],-1)),e("div",Vo,[t[95]||(t[95]=e("h4",null,"添加根目录",-1)),e("div",Po,[e("div",jo,[g(e("input",{"onUpdate:modelValue":t[18]||(t[18]=u=>T.value=u),type:"text",class:"form-input",placeholder:"输入目录路径，如 /Users/project",onBlur:ie},null,544),[[x,T.value]])]),e("div",Uo,[g(e("input",{"onUpdate:modelValue":t[19]||(t[19]=u=>X.value=u),type:"text",class:"form-input small",placeholder:"名称（可选）"},null,512),[[x,X.value]]),e("button",{class:"add-root-btn",onClick:ae,disabled:at.value||!T.value.trim()},[at.value?(n(),l("span",Ro)):(n(),l("svg",Do,[...t[91]||(t[91]=[e("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),e("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])),t[92]||(t[92]=y(" 添加 ",-1))],8,Oo)]),O.value?(n(),l("div",{key:0,class:S(["validation-result",O.value.allowed?"success":"warning"])},[O.value.allowed?(n(),l("svg",Eo,[...t[93]||(t[93]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(n(),l("svg",Io,[...t[94]||(t[94]=[e("circle",{cx:"12",cy:"12",r:"10"},null,-1),e("line",{x1:"12",y1:"8",x2:"12",y2:"12"},null,-1),e("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"},null,-1)])])),e("span",null,v(O.value.message),1)],2)):f("",!0)])]),e("div",zo,[e("h4",null,[t[96]||(t[96]=y(" 已配置的根目录 ",-1)),e("span",Ho,v(N.value.length),1)]),ht.value?(n(),l("div",Ko,[...t[97]||(t[97]=[e("div",{class:"loader"},null,-1),e("span",null,"加载中...",-1)])])):N.value.length===0?(n(),l("div",Ao,[...t[98]||(t[98]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}),e("line",{x1:"12",y1:"11",x2:"12",y2:"17"}),e("line",{x1:"9",y1:"14",x2:"15",y2:"14"})],-1),e("p",null,"暂无根目录配置",-1),e("small",null,"添加根目录后，工具调用将限制在这些目录范围内",-1)])])):(n(),l("div",Lo,[(n(!0),l(w,null,H(N.value,u=>(n(),l("div",{key:u.uri,class:"root-item"},[e("div",Fo,[t[99]||(t[99]=e("div",{class:"root-icon"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})])],-1)),e("div",Jo,[e("div",qo,v(u.name||"未命名"),1),e("div",No,v(u.path),1),u.type&&u.type!=="custom"?(n(),l("div",Wo,v(u.type),1)):f("",!0)])]),e("button",{class:"remove-root-btn",onClick:c=>re(u),title:"移除"},[...t[100]||(t[100]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})],-1)])],8,Yo)]))),128))]))])])])):f("",!0)]}),_:1})])}}},el=pe(Go,[["__scopeId","data-v-91b42e38"]]);export{el as default};
