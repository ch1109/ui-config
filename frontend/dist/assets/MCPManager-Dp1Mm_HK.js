import{r as p,x as de,c as Bt,o as ue,a as d,b as l,d as e,e as B,f as gt,k as y,t as v,w as E,T as wt,F as _,h as H,g as _t,j as n,l as k,m as S,i as g,v as b,G as $t,p as Tt,M as Vt,E as Pt}from"./index-VWhHohYx.js";import{_ as ce,m as A,b as x,d as ve,e as ut}from"./_plugin-vue_export-helper-CLyVweMD.js";const pe={class:"mcp-manager"},ye={class:"page-header"},he={class:"header-content"},me={class:"header-actions"},fe={key:0,class:"context-panel"},ke={class:"context-header"},ge={class:"context-stats"},we={class:"stat"},_e={class:"stat"},xe={class:"context-body"},be={class:"context-section"},Ce={class:"prompt-preview"},Se={class:"page-content"},Me={class:"section"},Be={class:"server-grid"},$e={class:"card-header"},Te={class:"server-info"},Ve={class:"server-details"},Pe={class:"server-transport"},je={class:"toggle-switch"},Ue=["checked","onChange"],Oe={class:"card-body"},Ee={class:"server-desc"},Re={class:"server-tools"},De={class:"tools-list"},ze={key:0,class:"tool-tag more"},Ie={class:"card-footer"},He={class:"footer-left"},Ae={class:"footer-actions"},Ke=["onClick","disabled"],Le={key:0,class:"spinner"},Fe={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Je=["onClick"],qe=["onClick"],Ne=["onClick","disabled"],Ye={key:0,class:"spinner small"},Ge={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},We=["onClick"],Qe={class:"section"},Xe={class:"section-header"},Ze={key:0,class:"empty-state"},ts={key:1,class:"server-grid"},es={class:"card-header"},ss={class:"server-info"},os={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ls={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ns={class:"server-details"},as={key:0,class:"server-transport"},rs={key:1,class:"server-url"},is={class:"card-actions"},ds=["onClick"],us=["onClick"],cs={class:"card-body"},vs={key:0,class:"server-desc"},ps={key:1,class:"server-command"},ys={key:2,class:"server-tools"},hs={class:"tools-list"},ms={key:0,class:"tool-tag more"},fs={class:"card-footer"},ks={class:"footer-left"},gs={key:0,class:"last-check"},ws={class:"footer-actions"},_s=["onClick","disabled"],xs={key:0,class:"spinner"},bs={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Cs=["onClick"],Ss=["onClick"],Ms=["onClick","disabled"],Bs={key:0,class:"spinner small"},$s={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ts=["onClick","disabled"],Vs={key:0,class:"spinner"},Ps={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},js=["onClick"],Us=["onClick"],Os=["onClick","disabled"],Es={key:0,class:"spinner small"},Rs={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ds=["onClick"],zs={key:0,class:"test-drawer"},Is={class:"drawer-header"},Hs={class:"drawer-content"},As={class:"tools-section"},Ks={key:0,class:"loading-state"},Ls={key:1,class:"empty-state small"},Fs={key:2,class:"tools-list-panel"},Js=["onClick"],qs={class:"tool-name"},Ns={class:"tool-desc"},Ys={key:0,class:"call-section"},Gs={class:"form-fields"},Ws={key:0,class:"required"},Qs=["onUpdate:modelValue","placeholder"],Xs=["onUpdate:modelValue","placeholder"],Zs=["onUpdate:modelValue","placeholder"],to=["disabled"],eo={key:0,class:"spinner small"},so={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},oo={key:1,class:"result-section"},lo={key:0,class:"duration"},no={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ao={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ro={class:"result-json"},io={class:"form-section"},uo={class:"form-group"},co={class:"transport-selector"},vo={class:"form-group"},po={class:"form-group"},yo={class:"form-group"},ho={class:"form-group"},mo={class:"form-group"},fo={class:"form-group"},ko={class:"form-group"},go={class:"form-group"},wo={class:"json-editor-section"},_o={key:0,class:"error-text"},xo={class:"upload-section"},bo={class:"modal-footer"},Co=["disabled"],So={key:0,class:"btn-spinner"},Mo={key:0,class:"roots-drawer"},Bo={class:"drawer-header"},$o={class:"drawer-content"},To={class:"add-root-section"},Vo={class:"add-root-form"},Po={class:"form-row"},jo={class:"form-row"},Uo=["disabled"],Oo={key:0,class:"spinner small"},Eo={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ro={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Do={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},zo={class:"roots-list-section"},Io={class:"count"},Ho={key:0,class:"loading-state"},Ao={key:1,class:"empty-state small"},Ko={key:2,class:"roots-list"},Lo={class:"root-info"},Fo={class:"root-details"},Jo={class:"root-name"},qo={class:"root-path"},No={key:0,class:"root-type"},Yo=["onClick"],Go={__name:"MCPManager",setup(Wo){const K=p([]),L=p(!1),G=p("form"),F=p(null),et=p(!1),J=p(""),st=p(!1),q=p(null),ct=p({}),V=p(null),P=p(null),vt=p({}),ot=p(null),lt=p(null),m=p(null),R=p(!1),j=p([]),C=p(null),f=de({}),W=p(!1),w=p(null),pt=p(!1),U=p(null),N=p([]),yt=p(!1),nt=p(!1),$=p(""),Q=p(""),xt=p(!1),O=p(null),h=p({name:"",transport:"http",server_url:"",health_check_path:"/health",command:"npx",args:[],env:{},description:"",tools:[]}),D=p(""),z=p(""),I=p(""),X=p(""),jt=Bt(()=>K.value.filter(s=>s.is_preset)),bt=Bt(()=>K.value.filter(s=>!s.is_preset));ue(async()=>{await Promise.all([Ut(),Z(),ht(),M()])});const Ut=async()=>{try{K.value=await A.list()}catch(s){console.error("Failed to load MCP servers:",s),d.error("加载服务器列表失败")}},Z=async()=>{try{const s=await x.getStdioStatus();ct.value=s.servers||{}}catch(s){console.error("Failed to load stdio status:",s)}},ht=async()=>{try{const s=await x.getSseStatus();vt.value=s.servers||{}}catch(s){console.error("Failed to load SSE status:",s)}},M=async()=>{try{q.value=await ve.getContext()}catch(s){console.error("Failed to load MCP context:",s)}},at=s=>s.is_preset?s.name.toLowerCase().replace(/\s+/g,""):`custom_${s.id}`,T=s=>`custom_${s.id}`,rt=s=>{var a;if(s.transport!=="stdio")return!1;const t=s.name==="Context7"?"context7":s.name==="Everything Server"?"everything":s.name==="和风天气"?"hefeng":null;return t&&((a=ct.value[t])==null?void 0:a.running)||!1},it=s=>{var a;if(s.transport!=="stdio")return!1;const t=T(s);return((a=ct.value[t])==null?void 0:a.running)||!1},Ot=s=>rt(s)?"running":s.status==="enabled"?"success":s.status==="error"?"error":"warning",Et=s=>rt(s)?"运行中":{enabled:"已启用",disabled:"已禁用",error:"连接失败"}[s.status]||s.status,Rt=s=>(s.transport==="sse"||s.transport==="http")&&mt(s)||it(s)?"running":s.status==="enabled"?"success":s.status==="error"?"error":"warning",Dt=s=>{if(s.transport==="sse"||s.transport==="http"){if(mt(s))return"已连接";const a=`db_${s.id}`,r=vt.value[a];return(r==null?void 0:r.state)==="connecting"?"连接中":(r==null?void 0:r.state)==="reconnecting"?"重连中":(r==null?void 0:r.state)==="error"?r.error_message||"连接失败":"未连接"}return it(s)?"运行中":s.transport==="stdio"?{enabled:"已配置",disabled:"未启动",error:"启动失败"}[s.status]||s.status:{enabled:"已启用",disabled:"已禁用",error:"连接失败"}[s.status]||s.status},zt=s=>new Date(s).toLocaleString("zh-CN"),It=async s=>{try{const t=s.preset_key;if(!t){d.error("无法识别服务器标识");return}const a=s.status!=="enabled";await A.toggle(t,a),s.status=a?"enabled":"disabled",d.success(a?"已启用":"已禁用"),await M()}catch(t){console.error("Failed to toggle server:",t),d.error("切换状态失败")}},Ht=async s=>{var a,r;const t=s.name==="Context7"?"context7":s.name==="Everything Server"?"everything":"hefeng";V.value=t;try{const i=await x.startStdioServer(t);i.success?(d.success(`${s.name} 启动成功！`),await Promise.all([Z(),M()])):d.error("启动失败: "+(i.message||"未知错误"))}catch(i){const o=((r=(a=i.response)==null?void 0:a.data)==null?void 0:r.detail)||i.message;d.error("启动失败: "+o)}finally{V.value=null}},At=async s=>{var a;const t=s.name==="Context7"?"context7":s.name==="Everything Server"?"everything":"hefeng";P.value=t;try{(await x.stopStdioServer(t)).success&&(d.success("服务器已停止"),((a=m.value)==null?void 0:a.name)===s.name&&(m.value=null),await Promise.all([Z(),M()]))}catch(r){d.error("停止失败: "+r.message)}finally{P.value=null}},Kt=async s=>{var a,r;const t=T(s);V.value=t;try{const i=await x.startStdioServer(t);i.success?(d.success(`${s.name} 启动成功！`),await Promise.all([Z(),M()])):d.error("启动失败: "+(i.message||"未知错误"))}catch(i){const o=((r=(a=i.response)==null?void 0:a.data)==null?void 0:r.detail)||i.message;d.error("启动失败: "+o)}finally{V.value=null}},Lt=async s=>{var a;const t=T(s);P.value=t;try{(await x.stopStdioServer(t)).success&&(d.success("服务器已停止"),((a=m.value)==null?void 0:a.id)===s.id&&(m.value=null),await Promise.all([Z(),M()]))}catch(r){d.error("停止失败: "+r.message)}finally{P.value=null}},Ft=async s=>{m.value=s,C.value=null,w.value=null,Object.keys(f).forEach(t=>delete f[t]),R.value=!0;try{const t=T(s),a=await x.getStdioTools(t);j.value=a.tools||[]}catch(t){d.error("加载工具列表失败: "+t.message),j.value=[]}finally{R.value=!1}},Ct=async s=>{const t=d.loading("正在测试连接...",0);try{const a=await A.test(s.id||0);t(),a.connectivity?d.success("连接成功"):d.error("连接失败")}catch(a){t(),d.error("测试失败: "+a.message)}},mt=s=>{var a;if(s.transport!=="sse"&&s.transport!=="http")return!1;const t=`db_${s.id}`;return((a=vt.value[t])==null?void 0:a.state)==="connected"},Jt=async s=>{var a,r;const t=`db_${s.id}`;ot.value=t;try{const i=await x.connectSseServerFromDb(s.id);i.success?(d.success(`${s.name} 连接成功！`),await Promise.all([ht(),M()])):d.error("连接失败: "+(i.message||"未知错误"))}catch(i){const o=((r=(a=i.response)==null?void 0:a.data)==null?void 0:r.detail)||i.message;d.error("连接失败: "+o)}finally{ot.value=null}},qt=async s=>{var a;const t=`db_${s.id}`;lt.value=t;try{(await x.disconnectSseServer(t)).success&&(d.success("服务器已断开"),((a=m.value)==null?void 0:a.id)===s.id&&(m.value=null),await Promise.all([ht(),M()]))}catch(r){d.error("断开失败: "+r.message)}finally{lt.value=null}},Nt=async s=>{const t=`db_${s.id}`,a=d.loading("正在测试 SSE 连接...",0);try{const r=await x.testSseConnection(t);a(),r.success?d.success(`连接正常，延迟 ${r.latency_ms}ms`):d.error("连接异常: "+r.message)}catch(r){a(),d.error("测试失败: "+r.message)}},Yt=async s=>{m.value=s,C.value=null,w.value=null,Object.keys(f).forEach(t=>delete f[t]),R.value=!0;try{const t=`db_${s.id}`,a=await x.getSseTools(t);j.value=a.tools||[]}catch(t){d.error("加载工具列表失败: "+t.message),j.value=[]}finally{R.value=!1}},Gt=async s=>{m.value=s,C.value=null,w.value=null,Object.keys(f).forEach(t=>delete f[t]),R.value=!0;try{const t=s.name==="Context7"?"context7":s.name==="Everything Server"?"everything":"hefeng",a=await x.getStdioTools(t);j.value=a.tools||[]}catch(t){d.error("加载工具列表失败: "+t.message),j.value=[]}finally{R.value=!1}},Wt=s=>{var a;C.value=s,w.value=null,Object.keys(f).forEach(r=>delete f[r]);const t=((a=s.inputSchema)==null?void 0:a.properties)||{};Object.entries(t).forEach(([r,i])=>{i.default!==void 0&&(f[r]=i.default)})},Qt=async()=>{if(!(!C.value||!m.value)){W.value=!0,w.value=null;try{let s,t;if(m.value.is_preset)s=m.value.name==="Context7"?"context7":m.value.name==="Everything Server"?"everything":"hefeng",t=await x.callStdioTool(s,C.value.name,{...f});else{const a=m.value.transport;if(s=T(m.value),a==="sse"||a==="http"){const r=`db_${m.value.id}`;t=await x.callSseTool(r,C.value.name,{...f})}else t=await x.callStdioTool(s,C.value.name,{...f})}w.value=t,t.success?d.success("工具执行成功"):d.error("工具执行失败: "+(t.error||"未知错误"))}catch(s){w.value={success:!1,error:s.message},d.error("调用失败: "+s.message)}finally{W.value=!1}}},Xt=s=>{try{return JSON.stringify(s,null,2)}catch{return String(s)}},Zt=async()=>{var s;if(!((s=q.value)!=null&&s.system_prompt_snippet)){d.warning("暂无内容可复制");return}try{await navigator.clipboard.writeText(q.value.system_prompt_snippet),d.success("已复制到剪贴板")}catch{d.error("复制失败")}},te=s=>{var a;F.value=s;const t=s.transport||"http";h.value={name:s.name,transport:t,server_url:s.server_url||"",health_check_path:s.health_check_path||"/health",command:s.command||"npx",args:s.args||[],env:s.env||{},description:s.description||"",tools:s.tools||[]},I.value=((a=s.tools)==null?void 0:a.join(", "))||"",D.value=(s.args||[]).join(" "),z.value=Object.entries(s.env||{}).map(([r,i])=>`${r}=${i}`).join(`
`),L.value=!0},ee=s=>{Vt.confirm({title:"删除服务器",icon:B(Pt),content:`确定要删除「${s.name}」吗？`,okText:"删除",okType:"danger",cancelText:"取消",async onOk(){try{await A.delete(s.id),K.value=K.value.filter(t=>t.id!==s.id),d.success("删除成功"),await M()}catch(t){d.error("删除失败: "+t.message)}}})},se=async s=>{const t=s.target.files[0];t&&await St(t)},oe=async s=>{const t=s.dataTransfer.files[0];t&&await St(t)},St=async s=>{var a;if(!s.name.endsWith(".json")){d.error("仅支持 .json 文件");return}if(s.size>1024*1024){d.error("文件大小不能超过 1MB");return}const t=await s.text();try{const r=JSON.parse(t);h.value={name:r.name||"",server_url:r.server_url||"",health_check_path:r.health_check_path||"/health",description:r.description||"",tools:r.tools||[]},I.value=((a=r.tools)==null?void 0:a.join(", "))||"",X.value=t,G.value="form",J.value="",d.success("文件解析成功")}catch{d.error("无效的 JSON 格式")}},ft=()=>{L.value=!1,F.value=null,h.value={name:"",transport:"http",server_url:"",health_check_path:"/health",command:"npx",args:[],env:{},description:"",tools:[]},D.value="",z.value="",I.value="",X.value="",J.value="",G.value="form"},le=async()=>{var s,t,a,r;if(G.value==="json")try{const i=JSON.parse(X.value);h.value={name:i.name||"",transport:i.transport||"http",server_url:i.server_url||"",health_check_path:i.health_check_path||"/health",command:i.command||"npx",args:i.args||[],env:i.env||{},description:i.description||"",tools:i.tools||[]},D.value=(i.args||[]).join(" "),z.value=Object.entries(i.env||{}).map(([o,u])=>`${o}=${u}`).join(`
`)}catch{J.value="无效的 JSON 格式";return}if(I.value&&(h.value.tools=I.value.split(",").map(i=>i.trim()).filter(Boolean)),h.value.transport==="stdio"){D.value.trim()?h.value.args=D.value.trim().split(/\s+/):h.value.args=[];const i={};z.value.trim()&&z.value.split(`
`).forEach(o=>{const u=o.trim();if(u&&u.includes("=")){const c=u.indexOf("="),Y=u.substring(0,c).trim(),dt=u.substring(c+1).trim();Y&&(i[Y]=dt)}}),h.value.env=i}if(!h.value.name){d.warning("请填写服务器名称");return}if(h.value.transport==="http"&&!h.value.server_url){d.warning("HTTP 类型需要填写服务器 URL");return}if(h.value.transport==="stdio"&&!h.value.command){d.warning("STDIO 类型需要填写启动命令");return}et.value=!0;try{const i={...h.value};i.transport==="http"?(delete i.command,delete i.args,delete i.env):(delete i.server_url,delete i.health_check_path),F.value?await A.update(F.value.id,i):(await A.addConfig(i)).transport==="stdio"&&d.success("STDIO 服务器已添加，可在列表中启动"),K.value=await A.list(),ft(),d.success("保存成功"),await M()}catch(i){d.error("保存失败: "+(((t=(s=i.response)==null?void 0:s.data)==null?void 0:t.detail)||((r=(a=i.response)==null?void 0:a.data)==null?void 0:r.message)||i.message))}finally{et.value=!1}},Mt=async s=>{let t;if(s.is_preset?t=s.name==="Context7"?"context7":s.name==="Everything Server"?"everything":s.name==="和风天气"?"hefeng":null:t=`custom_${s.id}`,!t){d.error("无法识别服务器");return}U.value={...s,serverKey:t},pt.value=!0,await kt(t)},kt=async s=>{yt.value=!0;try{const t=await ut.getServerRoots(s);N.value=t.roots||[]}catch(t){console.error("加载根目录失败:",t),N.value=[]}finally{yt.value=!1}},ne=async()=>{var s,t;if(!$.value.trim()){d.warning("请输入路径");return}nt.value=!0;try{await ut.addServerRoot(U.value.serverKey,$.value.trim(),Q.value.trim()||null),d.success("根目录添加成功"),$.value="",Q.value="",await kt(U.value.serverKey)}catch(a){d.error("添加失败: "+(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.detail)||a.message))}finally{nt.value=!1}},ae=async s=>{Vt.confirm({title:"移除根目录",icon:B(Pt),content:`确定要移除「${s.name||s.path}」吗？`,okText:"移除",okType:"danger",cancelText:"取消",async onOk(){try{await ut.removeServerRoot(U.value.serverKey,s.path),d.success("根目录已移除"),await kt(U.value.serverKey)}catch(t){d.error("移除失败: "+t.message)}}})},re=async()=>{if(!$.value.trim()){O.value=null;return}xt.value=!0;try{const s=await ut.validatePath(U.value.serverKey,$.value.trim());O.value=s}catch{O.value=null}finally{xt.value=!1}},ie=()=>{pt.value=!1,U.value=null,N.value=[],$.value="",Q.value="",O.value=null};return(s,t)=>{const a=_t("a-tab-pane"),r=_t("a-tabs"),i=_t("a-modal");return n(),l("div",pe,[e("header",ye,[e("div",he,[t[21]||(t[21]=gt('<div class="title-group" data-v-a08df841><h1 data-v-a08df841><span class="icon-wrapper" data-v-a08df841><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-a08df841><path d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01" data-v-a08df841></path></svg></span> MCP 服务器管理 </h1><p class="subtitle" data-v-a08df841>管理 Model Context Protocol 服务器，扩展 AI 模型能力</p></div>',1)),e("div",me,[e("button",{class:"context-btn",onClick:t[0]||(t[0]=o=>st.value=!st.value)},[t[20]||(t[20]=gt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-a08df841><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-a08df841></path><polyline points="14 2 14 8 20 8" data-v-a08df841></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-a08df841></line><line x1="16" y1="17" x2="8" y2="17" data-v-a08df841></line></svg>',1)),y(" "+v(st.value?"隐藏":"查看")+" MCP 上下文 ",1)])])])]),B(wt,{name:"slide"},{default:E(()=>{var o,u,c;return[st.value?(n(),l("div",fe,[e("div",ke,[t[24]||(t[24]=e("h3",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 16v-4M12 8h.01"})]),y(" MCP 上下文信息 ")],-1)),e("div",ge,[e("span",we,[e("strong",null,v(((o=q.value)==null?void 0:o.total_enabled_servers)||0),1),t[22]||(t[22]=y(" 个已启用服务器 ",-1))]),e("span",_e,[e("strong",null,v(((u=q.value)==null?void 0:u.total_available_tools)||0),1),t[23]||(t[23]=y(" 个可用工具 ",-1))])])]),e("div",xe,[e("div",be,[t[26]||(t[26]=e("h4",null,"系统提示词片段",-1)),t[27]||(t[27]=e("p",{class:"hint"},"此内容会自动注入到 AI 的系统提示词中，让 AI 知道有哪些 MCP 工具可用",-1)),e("div",Ce,[e("pre",null,v(((c=q.value)==null?void 0:c.system_prompt_snippet)||"暂无已启用的 MCP 服务器"),1)]),e("button",{class:"copy-btn",onClick:Zt},[...t[25]||(t[25]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})],-1),y(" 复制 ",-1)])])])])])):k("",!0)]}),_:1}),e("div",Se,[e("section",Me,[t[38]||(t[38]=e("div",{class:"section-header"},[e("h2",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M12 1v6m0 6v10M4.22 4.22l4.24 4.24m7.08 7.08l4.24 4.24M1 12h6m6 0h10M4.22 19.78l4.24-4.24m7.08-7.08l4.24-4.24"})]),y(" 预置服务器 ")])],-1)),e("div",Be,[(n(!0),l(_,null,H(jt.value,o=>(n(),l("article",{key:o.name,class:S(["server-card",{running:rt(o)}])},[e("div",$e,[e("div",Te,[t[28]||(t[28]=e("div",{class:"server-icon preset"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2"}),e("path",{d:"M8 21h8M12 17v4"})])],-1)),e("div",Ve,[e("h3",null,v(o.name),1),e("span",Pe,v(o.transport==="stdio"?"STDIO":"HTTP"),1)])]),e("label",je,[e("input",{type:"checkbox",checked:o.status==="enabled"||o.status==="running",onChange:u=>It(o)},null,40,Ue),t[29]||(t[29]=e("span",{class:"toggle-slider"},null,-1))])]),e("div",Oe,[e("p",Ee,v(o.description),1),e("div",Re,[t[30]||(t[30]=e("span",{class:"tools-label"},"工具:",-1)),e("div",De,[(n(!0),l(_,null,H(o.tools.slice(0,4),u=>(n(),l("span",{key:u,class:"tool-tag"},v(u),1))),128)),o.tools.length>4?(n(),l("span",ze," +"+v(o.tools.length-4),1)):k("",!0)])])]),e("div",Ie,[e("div",He,[e("span",{class:S(["status-badge",Ot(o)])},[t[31]||(t[31]=e("span",{class:"status-dot"},null,-1)),y(" "+v(Et(o)),1)],2)]),e("div",Ae,[o.transport==="stdio"?(n(),l(_,{key:0},[rt(o)?(n(),l(_,{key:1},[e("button",{class:"action-btn secondary",onClick:u=>Mt(o),title:"工作区目录"},[...t[34]||(t[34]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})],-1)])],8,Je),e("button",{class:"action-btn test",onClick:u=>Gt(o)},[...t[35]||(t[35]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})],-1),y(" 测试 ",-1)])],8,qe),e("button",{class:"action-btn stop",onClick:u=>At(o),disabled:P.value===at(o)},[P.value===at(o)?(n(),l("span",Ye)):(n(),l("svg",Ge,[...t[36]||(t[36]=[e("rect",{x:"6",y:"6",width:"12",height:"12"},null,-1)])]))],8,Ne)],64)):(n(),l("button",{key:0,class:"action-btn start",onClick:u=>Ht(o),disabled:V.value===at(o)},[V.value===at(o)?(n(),l("span",Le)):(n(),l("svg",Fe,[...t[32]||(t[32]=[e("polygon",{points:"5 3 19 12 5 21 5 3"},null,-1)])])),t[33]||(t[33]=y(" 启动 ",-1))],8,Ke))],64)):(n(),l("button",{key:1,class:"action-btn test",onClick:u=>Ct(o)},[...t[37]||(t[37]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),y(" 测试 ",-1)])],8,We))])])],2))),128))])]),e("section",Qe,[e("div",Xe,[t[40]||(t[40]=e("h2",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})]),y(" 自定义服务器 ")],-1)),e("button",{class:"add-server-btn",onClick:t[1]||(t[1]=o=>L.value=!0)},[...t[39]||(t[39]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[e("path",{d:"M12 4v16m-8-8h16"})],-1),y(" 添加服务器 ",-1)])])]),bt.value.length===0?(n(),l("div",Ze,[t[42]||(t[42]=gt('<div class="empty-illustration" data-v-a08df841><svg viewBox="0 0 200 200" fill="none" data-v-a08df841><circle cx="100" cy="100" r="80" fill="#f1f5f9" data-v-a08df841></circle><rect x="65" y="60" width="70" height="50" rx="4" fill="#e2e8f0" data-v-a08df841></rect><circle cx="80" cy="75" r="4" fill="#cbd5e1" data-v-a08df841></circle><circle cx="95" cy="75" r="4" fill="#cbd5e1" data-v-a08df841></circle><rect x="65" y="120" width="70" height="30" rx="4" fill="#e2e8f0" data-v-a08df841></rect><circle cx="80" cy="135" r="4" fill="#cbd5e1" data-v-a08df841></circle><circle cx="95" cy="135" r="4" fill="#cbd5e1" data-v-a08df841></circle><circle cx="100" cy="100" r="15" fill="#6366f1" opacity="0.2" data-v-a08df841></circle><path d="M95 100h10M100 95v10" stroke="#6366f1" stroke-width="2" stroke-linecap="round" data-v-a08df841></path></svg></div><h3 data-v-a08df841>暂无自定义服务器</h3><p data-v-a08df841>添加您自己的 MCP 服务器来扩展 AI 能力</p>',3)),e("button",{class:"add-btn-primary",onClick:t[2]||(t[2]=o=>L.value=!0)},[...t[41]||(t[41]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[e("path",{d:"M12 4v16m-8-8h16"})],-1),y(" 添加服务器 ",-1)])])])):(n(),l("div",ts,[(n(!0),l(_,null,H(bt.value,o=>{var u;return n(),l("article",{key:o.id,class:S(["server-card custom",{running:it(o)}])},[e("div",es,[e("div",ss,[e("div",{class:S(["server-icon",o.transport==="stdio"?"stdio":"custom"])},[o.transport==="stdio"?(n(),l("svg",os,[...t[43]||(t[43]=[e("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2"},null,-1),e("path",{d:"M8 21h8M12 17v4"},null,-1),e("path",{d:"M7 8l3 3-3 3M12 14h5"},null,-1)])])):(n(),l("svg",ls,[...t[44]||(t[44]=[e("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"},null,-1)])]))],2),e("div",ns,[e("h3",null,v(o.name),1),o.transport==="stdio"?(n(),l("span",as,"STDIO")):(n(),l("span",rs,v(o.server_url),1))])]),e("div",is,[e("button",{class:"icon-btn",onClick:c=>te(o),title:"编辑"},[...t[45]||(t[45]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,ds),e("button",{class:"icon-btn danger",onClick:c=>ee(o),title:"删除"},[...t[46]||(t[46]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})],-1)])],8,us)])]),e("div",cs,[o.description?(n(),l("p",vs,v(o.description),1)):k("",!0),o.transport==="stdio"?(n(),l("div",ps,[t[47]||(t[47]=e("span",{class:"command-label"},"命令:",-1)),e("code",null,v(o.command)+" "+v((o.args||[]).join(" ")),1)])):k("",!0),(u=o.tools)!=null&&u.length?(n(),l("div",ys,[t[48]||(t[48]=e("span",{class:"tools-label"},"工具:",-1)),e("div",hs,[(n(!0),l(_,null,H(o.tools.slice(0,4),c=>(n(),l("span",{key:c,class:"tool-tag"},v(c),1))),128)),o.tools.length>4?(n(),l("span",ms," +"+v(o.tools.length-4),1)):k("",!0)])])):k("",!0)]),e("div",fs,[e("div",ks,[e("span",{class:S(["status-badge",Rt(o)])},[t[49]||(t[49]=e("span",{class:"status-dot"},null,-1)),y(" "+v(Dt(o)),1)],2),o.last_check?(n(),l("span",gs,[t[50]||(t[50]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 6v6l4 2"})],-1)),y(" "+v(zt(o.last_check)),1)])):k("",!0)]),e("div",ws,[o.transport==="stdio"?(n(),l(_,{key:0},[it(o)?(n(),l(_,{key:1},[e("button",{class:"action-btn secondary",onClick:c=>Mt(o),title:"工作区目录"},[...t[53]||(t[53]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})],-1)])],8,Cs),e("button",{class:"action-btn test",onClick:c=>Ft(o)},[...t[54]||(t[54]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})],-1),y(" 测试 ",-1)])],8,Ss),e("button",{class:"action-btn stop",onClick:c=>Lt(o),disabled:P.value===T(o)},[P.value===T(o)?(n(),l("span",Bs)):(n(),l("svg",$s,[...t[55]||(t[55]=[e("rect",{x:"6",y:"6",width:"12",height:"12"},null,-1)])]))],8,Ms)],64)):(n(),l("button",{key:0,class:"action-btn start",onClick:c=>Kt(o),disabled:V.value===T(o)},[V.value===T(o)?(n(),l("span",xs)):(n(),l("svg",bs,[...t[51]||(t[51]=[e("polygon",{points:"5 3 19 12 5 21 5 3"},null,-1)])])),t[52]||(t[52]=y(" 启动 ",-1))],8,_s))],64)):o.transport==="sse"||o.transport==="http"?(n(),l(_,{key:1},[mt(o)?(n(),l(_,{key:1},[e("button",{class:"action-btn test",onClick:c=>Yt(o)},[...t[58]||(t[58]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})],-1),y(" 测试 ",-1)])],8,js),e("button",{class:"action-btn secondary",onClick:c=>Nt(o)},[...t[59]||(t[59]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 6v6l4 2"})],-1)])],8,Us),e("button",{class:"action-btn stop",onClick:c=>qt(o),disabled:lt.value===`db_${o.id}`},[lt.value===`db_${o.id}`?(n(),l("span",Es)):(n(),l("svg",Rs,[...t[60]||(t[60]=[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"},null,-1)])]))],8,Os)],64)):(n(),l("button",{key:0,class:"action-btn start",onClick:c=>Jt(o),disabled:ot.value===`db_${o.id}`},[ot.value===`db_${o.id}`?(n(),l("span",Vs)):(n(),l("svg",Ps,[...t[56]||(t[56]=[e("path",{d:"M5 12h14M12 5l7 7-7 7"},null,-1)])])),t[57]||(t[57]=y(" 连接 ",-1))],8,Ts))],64)):(n(),l("button",{key:2,class:"action-btn test",onClick:c=>Ct(o)},[...t[61]||(t[61]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),y(" 测试 ",-1)])],8,Ds))])])],2)}),128))]))])]),B(wt,{name:"drawer"},{default:E(()=>{var o;return[m.value?(n(),l("div",zs,[e("div",Is,[e("h3",null,[t[62]||(t[62]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})],-1)),y(" "+v(m.value.name)+" 工具测试 ",1)]),e("button",{class:"close-btn",onClick:t[3]||(t[3]=u=>m.value=null)},[...t[63]||(t[63]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),e("div",Hs,[e("div",As,[t[66]||(t[66]=e("h4",null,"可用工具",-1)),R.value?(n(),l("div",Ks,[...t[64]||(t[64]=[e("div",{class:"loader"},null,-1),e("span",null,"加载工具列表...",-1)])])):j.value.length===0?(n(),l("div",Ls,[...t[65]||(t[65]=[e("p",null,"暂无可用工具",-1)])])):(n(),l("div",Fs,[(n(!0),l(_,null,H(j.value,u=>{var c;return n(),l("div",{key:u.name,class:S(["tool-item",{selected:((c=C.value)==null?void 0:c.name)===u.name}]),onClick:Y=>Wt(u)},[e("div",qs,v(u.name),1),e("div",Ns,v(u.description||"无描述"),1)],10,Js)}),128))]))]),C.value?(n(),l("div",Ys,[e("h4",null,"调用 "+v(C.value.name),1),e("div",Gs,[(n(!0),l(_,null,H(((o=C.value.inputSchema)==null?void 0:o.properties)||{},(u,c)=>{var Y,dt;return n(),l("div",{key:c,class:"form-field"},[e("label",null,[y(v(c)+" ",1),(dt=(Y=C.value.inputSchema)==null?void 0:Y.required)!=null&&dt.includes(c)?(n(),l("span",Ws,"*")):k("",!0)]),u.type==="string"?g((n(),l("input",{key:0,"onUpdate:modelValue":tt=>f[c]=tt,type:"text",placeholder:u.description||`输入 ${c}`},null,8,Qs)),[[b,f[c]]]):u.type==="integer"||u.type==="number"?g((n(),l("input",{key:1,"onUpdate:modelValue":tt=>f[c]=tt,type:"number",placeholder:u.description||`输入 ${c}`},null,8,Xs)),[[b,f[c],void 0,{number:!0}]]):g((n(),l("textarea",{key:2,"onUpdate:modelValue":tt=>f[c]=tt,placeholder:u.description||`输入 ${c}`,rows:"2"},null,8,Zs)),[[b,f[c]]])])}),128))]),e("button",{class:"call-btn",onClick:Qt,disabled:W.value},[W.value?(n(),l("span",eo)):(n(),l("svg",so,[...t[67]||(t[67]=[e("polygon",{points:"5 3 19 12 5 21 5 3"},null,-1)])])),y(" "+v(W.value?"执行中...":"执行工具"),1)],8,to)])):k("",!0),w.value?(n(),l("div",oo,[e("h4",null,[t[68]||(t[68]=y(" 执行结果 ",-1)),w.value.duration_ms?(n(),l("span",lo,v(w.value.duration_ms)+"ms",1)):k("",!0)]),e("div",{class:S(["result-status",w.value.success?"success":"error"])},[w.value.success?(n(),l("svg",no,[...t[69]||(t[69]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(n(),l("svg",ao,[...t[70]||(t[70]=[e("circle",{cx:"12",cy:"12",r:"10"},null,-1),e("line",{x1:"15",y1:"9",x2:"9",y2:"15"},null,-1),e("line",{x1:"9",y1:"9",x2:"15",y2:"15"},null,-1)])])),y(" "+v(w.value.success?"执行成功":"执行失败"),1)],2),e("pre",ro,v(Xt(w.value.data||w.value.error)),1)])):k("",!0)])])):k("",!0)]}),_:1}),B(i,{open:L.value,"onUpdate:open":t[17]||(t[17]=o=>L.value=o),title:F.value?"编辑服务器":"添加 MCP 服务器",width:"640px",footer:null,onCancel:ft,class:"server-modal"},{default:E(()=>[B(r,{activeKey:G.value,"onUpdate:activeKey":t[16]||(t[16]=o=>G.value=o),class:"modal-tabs"},{default:E(()=>[B(a,{key:"form",tab:"表单配置"},{default:E(()=>[e("div",io,[e("div",uo,[t[73]||(t[73]=e("label",null,[y("传输类型 "),e("span",{class:"required"},"*")],-1)),e("div",co,[e("label",{class:S(["transport-option",{active:h.value.transport==="http"}])},[g(e("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=o=>h.value.transport=o),value:"http"},null,512),[[$t,h.value.transport]]),t[71]||(t[71]=e("div",{class:"option-content"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),e("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]),e("span",null,"HTTP/SSE"),e("small",null,"远程服务器")],-1))],2),e("label",{class:S(["transport-option",{active:h.value.transport==="stdio"}])},[g(e("input",{type:"radio","onUpdate:modelValue":t[5]||(t[5]=o=>h.value.transport=o),value:"stdio"},null,512),[[$t,h.value.transport]]),t[72]||(t[72]=e("div",{class:"option-content"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2"}),e("path",{d:"M8 21h8M12 17v4"}),e("path",{d:"M7 8l3 3-3 3M12 14h5"})]),e("span",null,"STDIO"),e("small",null,"本地进程")],-1))],2)])]),e("div",vo,[t[74]||(t[74]=e("label",null,[y("服务器名称 "),e("span",{class:"required"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>h.value.name=o),type:"text",class:"form-input",placeholder:"My MCP Server"},null,512),[[b,h.value.name]])]),h.value.transport==="http"?(n(),l(_,{key:0},[e("div",po,[t[75]||(t[75]=e("label",null,[y("服务器 URL "),e("span",{class:"required"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>h.value.server_url=o),type:"text",class:"form-input",placeholder:"https://mcp.example.com"},null,512),[[b,h.value.server_url]])]),e("div",yo,[t[76]||(t[76]=e("label",null,"健康检查路径",-1)),g(e("input",{"onUpdate:modelValue":t[8]||(t[8]=o=>h.value.health_check_path=o),type:"text",class:"form-input",placeholder:"/health"},null,512),[[b,h.value.health_check_path]])])],64)):(n(),l(_,{key:1},[e("div",ho,[t[77]||(t[77]=e("label",null,[y("启动命令 "),e("span",{class:"required"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>h.value.command=o),type:"text",class:"form-input",placeholder:"npx"},null,512),[[b,h.value.command]]),t[78]||(t[78]=e("p",{class:"form-hint"},"常用命令：npx, node, python, uvx",-1))]),e("div",mo,[t[79]||(t[79]=e("label",null,"命令参数",-1)),g(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>D.value=o),type:"text",class:"form-input",placeholder:"-y wttr-mcp-server@latest"},null,512),[[b,D.value]]),t[80]||(t[80]=e("p",{class:"form-hint"},"空格分隔，例如：-y wttr-mcp-server@latest",-1))]),e("div",fo,[t[81]||(t[81]=e("label",null,"环境变量",-1)),g(e("textarea",{"onUpdate:modelValue":t[11]||(t[11]=o=>z.value=o),class:"form-textarea",rows:"3",placeholder:`API_KEY=your_key
OTHER_VAR=value`},null,512),[[b,z.value]]),t[82]||(t[82]=e("p",{class:"form-hint"},"每行一个，格式：KEY=VALUE",-1))])],64)),e("div",ko,[t[83]||(t[83]=e("label",null,"工具列表 (逗号分隔)",-1)),g(e("input",{"onUpdate:modelValue":t[12]||(t[12]=o=>I.value=o),type:"text",class:"form-input",placeholder:"search, retrieve, store"},null,512),[[b,I.value]]),t[84]||(t[84]=e("p",{class:"form-hint"},"可选，服务器启动后会自动获取",-1))]),e("div",go,[t[85]||(t[85]=e("label",null,"描述",-1)),g(e("textarea",{"onUpdate:modelValue":t[13]||(t[13]=o=>h.value.description=o),class:"form-textarea",rows:"3",placeholder:"服务器描述..."},null,512),[[b,h.value.description]])])])]),_:1}),B(a,{key:"json",tab:"JSON 编辑"},{default:E(()=>[e("div",wo,[g(e("textarea",{"onUpdate:modelValue":t[14]||(t[14]=o=>X.value=o),class:S(["json-editor",{error:J.value}]),rows:"15",placeholder:'{"name": "...", "server_url": "...", "tools": [...]}'},null,2),[[b,X.value]]),J.value?(n(),l("p",_o,v(J.value),1)):k("",!0)])]),_:1}),B(a,{key:"upload",tab:"文件上传"},{default:E(()=>[e("div",xo,[e("label",{class:"upload-area",onDragover:t[15]||(t[15]=Tt(()=>{},["prevent"])),onDrop:Tt(oe,["prevent"])},[e("input",{type:"file",accept:".json",onChange:se,hidden:""},null,32),t[86]||(t[86]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),t[87]||(t[87]=e("p",{class:"upload-title"},"点击或拖拽文件到此区域上传",-1)),t[88]||(t[88]=e("p",{class:"upload-hint"},"支持 .json 格式，最大 1MB",-1))],32)])]),_:1})]),_:1},8,["activeKey"]),e("div",bo,[e("button",{class:"modal-btn secondary",onClick:ft},"取消"),e("button",{class:"modal-btn primary",onClick:le,disabled:et.value},[et.value?(n(),l("span",So)):k("",!0),y(" "+v(F.value?"保存":"添加"),1)],8,Co)])]),_:1},8,["open","title"]),B(wt,{name:"drawer"},{default:E(()=>{var o;return[pt.value?(n(),l("div",Mo,[e("div",Bo,[e("h3",null,[t[89]||(t[89]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})],-1)),y(" "+v((o=U.value)==null?void 0:o.name)+" - 工作区目录 ",1)]),e("button",{class:"close-btn",onClick:ie},[...t[90]||(t[90]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),e("div",$o,[t[101]||(t[101]=e("div",{class:"roots-info"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 16v-4M12 8h.01"})]),e("p",null,"工作区目录定义了 MCP 服务器可以访问的文件系统范围。配置后，工具调用中的文件路径将被限制在这些目录内。")],-1)),e("div",To,[t[95]||(t[95]=e("h4",null,"添加根目录",-1)),e("div",Vo,[e("div",Po,[g(e("input",{"onUpdate:modelValue":t[18]||(t[18]=u=>$.value=u),type:"text",class:"form-input",placeholder:"输入目录路径，如 /Users/project",onBlur:re},null,544),[[b,$.value]])]),e("div",jo,[g(e("input",{"onUpdate:modelValue":t[19]||(t[19]=u=>Q.value=u),type:"text",class:"form-input small",placeholder:"名称（可选）"},null,512),[[b,Q.value]]),e("button",{class:"add-root-btn",onClick:ne,disabled:nt.value||!$.value.trim()},[nt.value?(n(),l("span",Oo)):(n(),l("svg",Eo,[...t[91]||(t[91]=[e("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),e("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])])),t[92]||(t[92]=y(" 添加 ",-1))],8,Uo)]),O.value?(n(),l("div",{key:0,class:S(["validation-result",O.value.allowed?"success":"warning"])},[O.value.allowed?(n(),l("svg",Ro,[...t[93]||(t[93]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(n(),l("svg",Do,[...t[94]||(t[94]=[e("circle",{cx:"12",cy:"12",r:"10"},null,-1),e("line",{x1:"12",y1:"8",x2:"12",y2:"12"},null,-1),e("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"},null,-1)])])),e("span",null,v(O.value.message),1)],2)):k("",!0)])]),e("div",zo,[e("h4",null,[t[96]||(t[96]=y(" 已配置的根目录 ",-1)),e("span",Io,v(N.value.length),1)]),yt.value?(n(),l("div",Ho,[...t[97]||(t[97]=[e("div",{class:"loader"},null,-1),e("span",null,"加载中...",-1)])])):N.value.length===0?(n(),l("div",Ao,[...t[98]||(t[98]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}),e("line",{x1:"12",y1:"11",x2:"12",y2:"17"}),e("line",{x1:"9",y1:"14",x2:"15",y2:"14"})],-1),e("p",null,"暂无根目录配置",-1),e("small",null,"添加根目录后，工具调用将限制在这些目录范围内",-1)])])):(n(),l("div",Ko,[(n(!0),l(_,null,H(N.value,u=>(n(),l("div",{key:u.uri,class:"root-item"},[e("div",Lo,[t[99]||(t[99]=e("div",{class:"root-icon"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})])],-1)),e("div",Fo,[e("div",Jo,v(u.name||"未命名"),1),e("div",qo,v(u.path),1),u.type&&u.type!=="custom"?(n(),l("div",No,v(u.type),1)):k("",!0)])]),e("button",{class:"remove-root-btn",onClick:c=>ae(u),title:"移除"},[...t[100]||(t[100]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})],-1)])],8,Yo)]))),128))]))])])])):k("",!0)]}),_:1})])}}},Zo=ce(Go,[["__scopeId","data-v-a08df841"]]);export{Zo as default};
