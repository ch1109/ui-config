import{q as ye,r as h,c as ne,o as oe,s as ke,b as r,j as d,F as Z,d as e,k as _,p as ue,t as U,f as ee,m as W,x as we,y as ae,i as G,v as K,l as x,h as Y,e as H,g as ve,z as Ce,A as $e,a as V,u as xe,B as Me,C as Ae,D as ce,w as se,M as fe,E as Ie}from"./index-BfuFjEVY.js";import{_ as le,p as X,c as De}from"./_plugin-vue_export-helper-CLyVweMD.js";function ge(u,M){if(!M)return u;let l=u||"";const{behavior_rules:v,page_goal:c}=M;return v&&!l.includes("## è¡Œä¸ºè§„åˆ™")&&(l+=`

## è¡Œä¸ºè§„åˆ™
${v}`),c&&!l.includes("## é¡µé¢ç›®æ ‡")&&(l+=`

## é¡µé¢ç›®æ ‡
${c}`),l.trim()}function me(u,M){if(!M)return u;let l=u||"";const{behavior_rules:v,page_goal:c}=M;return v&&!l.includes("## Behavior Rules")&&(l+=`

## Behavior Rules
${v}`),c&&!l.includes("## Page Goal")&&(l+=`

## Page Goal
${c}`),l.trim()}const Ve=ye("uiConfig",()=>{const u=h({page_id:"",name:{"zh-CN":"",en:""},description:{"zh-CN":"",en:""},button_list:[],optional_actions:[]}),M=h(null),l=h(!1),v=h(null),c=h(null),n=ne(()=>l.value);function A(t){Object.assign(u.value,t),l.value=!0}function m(t){return l.value?{conflict:!0}:(C(t),{conflict:!1})}function z(t){C(t),l.value=!1}function C(t){if(t.page_id&&(u.value.page_id=t.page_id),t.page_name&&(u.value.name={"zh-CN":t.page_name["zh-CN"]||"",en:t.page_name.en||""}),t.page_description){let f=t.page_description["zh-CN"]||"",$=t.page_description.en||"";t.ai_context&&(f=ge(f,t.ai_context),$=me($,t.ai_context)),u.value.description={"zh-CN":f,en:$}}t.button_list&&(u.value.button_list=t.button_list),t.optional_actions&&(u.value.optional_actions=t.optional_actions)}function B(){}function D(){u.value={page_id:"",name:{"zh-CN":"",en:""},description:{"zh-CN":"",en:""},button_list:[],optional_actions:[]},M.value=null,l.value=!1,v.value=null}function I(t){const f={...t};t.ai_context&&t.description&&(f.description={"zh-CN":ge(t.description["zh-CN"]||"",t.ai_context),en:me(t.description.en||"",t.ai_context)}),delete f.ai_context,M.value=JSON.parse(JSON.stringify(f)),u.value=JSON.parse(JSON.stringify(f)),l.value=!1}function s(t){v.value=t}function p(t,f="success",$=3e3){c.value={message:t,type:f},setTimeout(()=>{c.value=null},$)}return{draftConfig:u,originalConfig:M,isDirty:l,currentSession:v,toast:c,hasChanges:n,applyUserEdit:A,tryApplyAiUpdate:m,forceApplyAiUpdate:z,keepUserEdit:B,resetConfig:D,setOriginalConfig:I,setCurrentSession:s,showToast:p}}),Be=["src"],Ee={class:"overlay"},Ue={class:"btn-action"},Ne=["disabled"],ze={key:1,class:"upload-progress"},Le={class:"progress-ring"},Se={viewBox:"0 0 100 100"},Re=["stroke-dasharray"],Pe={class:"percent"},Oe={key:2,class:"upload-placeholder-wrapper"},Te={class:"upload-placeholder"},je=["disabled"],He={__name:"ImageUploader",props:{modelValue:String,disabled:Boolean},emits:["update:modelValue","upload-success","upload-error"],setup(u,{emit:M}){const l=u,v=M,c=h(!1),n=h(!1),A=h(0),m=()=>{l.disabled||(c.value=!0)},z=()=>{c.value=!1},C=p=>{if(c.value=!1,l.disabled||n.value)return;const t=p.dataTransfer.files;t.length>0&&D(t[0])},B=async p=>{const t=p.target,f=t.files;try{f&&f.length>0&&await D(f[0])}finally{t.value=""}},D=async p=>{var $,N,S;if(!p)return;if(!["image/png","image/jpeg","image/jpg"].includes(p.type)){v("upload-error",{code:"INVALID_FILE_TYPE",message:"ä»…æ”¯æŒ PNGã€JPG æ ¼å¼çš„å›¾ç‰‡"});return}const f=10*1024*1024;if(p.size>f){v("upload-error",{code:"FILE_TOO_LARGE",message:"å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡ 10MB"});return}n.value=!0,A.value=0;try{const y=await X.uploadImage(p,P=>{A.value=P});v("update:modelValue",y.file_url),v("upload-success",y)}catch(y){console.error("Upload error:",y);let P="ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•",q="UPLOAD_FAILED";y.code==="UPLOAD_FAILED"||y.name==="NotReadableError"?(P=y.message,q="FILE_READ_ERROR"):($=y.message)!=null&&$.includes("Network Error")||y.code==="ERR_NETWORK"?(P="ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ",q="NETWORK_ERROR"):(S=(N=y.response)==null?void 0:N.data)!=null&&S.message?(P=y.response.data.message,q=y.response.data.error||"SERVER_ERROR"):y.message&&(P=y.message),v("upload-error",{code:q,message:P})}finally{n.value=!1}},I=()=>{v("update:modelValue",null)},s=async p=>{var $;const t=document.activeElement;if(t&&(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable)||l.disabled||n.value)return;const f=($=p.clipboardData)==null?void 0:$.items;if(!(!f||f.length===0))for(let N=0;N<f.length;N++){const S=f[N];if(S.type.startsWith("image/")){p.preventDefault();const y=S.getAsFile();if(y){await D(y);return}}}};return oe(()=>{document.addEventListener("paste",s)}),ke(()=>{document.removeEventListener("paste",s)}),(p,t)=>(d(),r("div",{class:W(["image-uploader",{"is-dragover":c.value,"has-image":u.modelValue,"is-disabled":u.disabled||n.value}]),onDragover:ue(m,["prevent"]),onDragleave:z,onDrop:ue(C,["prevent"])},[u.modelValue?(d(),r(Z,{key:0},[e("img",{src:u.modelValue,alt:"é¡µé¢æˆªå›¾",class:"preview-image"},null,8,Be),e("div",Ee,[e("label",Ue,[e("input",{type:"file",accept:"image/png,image/jpeg,.png,.jpg,.jpeg",disabled:u.disabled||n.value,onChange:B,class:"hidden-input"},null,40,Ne),t[0]||(t[0]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 005.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 013.51 15"})],-1)),t[1]||(t[1]=_(" æ›´æ¢ ",-1))]),e("button",{class:"btn-action danger",type:"button",onClick:ue(I,["stop"])},[...t[2]||(t[2]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})],-1),_(" ç§»é™¤ ",-1)])])])],64)):n.value?(d(),r("div",ze,[e("div",Le,[(d(),r("svg",Se,[t[3]||(t[3]=e("circle",{class:"bg",cx:"50",cy:"50",r:"45"},null,-1)),e("circle",{class:"progress",cx:"50",cy:"50",r:"45","stroke-dasharray":`${A.value*283} 283`},null,8,Re)])),e("span",Pe,U(Math.round(A.value*100))+"%",1)]),t[4]||(t[4]=e("p",null,"ä¸Šä¼ ä¸­...",-1))])):(d(),r("div",Oe,[e("label",Te,[e("input",{type:"file",accept:"image/png,image/jpeg,.png,.jpg,.jpeg",disabled:u.disabled||n.value,onChange:B,class:"hidden-input"},null,40,je),t[5]||(t[5]=ee('<div class="upload-icon" data-v-be502232><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-be502232><path d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" data-v-be502232></path></svg></div><p class="upload-text" data-v-be502232>æ‹–æ‹½å›¾ç‰‡åˆ°æ­¤å¤„</p><p class="upload-hint" data-v-be502232>æˆ–ç‚¹å‡»ä¸Šä¼ </p><p class="upload-formats" data-v-be502232>æ”¯æŒ PNG, JPG (æœ€å¤§ 10MB)</p>',4))]),t[6]||(t[6]=e("div",{class:"paste-hint"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]),e("span",null,[_("ä¹Ÿå¯æŒ‰ "),e("kbd",null,"Ctrl"),_("+"),e("kbd",null,"V"),_(" ç²˜è´´å›¾ç‰‡")])],-1))]))],34))}},qe=le(He,[["__scopeId","data-v-be502232"]]),Fe={class:"config-editor"},Je={class:"section"},Ge={class:"form-grid"},Ke={class:"form-field full-width"},Ze={class:"form-field"},We={key:0,class:"field-hint error"},Qe={class:"form-field"},Xe={key:0,class:"field-hint error"},Ye={class:"form-field full-width"},et={class:"field-help"},tt={key:0,class:"help-content"},st={class:"form-field full-width"},at={class:"section"},nt={class:"form-field"},ot={class:"list-editor"},lt=["onUpdate:modelValue"],it=["onClick"],rt={key:0,class:"field-hint error"},dt={class:"form-field"},ut={class:"list-editor"},ct=["onUpdate:modelValue"],vt=["onClick"],pt=`æè¿°æ­¤é¡µé¢çš„åŠŸèƒ½å’Œç”¨æˆ·å¯æ‰§è¡Œçš„æ“ä½œ...

ç¤ºä¾‹æ ¼å¼ï¼š
ç”¨æˆ·ä¸­å¿ƒæ˜¯ç®¡ç†ä¸ªäººä¿¡æ¯çš„æ ¸å¿ƒé¡µé¢ã€‚

ç”¨æˆ·å¯æ‰§è¡Œçš„æ“ä½œï¼š
- ä¿®æ”¹å¤´åƒå’Œæ˜µç§°
- æ›´æ–°è”ç³»æ–¹å¼
- ä¿®æ”¹å¯†ç 

## è¡Œä¸ºè§„åˆ™
- å¼•å¯¼ç”¨æˆ·å®Œå–„å¿…å¡«ä¿¡æ¯
- æ•æ„Ÿæ“ä½œéœ€äºŒæ¬¡ç¡®è®¤

## é¡µé¢ç›®æ ‡
å¸®åŠ©ç”¨æˆ·ç»´æŠ¤ä¸ªäººä¿¡æ¯ï¼Œç¡®ä¿è´¦æˆ·å®‰å…¨`,ft={__name:"ConfigEditor",props:{config:{type:Object,required:!0},sessionId:String,errors:{type:Object,default:()=>({})}},emits:["config-changed"],setup(u,{emit:M}){const l=u,v=M,c=h(!1),n=we({page_id:"",name:{"zh-CN":"",en:""},description:{"zh-CN":"",en:""},button_list:[""],optional_actions:[]});oe(()=>{A()}),ae(()=>l.config,()=>{A()},{deep:!0});const A=()=>{var I,s,p,t,f;if(l.config){n.page_id=l.config.page_id||"",n.name={"zh-CN":((I=l.config.name)==null?void 0:I["zh-CN"])||"",en:((s=l.config.name)==null?void 0:s.en)||""};let $=((p=l.config.description)==null?void 0:p["zh-CN"])||"",N=((t=l.config.description)==null?void 0:t.en)||"";if(l.config.ai_context){const{behavior_rules:S,page_goal:y}=l.config.ai_context;S&&!$.includes("## è¡Œä¸ºè§„åˆ™")&&($+=`

## è¡Œä¸ºè§„åˆ™
${S}`),y&&!$.includes("## é¡µé¢ç›®æ ‡")&&($+=`

## é¡µé¢ç›®æ ‡
${y}`),S&&!N.includes("## Behavior Rules")&&(N+=`

## Behavior Rules
${S}`),y&&!N.includes("## Page Goal")&&(N+=`

## Page Goal
${y}`)}n.description={"zh-CN":$.trim(),en:N.trim()},n.button_list=(f=l.config.button_list)!=null&&f.length?[...l.config.button_list]:[""],n.optional_actions=l.config.optional_actions?[...l.config.optional_actions]:[]}},m=()=>{v("config-changed",{page_id:n.page_id,name:{...n.name},description:{...n.description},button_list:[...n.button_list],optional_actions:[...n.optional_actions]})},z=()=>{n.button_list.push(""),m()},C=I=>{n.button_list.length<=1||(n.button_list.splice(I,1),m())},B=()=>{n.optional_actions.push(""),m()},D=I=>{n.optional_actions.splice(I,1),m()};return(I,s)=>(d(),r("div",Fe,[e("section",Je,[s[13]||(s[13]=e("div",{class:"section-header"},[e("div",{class:"section-icon"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])]),e("h3",null,"åŸºæœ¬ä¿¡æ¯")],-1)),e("div",Ge,[e("div",Ke,[s[6]||(s[6]=e("label",null,[_(" é¡µé¢ ID (è‹±æ–‡æ ‡è¯†) "),e("span",{class:"required"},"*")],-1)),G(e("input",{"onUpdate:modelValue":s[0]||(s[0]=p=>n.page_id=p),type:"text",class:W(["form-input",{error:u.errors.page_id}]),placeholder:"ä¾‹å¦‚: 1.0home_page, 4.1face_authorization_page",onInput:m},null,34),[[K,n.page_id]]),e("span",{class:W(["field-hint",{error:u.errors.page_id}])},U(u.errors.page_id||"æ ¼å¼: {é¡µé¢ç¼–å·}{è‹±æ–‡åç§°}ï¼Œå¦‚ 4.1face_authorization_pageï¼Œå•è¯é—´ç”¨ä¸‹åˆ’çº¿åˆ†éš”"),3)]),e("div",Ze,[s[7]||(s[7]=e("label",null,[_(" é¡µé¢åç§° (ä¸­æ–‡) "),e("span",{class:"required"},"*")],-1)),G(e("input",{"onUpdate:modelValue":s[1]||(s[1]=p=>n.name["zh-CN"]=p),type:"text",class:W(["form-input",{error:u.errors.name_zh}]),placeholder:"ä¾‹å¦‚: é¦–é¡µã€ç”¨æˆ·ä¸­å¿ƒ",onInput:m},null,34),[[K,n.name["zh-CN"]]]),u.errors.name_zh?(d(),r("span",We,U(u.errors.name_zh),1)):x("",!0)]),e("div",Qe,[s[8]||(s[8]=e("label",null,[_(" Page Name (EN) "),e("span",{class:"required"},"*")],-1)),G(e("input",{"onUpdate:modelValue":s[2]||(s[2]=p=>n.name.en=p),type:"text",class:W(["form-input",{error:u.errors.name_en}]),placeholder:"e.g. Home Page, User Profile",onInput:m},null,34),[[K,n.name.en]]),u.errors.name_en?(d(),r("span",Xe,U(u.errors.name_en),1)):x("",!0)]),e("div",Ye,[s[11]||(s[11]=e("label",null,[_(" é¡µé¢æè¿° (ä¸­æ–‡) "),e("span",{class:"label-hint"},"åŒ…å«åŠŸèƒ½è¯´æ˜ã€è¡Œä¸ºè§„åˆ™å’Œé¡µé¢ç›®æ ‡")],-1)),G(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=p=>n.description["zh-CN"]=p),class:"form-textarea description-textarea",rows:"8",placeholder:pt,onInput:m},null,544),[[K,n.description["zh-CN"]]]),e("div",et,[e("button",{type:"button",class:"help-toggle",onClick:s[4]||(s[4]=p=>c.value=!c.value)},[s[9]||(s[9]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 16v-4M12 8h.01"})],-1)),_(" "+U(c.value?"æ”¶èµ·æ ¼å¼è¯´æ˜":"æŸ¥çœ‹æ ¼å¼è¯´æ˜"),1)]),c.value?(d(),r("div",tt,[...s[10]||(s[10]=[e("p",null,[e("strong",null,"æ¨èæ ¼å¼ï¼š")],-1),e("pre",null,`é¡µé¢åŠŸèƒ½æ¦‚è¿°...

ç”¨æˆ·å¯æ‰§è¡Œçš„æ“ä½œï¼š
- æ“ä½œ1
- æ“ä½œ2

## è¡Œä¸ºè§„åˆ™
AI åœ¨æ­¤é¡µé¢åº”éµå¾ªçš„çº¦æŸ...

## é¡µé¢ç›®æ ‡
ç”¨æˆ·åœ¨æ­¤é¡µé¢çš„ä¸»è¦ç›®æ ‡...`,-1)])])):x("",!0)])]),e("div",st,[s[12]||(s[12]=e("label",null,[_(" Page Description (EN) "),e("span",{class:"label-hint"},"Optional")],-1)),G(e("textarea",{"onUpdate:modelValue":s[5]||(s[5]=p=>n.description.en=p),class:"form-textarea",rows:"4",placeholder:"Describe the page features and available user actions...",onInput:m},null,544),[[K,n.description.en]])])])]),e("section",at,[s[20]||(s[20]=ee('<div class="section-header" data-v-57d8bbe6><div class="section-icon accent" data-v-57d8bbe6><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-57d8bbe6><rect x="3" y="3" width="7" height="7" data-v-57d8bbe6></rect><rect x="14" y="3" width="7" height="7" data-v-57d8bbe6></rect><rect x="14" y="14" width="7" height="7" data-v-57d8bbe6></rect><rect x="3" y="14" width="7" height="7" data-v-57d8bbe6></rect></svg></div><h3 data-v-57d8bbe6>é¡µé¢èƒ½åŠ›</h3></div>',1)),e("div",nt,[s[16]||(s[16]=e("label",null," å¯ç‚¹å‡»æŒ‰é’® ",-1)),e("div",ot,[(d(!0),r(Z,null,Y(n.button_list,(p,t)=>(d(),r("div",{key:t,class:"list-item"},[G(e("input",{"onUpdate:modelValue":f=>n.button_list[t]=f,type:"text",class:"form-input",placeholder:"æŒ‰é’® ID (snake_case)",onInput:m},null,40,lt),[[K,n.button_list[t]]]),n.button_list.length>1?(d(),r("button",{key:0,class:"remove-btn",onClick:f=>C(t),type:"button"},[...s[14]||(s[14]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M15 9l-6 6M9 9l6 6"})],-1)])],8,it)):x("",!0)]))),128)),e("button",{class:"add-btn",onClick:z,type:"button"},[...s[15]||(s[15]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 8v8M8 12h8"})],-1),_(" æ·»åŠ æŒ‰é’® ",-1)])])]),u.errors.button_list?(d(),r("span",rt,U(u.errors.button_list),1)):x("",!0)]),e("div",dt,[s[19]||(s[19]=e("label",null,"å¯é€‰æ“ä½œ",-1)),e("div",ut,[(d(!0),r(Z,null,Y(n.optional_actions,(p,t)=>(d(),r("div",{key:t,class:"list-item"},[G(e("input",{"onUpdate:modelValue":f=>n.optional_actions[t]=f,type:"text",class:"form-input",placeholder:"æ“ä½œ ID",onInput:m},null,40,ct),[[K,n.optional_actions[t]]]),e("button",{class:"remove-btn",onClick:f=>D(t),type:"button"},[...s[17]||(s[17]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M15 9l-6 6M9 9l6 6"})],-1)])],8,vt)]))),128)),e("button",{class:"add-btn",onClick:B,type:"button"},[...s[18]||(s[18]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 8v8M8 12h8"})],-1),_(" æ·»åŠ æ“ä½œ ",-1)])])])])])]))}},gt=le(ft,[["__scopeId","data-v-57d8bbe6"]]),mt={class:"clarify-panel"},ht={class:"panel-header"},bt={key:0,class:"message assistant"},_t={class:"bubble-wrapper"},yt={key:0,class:"avatar small"},kt={class:"bubble"},wt=["src","onClick"],Ct=["innerHTML"],$t={key:1,class:"streaming-cursor"},xt={class:"timestamp"},Mt={key:1,class:"message assistant"},At={class:"bubble-wrapper"},It={class:"bubble"},Dt={class:"streaming-output"},Vt={key:1,class:"parsing-message"},Bt={key:2,class:"message assistant"},Et={key:3,class:"message assistant"},Ut={class:"bubble-wrapper"},Nt={class:"bubble config-preview"},zt={class:"config-summary"},Lt={key:0,class:"config-item"},St={class:"page-id-value"},Rt={key:1,class:"config-item"},Pt={key:2,class:"config-item"},Ot={class:"tag-list"},Tt={key:3,class:"config-item"},jt={class:"tag-list"},Ht={key:4,class:"message assistant"},qt={class:"bubble-wrapper"},Ft={class:"bubble"},Jt={key:0,class:"quick-options"},Gt=["onClick"],Kt={key:0,class:"pending-image"},Zt=["src"],Wt={class:"input-area"},Qt={class:"input-wrapper"},Xt=["disabled"],Yt=["disabled"],es=["disabled"],ts={__name:"ClarifyPanel",props:{sessionId:String,parseResult:Object,status:String,currentConfig:Object,imageUrl:String,streamingContent:String},emits:["config-updated","config-confirmed","completed"],setup(u,{emit:M}){const l=u,v=M,c=h([]),n=h(null),A=h(""),m=h(!1),z=h(null),C=h(null),B=h(null),D=h(null),I=h(!1),s=h(null),p=h(!1),t=ne(()=>({pending:"ç­‰å¾…ä¸­",parsing:"åˆ†æä¸­...",clarifying:"å¯¹è¯ä¸­",completed:"å·²å®Œæˆ",failed:"å¤±è´¥"})[l.status]||"");ae(()=>l.parseResult,g=>{var o;g&&l.status==="completed"&&!p.value&&(s.value=g,I.value=!0,R()),((o=g==null?void 0:g.clarification_questions)==null?void 0:o.length)>0?n.value=g.clarification_questions[0]:n.value=null},{immediate:!0}),ae(()=>l.status,(g,o)=>{var L;g==="parsing"&&o!=="parsing"&&(c.value.push({role:"assistant",content:"æ­£åœ¨åˆ†æé¡µé¢æˆªå›¾ï¼Œè¯·ç¨å€™...",timestamp:new Date}),p.value=!1,I.value=!1,R()),g==="clarifying"&&l.parseResult&&(c.value.push({role:"assistant",content:"æˆ‘å·²å®Œæˆåˆæ­¥åˆ†æï¼Œè¿˜æœ‰ä¸€äº›é—®é¢˜éœ€è¦ç¡®è®¤ï¼š",timestamp:new Date}),((L=l.parseResult.clarification_questions)==null?void 0:L.length)>0&&(n.value=l.parseResult.clarification_questions[0]),R())}),ae(()=>l.streamingContent,()=>{l.streamingContent&&R()});const f=()=>{s.value&&(v("config-confirmed",s.value),p.value=!0,I.value=!1,c.value.push({role:"user",content:"ç¡®è®¤åº”ç”¨æ­¤é…ç½®",timestamp:new Date}),R())},$=()=>{I.value=!1,c.value.push({role:"user",content:"éœ€è¦é‡æ–°è¯†åˆ«",timestamp:new Date}),c.value.push({role:"assistant",content:"å¥½çš„ï¼Œè¯·é‡æ–°ä¸Šä¼ å›¾ç‰‡æˆ–æè¿°æ‚¨çš„éœ€æ±‚ï¼Œæˆ‘ä¼šé‡æ–°åˆ†æã€‚",timestamp:new Date}),R()},N=g=>{g.key==="Enter"&&!g.shiftKey&&(g.preventDefault(),te())},S=g=>{C.value=g;const o=new FileReader;return o.onload=L=>{B.value=L.target.result},o.readAsDataURL(g),!1},y=g=>{var L;const o=(L=g.target.files)==null?void 0:L[0];if(o){if(!["image/png","image/jpeg","image/jpg"].includes(o.type))return;S(o)}g.target.value=""},P=()=>{C.value=null,B.value=null},q=g=>{D.value=g},te=async()=>{var L,F;if(!A.value.trim()&&!C.value||m.value)return;const g=A.value.trim(),o=B.value;A.value="",P(),c.value.push({role:"user",content:g||"(ä¸Šä¼ äº†å›¾ç‰‡)",image:o,timestamp:new Date}),R(),m.value=!0;try{if(l.sessionId&&(l.status==="clarifying"||l.status==="completed")){let j="";const b=c.value.length;c.value.push({role:"assistant",content:"",timestamp:new Date,isStreaming:!0});const Q=De.chatStream(l.sessionId,g,l.currentConfig,O=>{O.type==="content"&&(j+=O.content,c.value[b].content=j,R())},O=>{c.value[b].isStreaming=!1,c.value[b].content=j||"å¥½çš„ï¼Œæˆ‘å·²æ ¹æ®æ‚¨çš„å»ºè®®æ›´æ–°äº†é…ç½®ã€‚",O&&(s.value=O,I.value=!0,p.value=!1),m.value=!1,R()},O=>{c.value[b].isStreaming=!1,c.value[b].content=`âŒ ${O||"è¯·æ±‚å¤±è´¥ï¼Œè¯·é‡è¯•"}`,m.value=!1,R()});window._currentChatStream=Q}else c.value.push({role:"assistant",content:'è¯·å…ˆä¸Šä¼ é¡µé¢æˆªå›¾å¹¶ç‚¹å‡»"AI è¾…åŠ©å¡«å†™"ï¼Œæˆ‘ä¼šå¸®æ‚¨è¯†åˆ«é¡µé¢å…ƒç´ ã€‚',timestamp:new Date}),m.value=!1}catch(j){c.value.push({role:"assistant",content:`âŒ ${((F=(L=j.response)==null?void 0:L.data)==null?void 0:F.message)||"è¯·æ±‚å¤±è´¥ï¼Œè¯·é‡è¯•"}`,timestamp:new Date}),m.value=!1}finally{R()}},ie=g=>{A.value=g,te()},R=()=>{Ce(()=>{z.value&&(z.value.scrollTop=z.value.scrollHeight)})},re=g=>g?g.replace(/\n/g,"<br>"):"",de=g=>new Date(g).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"});return(g,o)=>{var F,j;const L=ve("a-image");return d(),r("div",mt,[e("div",ht,[o[2]||(o[2]=ee('<div class="assistant-info" data-v-0826f096><div class="avatar" data-v-0826f096><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-0826f096><path d="M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z" data-v-0826f096></path></svg></div><span class="name" data-v-0826f096>UI config å¡«å†™åŠ©æ‰‹</span></div>',1)),u.status?(d(),r("span",{key:0,class:W(["status-badge",u.status])},[o[1]||(o[1]=e("span",{class:"status-dot"},null,-1)),_(" "+U(t.value),1)],2)):x("",!0)]),e("div",{class:"chat-container",ref_key:"chatContainer",ref:z},[c.value.length===0&&!u.status?(d(),r("div",bt,[...o[3]||(o[3]=[ee('<div class="bubble" data-v-0826f096><div class="welcome-content" data-v-0826f096><div class="welcome-icon" data-v-0826f096>ğŸ‘‹</div><div class="welcome-text" data-v-0826f096><p data-v-0826f096>ä½ å¥½ï¼ä¸Šä¼ é¡µé¢æˆªå›¾å¹¶ç‚¹å‡»&quot;AI è¾…åŠ©å¡«å†™&quot;ï¼Œæˆ‘å°†å¸®åŠ©æ‚¨è‡ªåŠ¨è¯†åˆ«é¡µé¢å…ƒç´ ã€‚</p><p class="sub" data-v-0826f096>æ‚¨ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ä¸‹æ–¹è¾“å…¥æ¡†æè¿°æ‚¨æƒ³è¦é…ç½®çš„é¡µé¢åŠŸèƒ½ã€‚</p></div></div></div>',1)])])):x("",!0),(d(!0),r(Z,null,Y(c.value,(b,Q)=>(d(),r("div",{key:Q,class:W(["message",b.role])},[e("div",_t,[b.role==="assistant"?(d(),r("div",yt,[...o[4]||(o[4]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z"})],-1)])])):x("",!0),e("div",kt,[b.image?(d(),r("img",{key:0,src:b.image,class:"chat-image",onClick:O=>q(b.image)},null,8,wt)):x("",!0),e("span",{innerHTML:re(b.content)},null,8,Ct),b.isStreaming?(d(),r("span",$t,"â–Š")):x("",!0)])]),e("span",xt,U(de(b.timestamp)),1)],2))),128)),u.status==="parsing"?(d(),r("div",Mt,[e("div",At,[o[7]||(o[7]=e("div",{class:"avatar small"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z"})])],-1)),e("div",It,[u.streamingContent?(d(),r(Z,{key:0},[e("pre",Dt,U(u.streamingContent),1),o[5]||(o[5]=e("span",{class:"streaming-cursor"},"â–Š",-1))],64)):(d(),r("div",Vt,[...o[6]||(o[6]=[e("span",{class:"parsing-icon"},"ğŸ”",-1),_(" æ­£åœ¨åˆ†æé¡µé¢æˆªå›¾ï¼Œè¯†åˆ«å¯äº¤äº’å…ƒç´ ... ",-1)])]))])])])):x("",!0),m.value?(d(),r("div",Bt,[...o[8]||(o[8]=[ee('<div class="bubble-wrapper" data-v-0826f096><div class="avatar small" data-v-0826f096><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-0826f096><path d="M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z" data-v-0826f096></path></svg></div><div class="bubble loading" data-v-0826f096><span class="dot" data-v-0826f096></span><span class="dot" data-v-0826f096></span><span class="dot" data-v-0826f096></span></div></div>',1)])])):x("",!0),I.value&&s.value?(d(),r("div",Et,[e("div",Ut,[o[15]||(o[15]=e("div",{class:"avatar small"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z"})])],-1)),e("div",Nt,[o[14]||(o[14]=e("div",{class:"preview-header"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M20 6L9 17l-5-5"})]),_(" è§£æå®Œæˆï¼ä»¥ä¸‹æ˜¯è¯†åˆ«åˆ°çš„é…ç½®ä¿¡æ¯ï¼š ")],-1)),e("div",zt,[s.value.page_id?(d(),r("div",Lt,[o[9]||(o[9]=e("label",null,"é¡µé¢ IDï¼š",-1)),e("span",St,U(s.value.page_id),1)])):x("",!0),s.value.page_name?(d(),r("div",Rt,[o[10]||(o[10]=e("label",null,"é¡µé¢åç§°ï¼š",-1)),e("span",null,U(s.value.page_name["zh-CN"]||""),1)])):x("",!0),(F=s.value.button_list)!=null&&F.length?(d(),r("div",Pt,[e("label",null,"è¯†åˆ«åˆ°çš„æŒ‰é’® ("+U(s.value.button_list.length)+"ä¸ª)ï¼š",1),e("div",Ot,[(d(!0),r(Z,null,Y(s.value.button_list,b=>(d(),r("span",{key:b,class:"config-tag"},U(b),1))),128))])])):x("",!0),(j=s.value.optional_actions)!=null&&j.length?(d(),r("div",Tt,[o[11]||(o[11]=e("label",null,"å¯é€‰æ“ä½œï¼š",-1)),e("div",jt,[(d(!0),r(Z,null,Y(s.value.optional_actions,b=>(d(),r("span",{key:b,class:"config-tag accent"},U(b),1))),128))])])):x("",!0)]),e("div",{class:"preview-actions"},[e("button",{class:"action-btn secondary",onClick:$},[...o[12]||(o[12]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 005.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 013.51 15"})],-1),_(" é‡æ–°è¯†åˆ« ",-1)])]),e("button",{class:"action-btn primary",onClick:f},[...o[13]||(o[13]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M20 6L9 17l-5-5"})],-1),_(" ç¡®è®¤åº”ç”¨ ",-1)])])])])])])):x("",!0),n.value&&u.status==="clarifying"?(d(),r("div",Ht,[e("div",qt,[o[16]||(o[16]=e("div",{class:"avatar small"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z"})])],-1)),e("div",Ft,U(n.value.question_text||n.value),1)]),n.value.options?(d(),r("div",Jt,[(d(!0),r(Z,null,Y(n.value.options,b=>(d(),r("button",{key:b,class:"option-btn",onClick:Q=>ie(b)},U(b),9,Gt))),128))])):x("",!0)])):x("",!0)],512),H(L,{width:200,style:{display:"none"},preview:{visible:!!D.value,onVisibleChange:b=>{b||(D.value=null)},src:D.value}},null,8,["preview"]),C.value?(d(),r("div",Kt,[e("img",{src:B.value},null,8,Zt),e("button",{class:"remove-btn",onClick:P},[...o[17]||(o[17]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])])):x("",!0),e("div",Wt,[e("div",Qt,[e("label",{class:W(["upload-btn",{disabled:m.value}])},[e("input",{type:"file",accept:"image/png,image/jpeg,.png,.jpg,.jpeg",onChange:y,disabled:m.value},null,40,Xt),o[18]||(o[18]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"}),e("polyline",{points:"17 8 12 3 7 8"}),e("line",{x1:"12",y1:"3",x2:"12",y2:"15"})],-1))],2),G(e("textarea",{ref:"inputRef","onUpdate:modelValue":o[0]||(o[0]=b=>A.value=b),placeholder:"è¾“å…¥ä¿®æ”¹å»ºè®®æˆ–é—®é¢˜...",disabled:m.value,onKeydown:N,rows:"1"},null,40,Yt),[[K,A.value]]),e("button",{class:"send-btn",disabled:!A.value.trim()&&!C.value||m.value,onClick:te},[...o[19]||(o[19]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"})],-1)])],8,es)]),o[20]||(o[20]=e("div",{class:"input-hint"}," Enter å‘é€ Â· Shift+Enter æ¢è¡Œ ",-1))])])}}},ss=le(ts,[["__scopeId","data-v-0826f096"]]),as={class:"page-editor"},ns={class:"editor-header"},os={class:"header-left"},ls={class:"header-title"},is={class:"title-icon"},rs={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ds={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},us={class:"header-actions"},cs={key:0,class:"unsaved-badge"},vs=["disabled"],ps={key:0,class:"btn-spinner dark"},fs=["disabled"],gs={key:0,class:"btn-spinner"},ms={class:"editor-body"},hs={class:"editor-grid"},bs={class:"panel panel-left"},_s={class:"panel-card"},ys={class:"card-body"},ks=["disabled"],ws={key:0,class:"btn-spinner"},Cs={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},$s={class:"panel-card"},xs={class:"card-body"},Ms={class:"json-preview-container"},As={class:"panel panel-center"},Is={class:"panel-card config-card"},Ds={class:"card-body"},Vs={class:"panel panel-right"},Bs={class:"panel-card ai-card"},Es={class:"card-body"},Us={__name:"PageEditor",setup(u){const M=$e(),l=xe(),v=Ve(),c=ne(()=>M.name==="PageCreate"),n=h(""),A=h(""),m=h(null),z=h(""),C=h(!1),B=h(!1),D=h(!1),I=h(!1),s=h(null),p=h({}),t=h(""),f=h(!1);let $=null;const N=ne(()=>{const i=v.draftConfig,a=(i.button_list||[]).filter(w=>w&&w.trim()),k=(i.optional_actions||[]).filter(w=>w&&w.trim()),E={pages:{[i.page_id||"unnamed"]:{name:i.name,description:i.description,buttonList:a,optionalActions:k}}};return JSON.stringify(E,null,2)});oe(async()=>{if(v.resetConfig(),!c.value&&M.params.id)try{const i=await X.get(M.params.id);v.setOriginalConfig({page_id:i.page_id,name:i.name,description:i.description,button_list:i.button_list||[],optional_actions:i.optional_actions||[]}),n.value=i.screenshot_url||""}catch(i){console.error("Failed to load page:",i),V.error("åŠ è½½é¡µé¢å¤±è´¥"),l.push("/")}});const S=i=>{n.value=i.file_url,V.success("å›¾ç‰‡ä¸Šä¼ æˆåŠŸ")},y=i=>{V.error(i.message||"ä¸Šä¼ å¤±è´¥")},P=async()=>{var i,a;if(!n.value){V.warning("è¯·å…ˆä¸Šä¼ é¡µé¢æˆªå›¾");return}C.value=!0,I.value=!0,z.value="parsing",t.value="";try{const k=X.parseStream(n.value,E=>{E.type==="content"&&(t.value+=E.content)},E=>{C.value=!1,z.value="completed",m.value=E,t.value="",V.success("AI è§£æå®Œæˆ")},E=>{C.value=!1,z.value="failed",t.value="",V.error(E||"è§£æå¤±è´¥")});window._currentParseStream=k}catch(k){C.value=!1,z.value="failed",V.error(((a=(i=k.response)==null?void 0:i.data)==null?void 0:a.message)||"è§£æå¤±è´¥")}},q=i=>{const{conflict:a}=v.tryApplyAiUpdate(i);a?(s.value=i,fe.confirm({title:"é…ç½®å†²çª",icon:H(Ie),content:"AI å·²æ›´æ–°é…ç½®ï¼Œä½†æ‚¨æœ‰æœªä¿å­˜çš„ä¿®æ”¹ã€‚æ˜¯å¦åº”ç”¨ AI æ›´æ–°ï¼Ÿ",okText:"åº”ç”¨ AI æ›´æ–°",cancelText:"ä¿ç•™æˆ‘çš„ä¿®æ”¹",onOk(){v.forceApplyAiUpdate(s.value),V.success("å·²åº”ç”¨ AI æ›´æ–°")},onCancel(){v.keepUserEdit()}})):V.success("AI è§£æå®Œæˆï¼Œé…ç½®å·²å¡«å……")},te=i=>{m.value=i},ie=i=>{q(i),V.success("é…ç½®å·²åº”ç”¨åˆ°è¡¨å•")},R=()=>{C.value=!1},re=i=>{v.applyUserEdit(i)},de=()=>{fe.confirm({title:"ç¡®è®¤é‡ç½®",content:"ç¡®å®šè¦é‡ç½®æ‰€æœ‰é…ç½®å—ï¼Ÿæ­¤æ“ä½œå°†æ¸…ç©ºå½“å‰æ‰€æœ‰æœªä¿å­˜çš„å†…å®¹ã€‚",onOk(){n.value="",I.value=!1,A.value="",m.value=null,z.value="",C.value=!1,v.resetConfig(),V.success("é…ç½®å·²é‡ç½®")}})},g=()=>{var k,E,w,T,J;const i={},a=v.draftConfig;return(k=a.page_id)!=null&&k.trim()?/^[a-zA-Z0-9_\.]+$/.test(a.page_id)||(i.page_id="åªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿å’Œç‚¹"):i.page_id="é¡µé¢ ID ä¸ºå¿…å¡«é¡¹",(w=(E=a.name)==null?void 0:E["zh-CN"])!=null&&w.trim()||(i.name_zh="ä¸­æ–‡åç§°ä¸ºå¿…å¡«é¡¹"),(J=(T=a.name)==null?void 0:T.en)!=null&&J.trim()||(i.name_en="è‹±æ–‡åç§°ä¸ºå¿…å¡«é¡¹"),i},o=async({redirect:i=!0}={})=>{var k,E;const a=g();if(Object.keys(a).length>0)return p.value=a,V.error("è¯·æ£€æŸ¥è¡¨å•é”™è¯¯"),!1;B.value=!0;try{const w=v.draftConfig,T={page_id:w.page_id,name:w.name,description:w.description,button_list:w.button_list.filter(J=>J.trim()),optional_actions:w.optional_actions.filter(J=>J.trim()),screenshot_url:n.value};return c.value?await X.create(T):await X.update(M.params.id,T),V.success("ä¿å­˜æˆåŠŸ"),v.isDirty=!1,c.value&&i&&l.push(`/page/${w.page_id}`),!0}catch(w){return V.error(((E=(k=w.response)==null?void 0:k.data)==null?void 0:E.message)||"ä¿å­˜å¤±è´¥"),!1}finally{B.value=!1}},L=async({redirect:i=!0}={})=>{var k,E,w;const a=(k=v.draftConfig.page_id)==null?void 0:k.trim();if(!a)return V.error("è¯·å…ˆå¡«å†™é¡µé¢ ID"),!1;if(!/^[a-zA-Z0-9_\.]+$/.test(a))return V.error("é¡µé¢ ID åªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿å’Œç‚¹"),!1;D.value=!0;try{const T=v.draftConfig,J={page_id:a,name:T.name,description:T.description,button_list:T.button_list,optional_actions:T.optional_actions,screenshot_url:n.value};return await X.saveDraft(J),V.success("è‰ç¨¿å·²ä¿å­˜"),v.isDirty=!1,c.value&&i&&l.replace(`/page/${a}`),!0}catch(T){return V.error(((w=(E=T.response)==null?void 0:E.data)==null?void 0:w.message)||"ä¿å­˜è‰ç¨¿å¤±è´¥"),!1}finally{D.value=!1}},F=async()=>{await o()},j=async()=>{await L()},b=async()=>{try{await navigator.clipboard.writeText(N.value),V.success("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch{V.error("å¤åˆ¶å¤±è´¥")}},Q=()=>{const i=new Blob([N.value],{type:"application/json"}),a=URL.createObjectURL(i),k=document.createElement("a");k.href=a,k.download=`${v.draftConfig.page_id||"config"}_${Date.now()}.json`,k.click(),URL.revokeObjectURL(a)},O=()=>{const i=$;$=null,f.value=!1,i&&i()},he=()=>{v.isDirty=!1,O()},be=async()=>{await L({redirect:!1})&&O()},_e=async()=>{await o({redirect:!1})&&O()};Me((i,a,k)=>{if(v.isDirty){$=k,f.value=!0;return}k()});const pe=i=>{v.isDirty&&(i.preventDefault(),i.returnValue="")};return oe(()=>{window.addEventListener("beforeunload",pe)}),Ae(()=>{window.removeEventListener("beforeunload",pe)}),ae(()=>M.path,()=>{}),(i,a)=>{const k=ve("a-button"),E=ve("a-modal");return d(),r("div",as,[e("header",ns,[e("div",os,[e("button",{class:"back-btn",onClick:a[0]||(a[0]=w=>i.$router.push("/"))},[...a[3]||(a[3]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),_(" è¿”å›åˆ—è¡¨ ",-1)])]),a[6]||(a[6]=e("div",{class:"header-divider"},null,-1)),e("div",ls,[e("span",is,[c.value?(d(),r("svg",rs,[...a[4]||(a[4]=[e("path",{d:"M12 4v16m-8-8h16"},null,-1)])])):(d(),r("svg",ds,[...a[5]||(a[5]=[e("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"},null,-1),e("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1)])]))]),_(" "+U(c.value?"æ·»åŠ é¡µé¢é…ç½®":"ç¼–è¾‘é¡µé¢é…ç½®"),1)])]),e("div",us,[ce(v).isDirty?(d(),r("span",cs,[...a[7]||(a[7]=[e("span",{class:"dot"},null,-1),_(" æœªä¿å­˜ ",-1)])])):x("",!0),e("button",{class:"action-btn secondary",onClick:de}," é‡ç½® "),e("button",{class:"action-btn secondary",onClick:j,disabled:B.value||D.value},[D.value?(d(),r("span",ps)):x("",!0),a[8]||(a[8]=_(" ä¿å­˜è‰ç¨¿ ",-1))],8,vs),e("button",{class:"action-btn primary",onClick:F,disabled:B.value||D.value},[B.value?(d(),r("span",gs)):x("",!0),a[9]||(a[9]=_(" ä¿å­˜é…ç½® ",-1))],8,fs)])]),e("div",ms,[e("div",hs,[e("aside",bs,[e("div",_s,[a[11]||(a[11]=ee('<div class="card-header" data-v-fdae85a1><h3 data-v-fdae85a1><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-fdae85a1><rect x="3" y="3" width="18" height="18" rx="2" data-v-fdae85a1></rect><circle cx="8.5" cy="8.5" r="1.5" data-v-fdae85a1></circle><path d="M21 15l-5-5L5 21" data-v-fdae85a1></path></svg> é¡µé¢æˆªå›¾ </h3></div>',1)),e("div",ys,[H(qe,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=w=>n.value=w),disabled:C.value,onUploadSuccess:S,onUploadError:y},null,8,["modelValue","disabled"]),e("button",{class:"ai-parse-btn",onClick:P,disabled:!n.value||C.value},[C.value?(d(),r("span",ws)):(d(),r("svg",Cs,[...a[10]||(a[10]=[e("path",{d:"M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 110 2h-1.07A7 7 0 0113 23a7 7 0 01-7.07-7H5a1 1 0 110-2h1a7 7 0 017-7h1V5.73A2 2 0 0112 2z"},null,-1)])])),_(" "+U(C.value?"æ­£åœ¨åˆ†æ...":"AI è¾…åŠ©å¡«å†™"),1)],8,ks)])]),e("div",$s,[e("div",{class:"card-header"},[a[14]||(a[14]=e("h3",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M16 18l6-6-6-6M8 6l-6 6 6 6"})]),_(" JSON é¢„è§ˆ ")],-1)),e("div",{class:"card-actions"},[e("button",{class:"icon-btn",onClick:b,title:"å¤åˆ¶"},[...a[12]||(a[12]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2"}),e("path",{d:"M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"})],-1)])]),e("button",{class:"icon-btn",onClick:Q,title:"ä¸‹è½½"},[...a[13]||(a[13]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"})],-1)])])])]),e("div",xs,[e("div",Ms,[e("pre",null,[e("code",null,U(N.value),1)])])])])]),e("main",As,[e("div",Is,[a[15]||(a[15]=e("div",{class:"card-header"},[e("h3",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),_(" é…ç½®è¯¦æƒ… ")])],-1)),e("div",Ds,[H(gt,{config:ce(v).draftConfig,"session-id":A.value,errors:p.value,onConfigChanged:re},null,8,["config","session-id","errors"])])])]),e("aside",Vs,[e("div",Bs,[a[16]||(a[16]=e("div",{class:"card-header"},[e("h3",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})]),_(" UI config å¡«å†™åŠ©æ‰‹ ")])],-1)),e("div",Es,[H(ss,{"session-id":A.value,"parse-result":m.value,status:z.value,"current-config":ce(v).draftConfig,"image-url":n.value,"streaming-content":t.value,onConfigUpdated:te,onConfigConfirmed:ie,onCompleted:R},null,8,["session-id","parse-result","status","current-config","image-url","streaming-content"])])])])])]),H(E,{open:f.value,"onUpdate:open":a[2]||(a[2]=w=>f.value=w),title:"æœªä¿å­˜çš„æ›´æ”¹",maskClosable:!1,closable:!1},{footer:se(()=>[H(k,{disabled:B.value||D.value,onClick:he},{default:se(()=>[...a[17]||(a[17]=[_("ç›´æ¥é€€å‡º",-1)])]),_:1},8,["disabled"]),H(k,{loading:D.value,onClick:be},{default:se(()=>[...a[18]||(a[18]=[_("ä¿æŒè‰ç¨¿",-1)])]),_:1},8,["loading"]),H(k,{type:"primary",loading:B.value,onClick:_e},{default:se(()=>[...a[19]||(a[19]=[_("ä¿å­˜é…ç½®",-1)])]),_:1},8,["loading"])]),default:se(()=>[a[20]||(a[20]=e("p",null,"å½“å‰å†…å®¹æœªä¿å­˜ï¼Œæ‚¨è¦ç›´æ¥é€€å‡ºã€ä¿æŒè‰ç¨¿è¿˜æ˜¯ä¿å­˜é…ç½®ï¼Ÿ",-1))]),_:1},8,["open"])])}}},Ls=le(Us,[["__scopeId","data-v-fdae85a1"]]);export{Ls as default};
