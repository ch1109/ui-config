import{r as c,c as f,o as x,a as d,B as F,C as R,b as r,f as U,d as e,k as v,m as g,t as m,F as D,h as G,i as B,v as H,l as k,M as L,e as V,E,j as i,G as O}from"./index-C9Ky3jQK.js";import{_ as q,s as y}from"./_plugin-vue_export-helper-BQ15yOP5.js";const Q={class:"system-prompt-page"},j={class:"page-content"},$={class:"content-grid"},J={class:"editor-section"},K={class:"panel-card model-card"},W={class:"card-header"},X={class:"card-body model-selector"},Y={class:"model-options"},Z=["value","disabled"],ee={class:"model-info"},te={class:"model-header"},se={class:"model-name"},oe={class:"model-provider"},ae={class:"model-desc"},le={key:0,class:"check-icon"},ne={class:"panel-card"},de={class:"card-header"},re={class:"card-actions"},ie=["disabled"],ce=["disabled"],ve=["disabled"],ue={key:0,class:"btn-spinner"},pe={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},me={class:"card-body"},he={class:"editor-container"},_e=["disabled"],fe={class:"editor-footer"},ge={class:"count"},ye={class:"status-hints"},be={key:0,class:"hint warning"},we={key:1,class:"hint error"},u=1e4,ke=100,Me={__name:"SystemPromptConfig",setup(Ce){const a=c(""),h=c(""),l=c(!1);c(null);const n=c("glm-4.6v"),b=c("glm-4.6v"),M=c([{id:"glm-4.6v",name:"GLM-4.6V",description:"智谱 AI 视觉模型，图像理解能力强，支持中英文",provider:"智谱 AI"},{id:"qwen2.5-vl-7b",name:"Qwen2.5-VL-7B",description:"通义千问视觉模型，本地部署版本，响应速度快",provider:"阿里云 / 本地部署"}]),p=f(()=>a.value.length),_=f(()=>p.value<=u),w=f(()=>a.value!==h.value||n.value!==b.value),S=f(()=>({warning:p.value>u*.9&&p.value<=u,error:p.value>u}));x(async()=>{l.value=!0;try{const s=await y.getCurrent();a.value=s.prompt_content,h.value=s.prompt_content,n.value=s.selected_model||"glm-4.6v",b.value=s.selected_model||"glm-4.6v";try{const t=await y.getModels();t.models&&t.models.length>0&&(M.value=t.models)}catch(t){console.warn("Failed to load models list, using defaults:",t)}}catch(s){console.error("Failed to load prompt:",s),d.error("加载提示词失败")}finally{l.value=!1}});const z=async()=>{d.info(`已选择 ${n.value==="glm-4.6v"?"GLM-4.6V":"Qwen2.5-VL-7B"} 模型，请点击保存按钮确认`)},A=()=>{a.value.length>u&&(a.value=a.value.slice(0,u))},I=async()=>{try{await navigator.clipboard.writeText(a.value),d.success("已复制到剪贴板")}catch{const t=document.createElement("textarea");t.value=a.value,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select();try{document.execCommand("copy"),d.success("已复制到剪贴板")}catch{d.error("复制失败，请手动复制")}document.body.removeChild(t)}},N=async()=>{var s,t;if(_.value){l.value=!0;try{await y.update({prompt_content:a.value,selected_model:n.value}),h.value=a.value,b.value=n.value,d.success("保存成功")}catch(o){d.error(((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"保存失败")}finally{l.value=!1}}},P=()=>{L.confirm({title:"恢复默认",icon:V(E),content:"确定要恢复为默认模板吗？当前内容将被覆盖。",onOk:async()=>{l.value=!0;try{const s=await y.reset();a.value=s.prompt_content,h.value=s.prompt_content,d.success("已恢复默认配置")}catch{d.error("恢复失败")}finally{l.value=!1}}})};F((s,t,o)=>{if(w.value)return L.confirm({title:"未保存的更改",icon:V(E),content:"您有未保存的更改，确定要离开吗？",okText:"离开",cancelText:"取消",onOk(){o()},onCancel(){}}),!1;o()});const C=s=>{w.value&&(s.preventDefault(),s.returnValue="")};return x(()=>{window.addEventListener("beforeunload",C)}),R(()=>{window.removeEventListener("beforeunload",C)}),(s,t)=>(i(),r("div",Q,[t[13]||(t[13]=U('<header class="page-header" data-v-0aba4df7><div class="header-content" data-v-0aba4df7><div class="title-group" data-v-0aba4df7><h1 data-v-0aba4df7><span class="icon-wrapper" data-v-0aba4df7><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-0aba4df7><path d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" data-v-0aba4df7></path></svg></span> 提示词配置 </h1><p class="subtitle" data-v-0aba4df7>配置 VL 模型的系统提示词，影响页面解析效果</p></div></div></header>',1)),e("div",j,[e("div",$,[e("div",J,[e("div",K,[e("div",W,[t[2]||(t[2]=e("h3",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"})]),v(" 视觉模型选择 ")],-1)),e("span",{class:g(["model-badge",n.value==="glm-4.6v"?"badge-zhipu":"badge-qwen"])},m(n.value==="glm-4.6v"?"智谱 AI":"本地部署"),3)]),e("div",X,[e("div",Y,[(i(!0),r(D,null,G(M.value,o=>(i(),r("label",{key:o.id,class:g(["model-option",{selected:n.value===o.id}])},[B(e("input",{type:"radio",value:o.id,"onUpdate:modelValue":t[0]||(t[0]=T=>n.value=T),onChange:z,disabled:l.value},null,40,Z),[[O,n.value]]),e("div",ee,[e("div",te,[e("span",se,m(o.name),1),e("span",oe,m(o.provider),1)]),e("p",ae,m(o.description),1)]),n.value===o.id?(i(),r("span",le,[...t[3]||(t[3]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[e("path",{d:"M20 6L9 17l-5-5"})],-1)])])):k("",!0)],2))),128))])])]),e("div",ne,[e("div",de,[t[8]||(t[8]=e("h3",null,[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M16 18l6-6-6-6M8 6l-6 6 6 6"})]),v(" System Prompt ")],-1)),e("div",re,[e("button",{class:"action-btn secondary",onClick:I,disabled:l.value},[...t[4]||(t[4]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e("path",{d:"M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"})],-1),v(" 复制 ",-1)])],8,ie),e("button",{class:"action-btn secondary",onClick:P,disabled:l.value},[...t[5]||(t[5]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 005.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 013.51 15"})],-1),v(" 恢复默认 ",-1)])],8,ce),e("button",{class:"action-btn primary",onClick:N,disabled:!w.value||l.value||!_.value},[l.value?(i(),r("span",ue)):(i(),r("svg",pe,[...t[6]||(t[6]=[e("path",{d:"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"},null,-1),e("path",{d:"M17 21v-8H7v8M7 3v5h8"},null,-1)])])),t[7]||(t[7]=v(" 保存 ",-1))],8,ve)])]),e("div",me,[e("div",he,[B(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=o=>a.value=o),class:g(["prompt-editor",{error:!_.value}]),disabled:l.value,placeholder:"请输入 System Prompt...",onInput:A},null,42,_e),[[H,a.value]]),e("div",fe,[e("div",{class:g(["char-counter",S.value])},[e("span",ge,m(p.value),1),t[9]||(t[9]=e("span",{class:"separator"},"/",-1)),e("span",{class:"max"},m(u)),t[10]||(t[10]=e("span",{class:"label"},"字符",-1))],2),e("div",ye,[p.value<ke?(i(),r("div",be,[...t[11]||(t[11]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1),v(" 建议不少于 100 字符以提升解析效果 ",-1)])])):k("",!0),_.value?k("",!0):(i(),r("div",we,[...t[12]||(t[12]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M15 9l-6 6M9 9l6 6"})],-1),v(" 已达到最大字符限制 ",-1)])]))])])])])])])])])]))}},Le=q(Me,[["__scopeId","data-v-0aba4df7"]]);export{Le as default};
